var RIAPP;
(function(a){(function(a){a[a.NONE=0]="NONE";a[a.NORMAL=1]="NORMAL";a[a.HIGH=2]="HIGH"})(a.DEBUG_LEVEL||(a.DEBUG_LEVEL={}));a.DebugLevel=0;var r=function(){function a(){}a.clone=function(a){return 1===a.length?[a[0]]:Array.apply(null,a)};a.fromList=function(a){for(var n=Array(a.length),k=0,g=a.length;k<g;k++)n[k]=a[k];return n};a.fromCollection=function(m){return a.fromList(m)};a.distinct=function(a){var n={},k,g=a.length,h=[];for(k=0;k<g;k+=1)n[a[k]]=a[k];a=Object.keys(n);k=0;for(g=a.length;k<g;k+=
1)h.push(n[a[k]]);return h};return a}();a.ArrayHelper=r;r=function(){function d(){}d.isNull=function(a){return null===a};d.isUndefined=function(a){return void 0===a};d.isNt=function(a){return null===a||void 0===a};d.isString=function(a){if(d.isNt(a))return!1;var n=/string/i;return"string"===typeof a?!0:"object"===typeof a?n.test(a.constructor.toString()):!1};d.isFunc=function(a){if(d.isNt(a))return!1;var n=/Function/;return"function"===typeof a?n.test(a.constructor.toString()):!1};d.isBoolean=function(a){if(d.isNt(a))return!1;
var n=/boolean/i;return"boolean"===typeof a?!0:"object"===typeof a?n.test(a.constructor.toString()):!1};d.isDate=function(a){if(d.isNt(a))return!1;var n=/date/i;return"date"===typeof a?!0:"object"===typeof a?n.test(a.constructor.toString()):!1};d.isNumber=function(a){if(d.isNt(a))return!1;var n=/Number/;return"number"===typeof a?!0:"object"===typeof a?n.test(a.constructor.toString()):!1};d.isNumeric=function(a){return d.isNumber(a)||d.isString(a)&&!isNaN(Number(a))};d.endsWith=function(a,n){return a.substr(a.length-
n.length)===n};d.startsWith=function(a,n){return a.substr(0,n.length)===n};d.fastTrim=function(a){return a.replace(/^\s+|\s+$/g,"")};d.trim=function(a,n){return n?d.ltrim(d.rtrim(a,n),n):d.fastTrim(a)};d.ltrim=function(a,n){return a.replace(new RegExp("^["+(n||"\\s")+"]+","g"),"")};d.rtrim=function(a,n){return a.replace(new RegExp("["+(n||"\\s")+"]+$","g"),"")};d.isArray=function(a){return a?Array.isArray(a):!1};d.hasProp=function(a,n){if(!a)return!1;if(a.hasOwnProperty(n))return!0;if(Object===a)return!1;
var k=Object.getPrototypeOf(a);return d.hasProp(k,n)};d.format=function(m){for(var n=[],k=1;k<arguments.length;k++)n[k-1]=arguments[k];for(var k="",g=0;;){var h=m.indexOf("{",g),p=m.indexOf("}",g);if(0>h&&0>p){k+=m.slice(g);break}if(0<p&&(p<h||0>h)){if("}"!==m.charAt(p+1))throw Error(d.format(a.ERRS.ERR_STRING_FORMAT_INVALID,m));k+=m.slice(g,p+1);g=p+2}else if(k+=m.slice(g,h),g=h+1,"{"===m.charAt(g))k+="{",g++;else{if(0>p)throw Error(d.format(a.ERRS.ERR_STRING_FORMAT_INVALID,m));var h=m.substring(g,
p),q=h.indexOf(":"),g=parseInt(0>q?h:h.substring(0,q),10);if(isNaN(g))throw Error(d.format(a.ERRS.ERR_STRING_FORMAT_INVALID,m));h=0>q?"":h.substring(q+1);g=n[g];if(void 0===g||null===g)g="";k=g.format?k+g.format(h):k+g.toString();g=p+1}}return k};d.setValue=function(m,n,k,g){var h=n.split("."),d;for(d=0;d<h.length-1;d+=1)m[h[d]]||(m[h[d]]={}),m=m[h[d]];h=h[h.length-1];if(g&&void 0!==m[h])throw Error(a.baseUtils.format(a.ERRS.ERR_OBJ_ALREADY_REGISTERED,n));m[h]=k};d.getValue=function(a,n){var d=n.split("."),
g=a,h,p;for(h=0;h<d.length;h+=1){p=g[d[h]];if(void 0===p)return null;g=p}return p};d.removeValue=function(a,n){var d=n.split("."),g=a,h;h=null;for(h=0;h<d.length-1;h+=1){if(!g[d[h]])return null;g=g[d[h]]}d=d[d.length-1];h=g[d];void 0!==h&&delete g[d];return h};d.resolveOwner=function(a,n){var d=n.split("."),g,h,p=d.length;if(1==p)return a;h=a;for(g=0;g<p-1;g+=1){h=h[d[g]];if(void 0===h)return;if(null===h)return null}return h};return d}();a.baseUtils=r})(RIAPP||(RIAPP={}));
(function(a){var r=function(){function d(){this._isDestroyCalled=this._isDestroyed=!1;this._events=null}d.hasNode=function(a,d){if(!a||!d)return!1;for(var k=a;k;){if(k.fn===d.fn&&k.ns==d.ns)return!0;k=k.next}return!1};d.countNodes=function(a){if(!a)return 0;for(var d=0;a;)a=a.next,++d;return d};d.prependNode=function(a,n){if(d.hasNode(a,n))return a;n.next=a;return n};d.appendNode=function(a,d){var k=a,g=k.next;if(!k)return null;if(k.fn===d.fn&&k.ns==d.ns)return a;for(;g;){if(g.fn===d.fn&&g.ns==d.ns)return a;
k=g;g=k.next}k.next=d;return a};d.removeNodes=function(a,d){if(!a)return null;for(var k=a,g=null,h=a,p=h?h.next:null;h;)h.ns==d?(g?g.next=p:k=p,h.fn=null,h.next=null,h=p):(g=h,h=h.next),p=h?h.next:null;return k};d.prototype._getEventNames=function(){return["error","destroyed"]};d.prototype._addHandler=function(m,n,k,g){if(!this._isDestroyed){if(!a.baseUtils.isFunc(n))throw Error(a.ERRS.ERR_EVENT_INVALID_FUNC);if(!m)throw Error(a.baseUtils.format(a.ERRS.ERR_EVENT_INVALID,m));null===this._events&&(this._events=
{});var h=this._events,p="*";k&&(p=""+k);(k=h[m])?(n={fn:n,ns:p,next:null},h[m]=g?d.prependNode(k,n):d.appendNode(k,n)):h[m]={fn:n,ns:p,next:null}}};d.prototype._removeHandler=function(a,n){var k=this._events,g="*";if(k){n&&(g=""+n);var h;if(a){if(h=k[a])"*"==g?delete k[a]:(h=d.removeNodes(h,g))?k[a]=h:delete k[a]}else"*"!=g?Object.keys(k).forEach(function(a){var h=k[a];(h=d.removeNodes(h,g))?k[a]=h:delete k[a]}):this._events=null}};d.prototype._raiseEvent=function(d,n){var k=this._events;if(null!==
k){if(void 0===k)throw Error("The object instance is invalid. The object constructor has not been called!");if(d)for("0*"!=d&&a.baseUtils.startsWith(d,"0")&&this._raiseEvent("0*",n),k=k[d];k;)k.fn.apply(this,[this,n]),k=k.next}};d.prototype._checkEventName=function(d){if(-1===this._getEventNames().indexOf(d)){if(2==a.DebugLevel)debugger;throw Error(a.baseUtils.format(a.ERRS.ERR_EVENT_INVALID,d));}};d.prototype._isHasProp=function(d){return a.baseUtils.hasProp(this,d)};d.prototype.handleError=function(d,
n){if(a.global&&a.global._checkIsDummy(d))return!0;d.message||(d=Error(""+d));var k={error:d,source:n,isHandled:!1};this._raiseEvent("error",k);return k.isHandled};d.prototype.raisePropertyChanged=function(m){var n={property:m},k=m.split("."),g=k[k.length-1];if(1<k.length){k=a.baseUtils.resolveOwner(this,m);if(0<a.DebugLevel&&a.baseUtils.isUndefined(k)){if(2==a.DebugLevel)debugger;throw Error(a.baseUtils.format(a.ERRS.ERR_PROP_NAME_INVALID,m));}k instanceof d&&k._raiseEvent("0"+g,n)}else{if(0<a.DebugLevel&&
!a.baseUtils.hasProp(this,g)){if(2==a.DebugLevel)debugger;throw Error(a.baseUtils.format(a.ERRS.ERR_PROP_NAME_INVALID,g));}this._raiseEvent("0"+g,n)}};d.prototype.addHandler=function(a,d,k,g){this._checkEventName(a);this._addHandler(a,d,k,!!g)};d.prototype.removeHandler=function(a,d){a&&this._checkEventName(a);this._removeHandler(a,d)};d.prototype.addOnDestroyed=function(a,d){this._addHandler("destroyed",a,d,!1)};d.prototype.removeOnDestroyed=function(a){this._removeHandler("destroyed",a)};d.prototype.addOnError=
function(a,d){this._addHandler("error",a,d,!1)};d.prototype.removeOnError=function(a){this.removeHandler("error",a)};d.prototype.removeNSHandlers=function(a){this._removeHandler(null,a)};d.prototype.raiseEvent=function(a,d){this._checkEventName(a);this._raiseEvent(a,d)};d.prototype.addOnPropertyChange=function(d,n,k){if(!d)throw Error(a.ERRS.ERR_PROP_NAME_EMPTY);if(0<a.DebugLevel&&"*"!=d&&!this._isHasProp(d)){if(2==a.DebugLevel)debugger;throw Error(a.baseUtils.format(a.ERRS.ERR_PROP_NAME_INVALID,
d));}this._addHandler("0"+d,n,k,!1)};d.prototype.removeOnPropertyChange=function(d,n){if(d){if(0<a.DebugLevel&&"*"!=d&&!this._isHasProp(d)){if(2==a.DebugLevel)debugger;throw Error(a.baseUtils.format(a.ERRS.ERR_PROP_NAME_INVALID,d));}d="0"+d}this._removeHandler(d,n)};d.prototype.getIsDestroyed=function(){return this._isDestroyed};d.prototype.getIsDestroyCalled=function(){return this._isDestroyCalled};d.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=this._isDestroyed=!0;try{this._raiseEvent("destroyed",
{})}finally{this._events=null}}};return d}();a.BaseObject=r})(RIAPP||(RIAPP={}));var __extends=this.__extends||function(a,r){function d(){this.constructor=a}for(var m in r)r.hasOwnProperty(m)&&(a[m]=r[m]);d.prototype=r.prototype;a.prototype=new d};
(function(a){a.global=null;a.css_riaTemplate="ria-template";(function(a){a[a.Source=0]="Source";a[a.Target=1]="Target"})(a.BindTo||(a.BindTo={}));var r=function(d){function m(n,k){d.call(this);if(a.global)throw Error(a.ERRS.ERR_GLOBAL_SINGLTON);if(!k)throw Error(a.ERRS.ERR_APP_NEED_JQUERY);this._window=n;this._appInst={};this._$=k;this._currentSelectable=null;this._userCode={};this._exports={};this._templateLoaders={};this._templateGroups={};this._promises=[];this._moduleNames=[];this._parser=null;
this._isInitialized=this._isReady=!1;this._onCreate()}__extends(m,d);m.prototype._onCreate=function(){var d=this;d.$(d.document).ready(function(k){d._waitQueue=new a.MOD.utils.WaitQueue(d);d._isReady=!0;d._processTemplateSections(d.document);d.raiseEvent("load",{});setTimeout(function(){d.removeHandler("load",null)},0)});d.$(d.document).on("click.global",function(a){a.stopPropagation();d.currentSelectable=null});d.$(d.document).on("keydown.global",function(a){a.stopPropagation();d._currentSelectable&&
d._currentSelectable._onKeyDown(a.which,a)});d.$(d.document).on("keyup.global",function(a){a.stopPropagation();d._currentSelectable&&d._currentSelectable._onKeyUp(a.which,a)});d.$(d.window).unload(function(){d.raiseEvent("unload",{})});d.window.onerror=function(a,d,h){if(a&&-1<a.toString().indexOf("DUMMY_ERROR"))return!0;alert("Error: "+a+"\nURL: "+d+"\nLine Number: "+h);return!1}};m.prototype._processTemplateSection=function(d,k){var g=this;a.ArrayHelper.fromList(d.querySelectorAll(m._TEMPLATE_SELECTOR)).forEach(function(a){var d=
g.document.createElement("div"),q=a.getAttribute("id"),f=g.utils.createDeferred();a.removeAttribute("id");d.appendChild(a);f.resolve(d.innerHTML);k&&(q=k.appName+"."+q);g._registerTemplateLoader(q,{fn_loader:function(){return f.promise()}})})};m.prototype._registerTemplateLoaderCore=function(d,k){return a.baseUtils.setValue(this._templateLoaders,d,k,!1)};m.prototype._getTemplateLoaderCore=function(d){return a.baseUtils.getValue(this._templateLoaders,d)};m.prototype._getEventNames=function(){var a=
d.prototype._getEventNames.call(this);return["load","unload","initialize","unresolvedBind"].concat(a)};m.prototype._initialize=function(){if(!this._isInitialized){var d=this,k,g;if(k=this.isModuleLoaded("utils"))d._utils=new a.MOD.utils.Utils;if(k=this.isModuleLoaded("parser"))d._parser=new a.MOD.parser.Parser;if(k=this.isModuleLoaded("defaults"))d._defaults=new a.MOD.defaults.Defaults;g="datepicker";(k=this.isModuleLoaded(g))&&d._defaults&&(d._defaults.datepicker=d.getType("IDatepicker"));if(!k)throw Error(a.baseUtils.format(a.ERRS.ERR_MODULE_NOT_REGISTERED,
g));this._isInitialized=!0;d.raiseEvent("initialize",{});setTimeout(function(){d.removeHandler("initialize",null)},0)}};m.prototype._addHandler=function(a,k,g,h){var p=this;"load"==a&&p._isReady||"initialize"==a&&p._isInitialized?setTimeout(function(){k.apply(p,[p,{}])},0):d.prototype._addHandler.call(this,a,k,g,h)};m.prototype._trackSelectable=function(a){var d=this,g=d.utils,h=a.containerEl;d.$(h).on("click."+a.uniqueID,function(p){p.stopPropagation();g.isContained(p.target,h)&&(d.currentSelectable=
a)})};m.prototype._untrackSelectable=function(a){this.$(a.containerEl).off("click."+a.uniqueID);this.currentSelectable===a&&(this.currentSelectable=null)};m.prototype._registerApp=function(a){this._appInst[a.appName]||(this._appInst[a.appName]=a)};m.prototype._unregisterApp=function(a){this._appInst[a.appName]&&(delete this._appInst[a.appName],delete this._templateLoaders[a.appName],delete this._templateGroups[a.appName])};m.prototype._destroyApps=function(){var a=this;this.utils.forEachProp(this._appInst,
function(d){a._appInst[d].destroy()})};m.prototype._throwDummy=function(d){var k=a.MOD.errors;if(k&&d&&!d.isDummy)throw k.DummyError.create(d);throw d;};m.prototype._checkIsDummy=function(a){return!!a.isDummy};m.prototype._registerObject=function(d,k,g){return a.baseUtils.setValue(d.getExports(),k,g,!0)};m.prototype._getObject=function(d,k){return a.baseUtils.getValue(d.getExports(),k)};m.prototype._removeObject=function(d,k){return a.baseUtils.removeValue(d.getExports(),k)};m.prototype._processTemplateSections=
function(d){var k=this;a.ArrayHelper.fromList(d.querySelectorAll(m._TEMPLATES_SELECTOR)).forEach(function(a){k._processTemplateSection(a,null);k.utils.removeNode(a)})};m.prototype._loadTemplatesAsync=function(a,d){var g=this,h=a(),p=g.isLoading;g._promises.push(h);g.isLoading!==p&&g.raisePropertyChanged("isLoading");var q=g.utils.createDeferred();h.then(function(a){g.utils.removeFromArray(g._promises,h);try{var e=g.document.createElement("div");e.innerHTML=a;g._processTemplateSection(e,d);q.resolve()}catch(l){g.handleError(l,
g),q.reject()}g.isLoading||g.raisePropertyChanged("isLoading")},function(a){g.utils.removeFromArray(g._promises,h);g.isLoading||g.raisePropertyChanged("isLoading");q.reject();a&&a.message?g.handleError(a,g):a&&a.responseText?g.handleError(Error(a.responseText),g):g.handleError(Error("Failed to load templates"),g)});return q.promise()};m.prototype._registerTemplateLoader=function(d,k){k=this.utils.extend(!1,{fn_loader:null,groupName:null},k);if(!k.groupName&&!this.utils.check.isFunction(k.fn_loader))throw Error(a.baseUtils.format(a.ERRS.ERR_ASSERTION_FAILED,
"fn_loader is Function"));var g=this._getTemplateLoaderCore(d);if(g){if(!g.fn_loader&&g.groupName&&!k.groupName&&k.fn_loader)return this._registerTemplateLoaderCore(d,k);throw Error(a.baseUtils.format(a.ERRS.ERR_TEMPLATE_ALREADY_REGISTERED,d));}return this._registerTemplateLoaderCore(d,k)};m.prototype._getTemplateLoader=function(d){var k=this,g=k._getTemplateLoaderCore(d);if(!g)return null;if(!g.fn_loader&&g.groupName){var h=k._getTemplateGroup(g.groupName);if(!h)throw Error(a.baseUtils.format(a.ERRS.ERR_TEMPLATE_GROUP_NOTREGISTERED,
g.groupName));return function(){h.promise||(h.promise=k._loadTemplatesAsync(h.fn_loader,h.app));var g=k.utils.createDeferred();h.promise.done(function(){try{h.promise=null;h.names.forEach(function(e){h.app&&(e=h.app.appName+"."+e);var l=k._getTemplateLoaderCore(e);if(!l||!l.fn_loader)throw Error(a.baseUtils.format(a.ERRS.ERR_TEMPLATE_NOTREGISTERED,e));});var q=k._getTemplateLoaderCore(d);if(!q||!q.fn_loader)throw Error(a.baseUtils.format(a.ERRS.ERR_TEMPLATE_NOTREGISTERED,d));delete k._templateGroups[q.groupName];
q.fn_loader().done(function(a){g.resolve(a)}).fail(function(a){g.reject(a)})}catch(f){g.reject(f)}});h.promise.fail(function(a){h.promise=null;g.reject(a)});return g.promise()}}return g.fn_loader};m.prototype._registerTemplateGroup=function(d,k){var g=this,h=g.utils.extend(!1,{fn_loader:null,url:null,names:null,app:null,promise:null},k);h.url&&!h.fn_loader&&(h.fn_loader=function(){return g.utils.performAjaxGet(h.url)});a.baseUtils.setValue(g._templateGroups,d,h,!0);h.names.forEach(function(a){h.app&&
(a=h.app.appName+"."+a);g._registerTemplateLoader(a,{groupName:d,fn_loader:null})})};m.prototype._getTemplateGroup=function(d){return a.baseUtils.getValue(this._templateGroups,d)};m.prototype._waitForNotLoading=function(a,d){this._waitQueue.enQueue({prop:"isLoading",groupName:null,predicate:function(a){return!a},action:a,actionArgs:d})};m.prototype._getConverter=function(d){var k=this._getObject(this,"converters."+d);if(!k)throw Error(this.utils.format(a.ERRS.ERR_CONVERTER_NOTREGISTERED,d));return k};
m.prototype._onUnResolvedBinding=function(a,d,g,h){this.raiseEvent("unresolvedBind",{bindTo:a,root:d,path:g,propName:h})};m.prototype.addOnLoad=function(a,d){this._addHandler("load",a,d,!1)};m.prototype.addOnUnLoad=function(a,d){this._addHandler("unload",a,d,!1)};m.prototype.addOnInitialize=function(a,d){this._addHandler("initialize",a,d,!1)};m.prototype.addOnUnResolvedBinding=function(a,d){this.addHandler("unresolvedBind",a,d)};m.prototype.removeOnUnResolvedBinding=function(a){this.removeHandler("unresolvedBind",
a)};m.prototype.getExports=function(){return this._exports};m.prototype.reThrow=function(a,d){if(d)this._throwDummy(a);else throw a;};m.prototype.onModuleLoaded=function(d,k){if(this.isModuleLoaded(d))throw Error(a.baseUtils.format(a.ERRS.ERR_MODULE_ALREDY_REGISTERED,d));this._moduleNames.push(d)};m.prototype.isModuleLoaded=function(a){return-1<this._moduleNames.indexOf(a)};m.prototype.findApp=function(a){return this._appInst[a]};m.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=
!0,this._waitQueue&&(this._waitQueue.destroy(),this._waitQueue=null),this._promises=[],this.removeHandler(),this._destroyApps(),this._exports={},this._templateLoaders={},this._templateGroups={},this._parser=null,this.$(this.document).off(".global"),a.global=null,this.window.onerror=null,d.prototype.destroy.call(this))};m.prototype.registerType=function(a,d){return this._registerObject(this,"types."+a,d)};m.prototype.getType=function(a){return this._getObject(this,"types."+a)};m.prototype.registerConverter=
function(d,k){var g="converters."+d;if(this._getObject(this,g))throw Error(a.global.utils.format(a.ERRS.ERR_OBJ_ALREADY_REGISTERED,d));this._registerObject(this,g,k)};m.prototype.registerElView=function(d,k){var g="elvws."+d;if(this._getObject(this,g))throw Error(a.global.utils.format(a.ERRS.ERR_OBJ_ALREADY_REGISTERED,d));this._registerObject(this,g,k)};m.prototype.getImagePath=function(a){return this.defaults.imagesPath+a};m.prototype.loadTemplates=function(a){var d=this;this._loadTemplatesAsync(function(){return d.utils.performAjaxGet(a)},
null)};m.prototype.toString=function(){return"Global"};Object.defineProperty(m.prototype,"moduleNames",{get:function(){return a.ArrayHelper.clone(this._moduleNames)},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"parser",{get:function(){return this._parser},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"isLoading",{get:function(){return 0<this._promises.length},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"$",{get:function(){return this._$},
enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"window",{get:function(){return this._window},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"document",{get:function(){return this._window.document},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"currentSelectable",{get:function(){return this._currentSelectable},set:function(a){this._currentSelectable!==a&&(this._currentSelectable=a,this.raisePropertyChanged("currentSelectable"))},enumerable:!0,
configurable:!0});Object.defineProperty(m.prototype,"defaults",{get:function(){return this._defaults},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"utils",{get:function(){return this._utils},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"UC",{get:function(){return this._userCode},enumerable:!0,configurable:!0});m.vesion="2.5.0";m._TEMPLATES_SELECTOR=["section.",a.css_riaTemplate].join("");m._TEMPLATE_SELECTOR='*[data-role="template"]';return m}(a.BaseObject);
a.Global=r;a.global=new r(window,jQuery)})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(d){d.DATA_ATTR={EL_VIEW_KEY:"data-elvwkey",DATA_BIND:"data-bind",DATA_VIEW:"data-view",DATA_EVENT_SCOPE:"data-scope",DATA_ITEM_KEY:"data-key",DATA_CONTENT:"data-content",DATA_COLUMN:"data-column",DATA_NAME:"data-name",DATA_FORM:"data-form"};(function(a){a[a.None=0]="None";a[a.ServerLocalToClientLocal=1]="ServerLocalToClientLocal";a[a.UtcToClientLocal=2]="UtcToClientLocal"})(d.DATE_CONVERSION||(d.DATE_CONVERSION={}));(function(a){a[a.None=0]="None";a[a.String=1]=
"String";a[a.Bool=2]="Bool";a[a.Integer=3]="Integer";a[a.Decimal=4]="Decimal";a[a.Float=5]="Float";a[a.DateTime=6]="DateTime";a[a.Date=7]="Date";a[a.Time=8]="Time";a[a.Guid=9]="Guid";a[a.Binary=10]="Binary"})(d.DATA_TYPE||(d.DATA_TYPE={}));(function(a){a[a.backspace=8]="backspace";a[a.tab=9]="tab";a[a.enter=13]="enter";a[a.esc=27]="esc";a[a.space=32]="space";a[a.pageUp=33]="pageUp";a[a.pageDown=34]="pageDown";a[a.end=35]="end";a[a.home=36]="home";a[a.left=37]="left";a[a.up=38]="up";a[a.right=39]=
"right";a[a.down=40]="down";a[a.del=127]="del"})(d.KEYS||(d.KEYS={}));d.ELVIEW_NM={DATAFORM:"dataform"};d.LOADER_GIF={SMALL:"loader2.gif",NORMAL:"loader.gif"};a.global.onModuleLoaded("consts",d)})(r.consts||(r.consts={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(d){var m=r.consts,n=a.baseUtils,k=0;d.css={toolTip:"qtip",toolTipError:"qtip-red"};var g=function(){function b(){}b.isHTML=function(c){if(b.isNt(c))return!1;var a=/html/i;return"object"===typeof c?a.test(c.constructor.toString()):!1};b.isObject=function(c){if(b.isNt(c))return!1;var a=/object/i;return"object"===typeof c?a.test(c.constructor.toString()):!1};b.isSimpleObject=function(c){return b.isNt(c)?!1:b.isObject(c)&&Object.prototype===Object.getPrototypeOf(c)};
b.isRegExp=function(c){if(b.isNt(c))return!1;var a=/regexp/i;return"function"===typeof c?a.test(c.constructor.toString()):!1};b.isBoolString=function(c){return b.isNt(c)?!1:"true"==c||"false"==c};b.isBaseObj=function(c){return!!c&&c instanceof a.BaseObject};b.isBinding=function(c){return!!c&&c instanceof r.binding.Binding};b.isElView=function(c){return!!c&&c instanceof r.baseElView.BaseElView};b.isTemplateElView=function(c){return!!c&&c instanceof r.template.TemplateElView};b.isEditable=function(c){return!!c&&
!!c.beginEdit&&!!c.endEdit&&!!c.cancelEdit&&a.global.utils.hasProp(c,"isEditing")};b.isSubmittable=function(c){return!!c&&!!c.submitChanges&&!!c.rejectChanges&&a.global.utils.hasProp(c,"_isCanSubmit")};b.isDataForm=function(c){if(!c)return!1;if(c.hasAttribute(m.DATA_ATTR.DATA_FORM))return!0;c=c.getAttribute(m.DATA_ATTR.DATA_VIEW);if(!c)return!1;c=a.global.parser.parseOptions(c);return 0<c.length&&c[0].name===m.ELVIEW_NM.DATAFORM};b.isErrorNotification=function(c){if(!c||!b.isFunction(c.getIErrorNotification))return!1;
c=c.getIErrorNotification();return!!c&&b.isFunction(c.getIErrorNotification)};b.isInsideDataForm=function(c){return c?(c=c.parentElement)?b.isDataForm(c)?!0:b.isInsideDataForm(c):!1:!1};b.isInNestedForm=function(c,a,b){var e,l=a.length;if(0==l)return!1;for(e=b.parentElement;e;){for(b=0;b<l;b+=1)if(e===a[b])return!0;if(c&&e===c)break;e=e.parentElement}return!1};b.isNull=n.isNull;b.isUndefined=n.isUndefined;b.isNt=n.isNt;b.isFunction=n.isFunc;b.isString=n.isString;b.isArray=n.isArray;b.isBoolean=n.isBoolean;
b.isDate=n.isDate;b.isNumber=n.isNumber;b.isNumeric=n.isNumeric;return b}();d.Checks=g;var h=function(){function a(){}a.formatNumber=function(c,a,b,e){c=(c+"").replace(/[^0-9+-Ee.]/g,"");var l=isFinite(+c)?+c:0;c=isFinite(+a)?Math.abs(a):0;e=void 0===e?",":e;b=void 0===b?".":b;var d=[""],d=function(c,a){var b=Math.pow(10,a);return""+Math.round(c*b)/b};g.isNt(a)?(d=(""+l).split("."),c=2):d=(c?d(l,c):""+Math.round(l)).split(".");var l="",f=d[0].length;if(3<f){for(a=0;a<f;a+=1)l+=d[0].charAt(a),a<f-
1&&0===(f-a-1)%3&&(l+=e);d[0]=l}(d[1]||"").length<c&&(d[1]=d[1]||"",d[1]+=Array(c-d[1].length+1).join("0"));return d.join(b)};a.stripNonNumeric=function(c){c+="";for(var a=/^\d|\.|-$/,b="",e=0;e<c.length;e++)a.test(c.charAt(e))&&("."==c.charAt(e)&&-1!=b.indexOf(".")||"-"==c.charAt(e)&&0!=b.length||(b+=c.charAt(e)));return b};a.endsWith=n.endsWith;a.startsWith=n.startsWith;a.trim=n.trim;return a}();d.StringUtils=h;var p=function(){function b(){}b.checkNumRange=function(c,b){var e=b.split(",");if(e[0]&&
c<parseFloat(e[0]))throw Error(n.format(a.ERRS.ERR_FIELD_RANGE,c,b));if(e[1]&&c>parseFloat(e[1]))throw Error(n.format(a.ERRS.ERR_FIELD_RANGE,c,b));};b._dtRangeToDate=function(c){c=c.split("-");return new Date(parseInt(c[0],10),parseInt(c[1],10)-1,parseInt(c[2],10))};b.checkDateRange=function(c,e){var l=e.split(",");if(l[0]&&c<b._dtRangeToDate(l[0]))throw Error(n.format(a.ERRS.ERR_FIELD_RANGE,c,e));if(l[1]&&c>b._dtRangeToDate(l[1]))throw Error(n.format(a.ERRS.ERR_FIELD_RANGE,c,e));};return b}();d.Validations=
p;d.valueUtils={valueToDate:function(b,c,e){if(!b)return null;b=""+b;var l=b.split("-");if(7!=l.length)throw Error(n.format(a.ERRS.ERR_PARAM_INVALID,"val",b));b=new Date(parseInt(l[0],10),parseInt(l[1],10)-1,parseInt(l[2],10),parseInt(l[3],10),parseInt(l[4],10),parseInt(l[5],10),l[6]?parseInt(l[6],10):0);l=a.global.utils.get_timeZoneOffset();switch(c){case 0:break;case 1:b.setMinutes(b.getMinutes()+e);b.setMinutes(b.getMinutes()-l);break;case 2:b.setMinutes(b.getMinutes()-l);break;default:throw Error(n.format(a.ERRS.ERR_PARAM_INVALID,
"dtcnv",c));}return b},dateToValue:function(b,c,e){if(null===b)return null;if(!g.isDate(b))throw Error(n.format(a.ERRS.ERR_PARAM_INVALID,"dt",b));var l=a.global.utils.get_timeZoneOffset();switch(c){case 0:break;case 1:b.setMinutes(b.getMinutes()+l);b.setMinutes(b.getMinutes()-e);break;case 2:b.setMinutes(b.getMinutes()+l);break;default:throw Error(n.format(a.ERRS.ERR_PARAM_INVALID,"dtcnv",c));}return""+b.getFullYear()+"-"+(b.getMonth()+1)+"-"+b.getDate()+"-"+b.getHours()+"-"+b.getMinutes()+"-"+b.getSeconds()+
"-"+b.getMilliseconds()},compareVals:function(a,c,e){if(null===a&&null!==c||null!==a&&null===c)return!1;switch(e){case 6:case 7:case 8:return g.isDate(a)&&g.isDate(c)?a.getTime()===c.getTime():!1;default:return a===c}},stringifyValue:function(b,c,e,l){var f=null;if(g.isNt(b))return f;var h=!1;switch(e){case 0:f=g.isDate(b)?d.valueUtils.dateToValue(b,c,l):g.isArray(b)?JSON.stringify(b):g.isString(b)?b:JSON.stringify(b);h=!0;break;case 1:case 9:g.isString(b)&&(f=b,h=!0);break;case 2:g.isBoolean(b)&&
(f=JSON.stringify(b),h=!0);break;case 3:case 4:case 5:g.isNumber(b)&&(f=JSON.stringify(b),h=!0);break;case 6:case 7:case 8:g.isDate(b)&&(f=d.valueUtils.dateToValue(b,c,l),h=!0);break;case 10:g.isArray(b)&&(f=JSON.stringify(b),h=!0);break;default:throw Error(n.format(a.ERRS.ERR_PARAM_INVALID,"dataType",e));}if(!h)throw Error(n.format(a.ERRS.ERR_FIELD_WRONG_TYPE,b,r.consts.DATA_TYPE[e]));return f},parseValue:function(b,c,e,l){var f=null;if(void 0===b||null===b)return f;switch(c){case 0:f=b;break;case 1:case 9:f=
b;break;case 2:f=a.global.utils.parseBool(b);break;case 3:f=parseInt(b,10);break;case 4:case 5:f=parseFloat(b);break;case 6:case 7:case 8:f=d.valueUtils.valueToDate(b,e,l);break;case 10:f=JSON.parse(b);break;default:throw Error(n.format(a.ERRS.ERR_PARAM_INVALID,"dataType",c));}return f}};var q=function(b){function c(){b.call(this);this._objs=[]}__extends(c,b);c.create=function(){return new c};c.prototype.addObj=function(c){0>this._objs.indexOf(c)&&this._objs.push(c)};c.prototype.removeObj=function(c){a.global.utils.removeFromArray(this._objs,
c)};c.prototype.getObjs=function(){return this._objs};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._objs.forEach(function(c){c.getIsDestroyCalled()||c.destroy()}),this._objs=[],b.prototype.destroy.call(this))};c.prototype.toString=function(){return"LifeTimeScope"};return c}(a.BaseObject);d.LifeTimeScope=q;var f=function(b){function c(){b.call(this);this._objId="prw"+a.global.utils.getNewID();this._objs=[]}__extends(c,b);c.create=function(){return new c};c.prototype.addPropWatch=
function(c,a,b){c.addOnPropertyChange(a,function(c,a){b(a.property)},this.uniqueID);0>this._objs.indexOf(c)&&this._objs.push(c)};c.prototype.addWatch=function(c,a,b){c.addOnPropertyChange("*",function(c,e){-1<a.indexOf(e.property)&&b(e.property)},this.uniqueID);0>this._objs.indexOf(c)&&this._objs.push(c)};c.prototype.removeWatch=function(c){c.removeNSHandlers(this.uniqueID)};c.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var c=this;this._objs.forEach(function(a){c.removeWatch(a)});
this._objs=[];b.prototype.destroy.call(this)}};c.prototype.toString=function(){return"PropWatcher "+this._objId};Object.defineProperty(c.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});return c}(a.BaseObject);d.PropWatcher=f;var e=function(b){function c(c){b.call(this);this._objId="wq"+a.global.utils.getNewID();this._owner=c;this._queue={}}__extends(c,b);c.create=function(a){return new c(a)};c.prototype._checkQueue=function(c,a){if(this._owner&&!this._owner.getIsDestroyCalled()){var b=
this,e=this._queue[c],l;if(e&&0!=e.length){var d,y,f=null,g=[],u=[],s=[];for(d=0;d<e.length;d+=1)if(l=e[d],l.predicate(a))if(l.group||0!=g.length)l.group&&(f||(f=l.group),f===l.group&&g.push(l));else{y=l;break}if(y)u.push(y),s.push(y);else for(;0<g.length;)l=g.pop(),y||(y=l),y.lastWins?0==u.length&&u.push(l):u.push(l),s.push(l);try{if(0<u.length){for(d=e.length;0<d;)--d,-1<s.indexOf(e[d])&&e.splice(d,1);u.forEach(function(c){try{c.action.apply(b._owner,c.args)}catch(a){b._owner.handleError(a,b)}})}}finally{0==
e.length&&(delete this._queue[c],this._owner.removeOnPropertyChange(c,this.uniqueID))}}}};c.prototype.enQueue=function(c){c=a.global.utils.extend(!1,{prop:"",groupName:null,predicate:null,action:null,actionArgs:[],lastWins:!1,syncCheck:!1},c);var b=this;if(this._owner){var e=c.prop,l=this._queue[e];l||(l=[],this._queue[e]=l,this._owner.addOnPropertyChange(e,function(c,a){setTimeout(function(){b._isDestroyCalled||b._checkQueue(e,b._owner[e])},0)},b.uniqueID));l.push({predicate:c.predicate,action:c.action,
group:c.groupName,lastWins:c.lastWins,args:c.actionArgs?c.actionArgs:[]});c.syncCheck?b._checkQueue(e,b._owner[e]):setTimeout(function(){b._isDestroyCalled||b._checkQueue(e,b._owner[e])},0)}};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._owner.removeOnPropertyChange(null,this.uniqueID),this._queue={},this._owner=null,b.prototype.destroy.call(this))};c.prototype.toString=function(){return"WaitQueue "+this._objId};Object.defineProperty(c.prototype,"uniqueID",{get:function(){return this._objId},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"owner",{get:function(){return this._owner},enumerable:!0,configurable:!0});return c}(a.BaseObject);d.WaitQueue=e;var l=function(){function b(){this.slice=Array.prototype.slice;this.get_timeZoneOffset=function(){var c=(new Date).getTimezoneOffset();return function(){return c}}();this.format=n.format;this.uuid=function(){var c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");return function(a,b){var e,l=[],
d=Math.random;b=b||c.length;if(a)for(e=0;e<a;e+=1)l[e]=c[0|d()*b];else{var f;l[8]=l[13]=l[18]=l[23]="-";l[14]="4";for(e=0;36>e;e+=1)l[e]||(f=0|16*d(),l[e]=c[19==e?f&3|8:f&15])}return l.join("")}}()}b.create=function(){return new b};Object.defineProperty(b.prototype,"check",{get:function(){return g},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"str",{get:function(){return h},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"validation",{get:function(){return p},
enumerable:!0,configurable:!0});b.prototype.getNewID=function(){var c=k;k+=1;return c};b.prototype.isContained=function(c,a){if(!c)return!1;for(;c=c.parentNode;)if(c===a)return!0;return!1};b.prototype.parseBool=function(c){if(g.isBoolean(c))return c;var b=n.trim(c).toLowerCase();if("false"===b)return!1;if("true"===b)return!0;throw Error(this.format(a.ERRS.ERR_PARAM_INVALID,"bool_value",c));};b.prototype.round=function(c,a){return parseFloat(c.toFixed(a))};b.prototype.performAjaxCall=function(c,b,
e,l,d,f){var g=new XMLHttpRequest;g.open("POST",c,e);var y=this.createDeferred();g.responseType="text";g.onload=function(c){200==this.status&&y.resolve(this.response)};g.onerror=function(c){y.reject(Error(c.target.status))};g.ontimeout=function(){y.reject(Error("The request for "+c+" timed out."))};g.timeout=1E3*a.global.defaults.ajaxTimeOut;g.setRequestHeader("Content-Type","application/json; charset=utf-8");g.send(b);b=y.promise();l&&b.done(function(c){l.call(f,c)});d&&b.fail(function(c){d.call(f,
c)});return b};b.prototype.performAjaxGet=function(c){var b=new XMLHttpRequest;b.open("GET",c,!0);var e=this.createDeferred();b.responseType="text";b.onload=function(c){200==this.status&&e.resolve(this.response)};b.onerror=function(c){e.reject(Error(c.target.status))};b.ontimeout=function(){e.reject(Error("The request for "+c+" timed out."))};b.timeout=1E3*a.global.defaults.ajaxTimeOut;b.send(null);return e.promise()};b.prototype.extend=function(c,a,b){return c?this.cloneObj(b,a):this.mergeObj(b,
a)};b.prototype.removeNode=function(c){if(c){var a=c.parentNode;a&&a.removeChild(c)}};b.prototype.insertAfter=function(c,a){var b=c.parentNode;b.lastChild===c?b.appendChild(a):b.insertBefore(a,c.nextSibling)};b.prototype.getProps=function(c){return Object.getOwnPropertyNames(c)};b.prototype.getParentDataForm=function(c,a){if(!a)return null;var b=a.parentElement;return b?b===c?c:g.isDataForm(b)?b:this.getParentDataForm(c,b):null};b.prototype.forEachProp=function(c,a){Object.getOwnPropertyNames(c).forEach(a)};
b.prototype.addToolTip=function(c,b,e){e={content:{text:b},style:{classes:e?d.css.toolTipError:d.css.toolTip},position:{my:"top left",at:"bottom right",viewport:a.global.$(a.global.window),adjust:{method:"flip",x:0,y:0}},hide:{event:"unfocus click mouseleave",leave:!0}};c.data("qtip")?b?c.qtip("option","content.text",b):c.qtip("destroy"):b&&c.qtip(e)};b.prototype.hasProp=function(c,a){return n.hasProp(c,a)};b.prototype.createDeferred=function(){return a.global.$.Deferred()};b.prototype.cloneObj=function(c,
a){var b,e,l;if(!c)return c;if(this.check.isArray(c))for(l=c.length,b=Array(l),e=0;e<l;e+=1)b[e]=this.cloneObj(c[e],null);else if(this.check.isSimpleObject(c)){b=a||{};var d,f=Object.getOwnPropertyNames(c);l=f.length;for(e=0;e<l;e+=1)d=f[e],b[d]=this.cloneObj(c[d],null)}else return c;return b};b.prototype.shallowCopy=function(c){return this.mergeObj(c,{})};b.prototype.mergeObj=function(c,a){a||(a={});if(!c)return a;for(var b=Object.getOwnPropertyNames(c),e,l=0,d=b.length;l<d;l+=1)e=b[l],a[e]=c[e];
return a};b.prototype.removeFromArray=function(c,a){var b=c.indexOf(a);-1<b&&c.splice(b,1);return b};b.prototype.insertIntoArray=function(c,a,b){c.splice(b,0,a)};b.prototype.getErrorNotification=function(c){return c?c._aspect&&g.isErrorNotification(c._aspect)?c._aspect.getIErrorNotification():g.isErrorNotification(c)?c.getIErrorNotification():null:null};b.prototype.getEditable=function(c){return c?c._aspect&&g.isEditable(c._aspect)?c._aspect:g.isEditable(c)?c:null:null};b.prototype.getSubmittable=
function(c){return c?c._aspect&&g.isSubmittable(c._aspect)?c._aspect:g.isSubmittable(c)?c:null:null};b.prototype.destroyJQueryPlugin=function(c,a){if(c.data(a))c[a]("destroy")};return b}();d.Utils=l;a.global.registerType("PropWatcher",f);a.global.registerType("LifeTimeScope",q);a.global.registerType("WaitQueue",e);a.global.onModuleLoaded("utils",d)})(r.utils||(r.utils={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(d){var m=function(a){function d(g){a.call(this);this._message=g;this._isDummy=!1;this._origError=null}__extends(d,a);d.create=function(a){return new d(a)};d.prototype.toString=function(){return this._message};Object.defineProperty(d.prototype,"message",{get:function(){return this._message},set:function(a){this._message=a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isDummy",{get:function(){return this._isDummy},set:function(a){this._isDummy=
a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"origError",{get:function(){return this._origError},set:function(a){this._origError=a},enumerable:!0,configurable:!0});return d}(a.BaseObject);d.BaseError=m;var n=function(a){function d(g){a.call(this,"DUMMY_ERROR");this.origError=g;this.isDummy=!0}__extends(d,a);d.create=function(a){return new d(a)};return d}(m);d.DummyError=n;m=function(d){function g(g,p){var q=a.ERRS.ERR_VALIDATION+"\r\n",f=0;g.forEach(function(e){0<f&&(q+="\r\n");
q=e.fieldName?q+" "+a.localizable.TEXT.txtField+": "+e.fieldName+" -> "+e.errors.join(", "):q+e.errors.join(", ");f+=1});d.call(this,q);this._errors=g;this._item=p}__extends(g,d);Object.defineProperty(g.prototype,"item",{get:function(){return this._item},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"errors",{get:function(){return this._errors},enumerable:!0,configurable:!0});return g}(m);d.ValidationError=m;a.global.onModuleLoaded("errors",d)})(r.errors||(r.errors={}))})(a.MOD||
(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(d){d.NUM_CONV={None:0,Integer:1,Decimal:2,Float:3,SmallInt:4};var m=function(){function e(){}e.prototype.convertToSource=function(a,b,c){return a};e.prototype.convertToTarget=function(e,b,c){return a.global.utils.check.isNt(e)?null:e};return e}();d.BaseConverter=m;var m=new m,n=function(){function e(){}e.prototype.convertToSource=function(e,b,c){if(!e)return null;b=a.global.defaults;var d=b.datepicker;return d?d.parseDate(e):g.convertToSource(e,b.dateFormat,c)};
e.prototype.convertToTarget=function(e,b,c){if(a.global.utils.check.isNt(e))return"";b=a.global.defaults;var d=b.datepicker;return d?d.formatDate(e):g.convertToTarget(e,b.dateFormat,c)};e.prototype.toString=function(){return"DateConverter"};return e}();d.DateConverter=n;var n=new n,k=function(){function e(){}e.prototype.convertToSource=function(e,b,c){if(!e)return null;b=moment(e,b);if(!b.isValid())throw Error(a.global.utils.format(a.ERRS.ERR_CONV_INVALID_DATE,e));return b.toDate()};e.prototype.convertToTarget=
function(e,b,c){return a.global.utils.check.isNt(e)?"":moment(e).format(b)};e.prototype.toString=function(){return"DateTimeConverter"};return e}();d.DateTimeConverter=k;var g=new k,k=function(){function e(){}e.prototype.convertToSource=function(e,b,c){c=a.global.utils;if(a.global.utils.check.isNt(e))return null;var f=a.global.defaults,g=f.decimalPoint,h=4,q=e.replace(f.thousandSep,""),q=q.replace(g,"."),q=a.global.utils.str.stripNonNumeric(q);if(""===q)return null;g=null;switch(b){case d.NUM_CONV.SmallInt:g=
parseInt(q,10);break;case d.NUM_CONV.Integer:g=parseInt(q,10);break;case d.NUM_CONV.Decimal:h=f.decPrecision;g=c.round(parseFloat(q),h);break;case d.NUM_CONV.Float:g=parseFloat(q);break;default:g=Number(q)}if(!c.check.isNumber(g))throw Error(c.format(a.ERRS.ERR_CONV_INVALID_NUM,e));return g};e.prototype.convertToTarget=function(e,b,c){c=a.global.utils;if(c.check.isNt(e))return"";var f=a.global.defaults,g=f.decimalPoint,h=f.thousandSep;switch(b){case d.NUM_CONV.Integer:return c.str.formatNumber(e,
0,g,h);case d.NUM_CONV.Decimal:return b=f.decPrecision,c.str.formatNumber(e,b,g,h);case d.NUM_CONV.SmallInt:return c.str.formatNumber(e,0,g,"");case d.NUM_CONV.Float:return c.str.formatNumber(e,null,g,h);default:return c.str.formatNumber(e,null,g,h)}};e.prototype.toString=function(){return"NumberConverter"};return e}();d.NumberConverter=k;var h=new k,k=function(){function a(){}a.prototype.convertToSource=function(a,b,c){return h.convertToSource(a,d.NUM_CONV.Integer,c)};a.prototype.convertToTarget=
function(a,b,c){return h.convertToTarget(a,d.NUM_CONV.Integer,c)};a.prototype.toString=function(){return"IntegerConverter"};return a}();d.IntegerConverter=k;var k=new k,p=function(){function a(){}a.prototype.convertToSource=function(a,b,c){return h.convertToSource(a,d.NUM_CONV.SmallInt,c)};a.prototype.convertToTarget=function(a,b,c){return h.convertToTarget(a,d.NUM_CONV.SmallInt,c)};a.prototype.toString=function(){return"SmallIntConverter"};return a}();d.SmallIntConverter=p;var p=new p,q=function(){function a(){}
a.prototype.convertToSource=function(a,b,c){return h.convertToSource(a,d.NUM_CONV.Decimal,c)};a.prototype.convertToTarget=function(a,b,c){return h.convertToTarget(a,d.NUM_CONV.Decimal,c)};a.prototype.toString=function(){return"DecimalConverter"};return a}();d.DecimalConverter=q;var q=new q,f=function(){function a(){}a.prototype.convertToSource=function(a,b,c){return h.convertToSource(a,d.NUM_CONV.Float,c)};a.prototype.convertToTarget=function(a,b,c){return h.convertToTarget(a,d.NUM_CONV.Float,c)};
a.prototype.toString=function(){return"FloatConverter"};return a}();d.FloatConverter=f;f=new f;a.global.registerConverter("BaseConverter",m);a.global.registerConverter("dateConverter",n);a.global.registerConverter("dateTimeConverter",g);a.global.registerConverter("numberConverter",h);a.global.registerConverter("integerConverter",k);a.global.registerConverter("smallIntConverter",p);a.global.registerConverter("decimalConverter",q);a.global.registerConverter("floatConverter",f);a.global.onModuleLoaded("converter",
d)})(r.converter||(r.converter={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(d){var m=function(d){function k(){d.call(this);this._datepicker=null;this._dateFormat="DD.MM.YYYY";this._dateTimeFormat="DD.MM.YYYY HH:mm:ss";this._timeFormat="HH:mm:ss";this._imagesPath="/Scripts/jriapp/img/";this._decimalPoint=",";this._thousandSep=" ";this._decPrecision=2;this._ajaxTimeOut=600}__extends(k,d);k.prototype.toString=function(){return"Defaults"};Object.defineProperty(k.prototype,"ajaxTimeOut",{get:function(){return this._ajaxTimeOut},set:function(a){this._ajaxTimeOut!==
a&&(this._ajaxTimeOut=a,this.raisePropertyChanged("ajaxTimeOut"))},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"dateFormat",{get:function(){return this._dateFormat},set:function(a){this._dateFormat!==a&&(this._dateFormat=a,this.raisePropertyChanged("dateFormat"))},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"timeFormat",{get:function(){return this._timeFormat},set:function(a){this._timeFormat!==a&&(this._timeFormat=a,this.raisePropertyChanged("timeFormat"))},
enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"dateTimeFormat",{get:function(){return this._dateTimeFormat},set:function(a){this._dateTimeFormat!==a&&(this._dateTimeFormat=a,this.raisePropertyChanged("dateTimeFormat"))},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"datepicker",{get:function(){return this._datepicker},set:function(a){this._datepicker!==a&&(this._datepicker=a,this.raisePropertyChanged("datepicker"))},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,
"imagesPath",{get:function(){return this._imagesPath},set:function(d){d||(d="");this._imagesPath!==d&&(a.baseUtils.endsWith(d,"/")?this._imagesPath=d:this._imagesPath=d+"/",this.raisePropertyChanged("imagesPath"))},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"decimalPoint",{get:function(){return this._decimalPoint},set:function(a){this._decimalPoint!==a&&(this._decimalPoint=a,this.raisePropertyChanged("decimalPoint"))},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,
"thousandSep",{get:function(){return this._thousandSep},set:function(a){this._thousandSep!==a&&(this._thousandSep=a,this.raisePropertyChanged("thousandSep"))},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"decPrecision",{get:function(){return this._decPrecision},set:function(a){this._decPrecision!==a&&(this._decPrecision=a,this.raisePropertyChanged("decPrecision"))},enumerable:!0,configurable:!0});return k}(a.BaseObject);d.Defaults=m;a.global.onModuleLoaded("defaults",d)})(r.defaults||
(r.defaults={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(d){var m;a.global.addOnInitialize(function(a,d){m=a.utils});var n=function(){function a(){}a.prototype._getKeyVals=function(d){var h,p,q,f=[],e={key:"",val:""},l=!0,b=a.__valueDelimeter1,c=a.__valueDelimeter2,v=a.__keyValDelimeter,A=function(c){c.val&&(m.check.isNumeric(c.val)?c.val=Number(c.val):m.check.isBoolString(c.val)&&(c.val=m.parseBool(c.val)));f.push(c)};for(h=0;h<d.length;h+=1){p=d.charAt(h);if("'"==p||'"'==p)q?q==p&&(q=null):q=p;q||"{"!==p||l?q||p!==
v?q||p!==b&&p!==c?l?e.key+=p:e.val+=p:l=!1:e.key&&(A(e),e={key:"",val:""},l=!0):(p=d.substr(h),p=this.getBraceParts(p,!0)[0],e.val+=p,h+=p.length-1)}e.key&&A(e);f.forEach(function(c){c.key=m.str.trim(c.key);m.check.isString(c.val)&&(c.val=m.str.trim(c.val));""===c.val&&m.str.startsWith(c.key,"this.")&&(c.val=c.key.substr(5),c.key="targetPath")});return f=f.filter(function(c){return""!==c.val})};a.prototype.getPathParts=function(d){var h=[];(d?d.split("."):[]).forEach(function(d){var g;(g=d.match(a.__indexedPropRX))?
(d=g[1],g=g[2],h.push(d),h.push("["+g+"]")):h.push(d)});return h};a.prototype.resolveProp=function(a,d){return d?m.str.startsWith(d,"[")?(d=this.trimQuotes(this.trimBrackets(d)),a instanceof r.collection.BaseDictionary?a.getItemByKey(d):a instanceof r.collection.BaseCollection?a.getItemByPos(parseInt(d,10)):m.check.isArray(a)?a[parseInt(d,10)]:a[d]):a[d]:a};a.prototype.setPropertyValue=function(a,d,p){m.str.startsWith(d,"[")?(d=this.trimQuotes(this.trimBrackets(d)),m.check.isArray(a)?a[parseInt(d,
10)]=p:a[d]=p):a[d]=p};a.prototype.resolveBindingSource=function(a,d){if(a){if(0===d.length)return a;if(0<d.length)return this.resolveBindingSource(this.resolveProp(a,d[0]),d.slice(1));throw Error("Invalid operation");}};a.prototype.resolvePath=function(a,d){if(!d)return a;for(var p=this.getPathParts(d),q=a,f=p.length-1,e=0;e<f;e+=1)if(q=this.resolveProp(q,p[e]),!q)return;return this.resolveProp(q,p[f])};a.prototype.getBraceParts=function(a,d){var p,q="",f,e,l=0,b=[];for(p=0;p<a.length;p+=1){f=a.charAt(p);
if("'"===f||'"'===f)e?e===f&&(e=null):e=f;if(e||"{"!==f)if(e||"}"!==f)0<l&&(q+=f);else{if(--l,q+=f,0===l&&(b.push(q),q="",d))break}else l+=1,q+=f}return b};a.prototype.trimOuterBraces=function(d){return m.str.trim(d.replace(a.__trimOuterBracesRX,""))};a.prototype.trimQuotes=function(d){return m.str.trim(d.replace(a.__trimQuotsRX,""))};a.prototype.trimBrackets=function(d){return m.str.trim(d.replace(a.__trimBracketsRX,""))};a.prototype.isWithOuterBraces=function(a){return m.str.startsWith(a,"{")&&
m.str.endsWith(a,"}")};a.prototype.parseOption=function(a){var d={},p=this;a=m.str.trim(a);p.isWithOuterBraces(a)&&(a=p.trimOuterBraces(a));p._getKeyVals(a).forEach(function(a){var f=m.check.isString(a.val);f&&p.isWithOuterBraces(a.val)?d[a.key]=p.parseOption(a.val):d[a.key]=f?p.trimQuotes(a.val):a.val});return d};a.prototype.parseOptions=function(a){var d=[],p=this;a=m.str.trim(a);var q=[a];p.isWithOuterBraces(a)&&(q=p.getBraceParts(a,!1));q.forEach(function(a){d.push(p.parseOption(a))});return d};
a.prototype.toString=function(){return"Parser"};a.__trimOuterBracesRX=/^([{]){0,1}|([}]){0,1}$/g;a.__trimQuotsRX=/^(['"])+|(['"])+$/g;a.__trimBracketsRX=/^(\[)+|(\])+$/g;a.__indexedPropRX=/(^\w+)\s*\[\s*['"]?\s*([^'"]+)\s*['",]?\s*\]/i;a.__valueDelimeter1=":";a.__valueDelimeter2="=";a.__keyValDelimeter=",";return a}();d.Parser=n;a.global.onModuleLoaded("parser",d)})(r.parser||(r.parser={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(d){var m=function(d){function g(g,p,q){d.call(this);var f=a.global.utils;this._action=g;this._thisObj=p;this._canExecute=q;this._objId="cmd"+f.getNewID()}__extends(g,d);g.prototype._getEventNames=function(){var a=d.prototype._getEventNames.call(this);return["canExecute_changed"].concat(a)};g.prototype.addOnCanExecuteChanged=function(a,d){this.addHandler("canExecute_changed",a,d)};g.prototype.removeOnCanExecuteChanged=function(a){this.removeHandler("canExecute_changed",
a)};g.prototype.canExecute=function(a,d){return this._canExecute?this._canExecute.apply(this._thisObj,[a,d]):!0};g.prototype.execute=function(a,d){this._action&&this._action.apply(this._thisObj,[a,d])};g.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._canExecute=this._thisObj=this._action=null,d.prototype.destroy.call(this))};g.prototype.raiseCanExecuteChanged=function(){this.raiseEvent("canExecute_changed",{})};g.prototype.toString=function(){return"Command"};return g}(a.BaseObject);
d.Command=m;var n=function(d){function g(g){d.call(this);this._app=g;this._objId="vm"+a.global.utils.getNewID()}__extends(g,d);g.prototype.handleError=function(a,g){var q=d.prototype.handleError.call(this,a,g);return q?q:this._app.handleError(a,g)};g.prototype.toString=function(){return"BaseViewModel"};g.prototype.destroy=function(){this._app=null;d.prototype.destroy.call(this)};Object.defineProperty(g.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,
"$",{get:function(){return a.global.$},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"app",{get:function(){return this._app},enumerable:!0,configurable:!0});return g}(a.BaseObject);d.BaseViewModel=n;a.global.registerType("Command",m);a.global.registerType("BaseViewModel",n);a.global.onModuleLoaded("mvvm",d)})(r.mvvm||(r.mvvm={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(d){var m=a.MOD.consts,n=a.MOD.mvvm,k=a.localizable.VALIDATE,g;a.global.addOnInitialize(function(c,a){g=c.utils});n=function(c){function a(b,e,d){c.call(this,b,e,d)}__extends(a,c);return a}(n.Command);d.PropChangedCommand=n;d.css={fieldError:"ria-field-error",commandLink:"ria-command-link"};var h=function(c){function b(a,e,d){c.call(this);this._app=a;this._el=e;this._oldDisplay=this._$el=null;this._objId="elv"+g.getNewID();this._propChangedCommand=null;a._setElView(this._el,
this);this._errors=null;this._toolTip=d.tip;this._css=d.css;this._init(d);this._applyToolTip()}__extends(b,c);b.prototype._applyToolTip=function(){this._toolTip&&this._setToolTip(this.$el,this._toolTip)};b.prototype._init=function(c){this._css&&this.$el.addClass(this._css)};b.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var a=this._$el,b=this._el;a&&a.off("."+this._objId);try{this._$el=this._el=this.toolTip=this.validationErrors=this._propChangedCommand=null}finally{this._app._setElView(b,
null),this._app=null}c.prototype.destroy.call(this)}};b.prototype.invokePropChanged=function(c){c={property:c};this._propChangedCommand&&this._propChangedCommand.execute(this,c)};b.prototype._getErrorTipInfo=function(c){var a=["<b>",k.errorInfo,"</b>","<br/>"];c.forEach(function(c){var b="";c.errors.forEach(function(c){b=b+" "+c});a.push(b);b=""});return a.join("")};b.prototype._setFieldError=function(c){var a=this.$el;c?a.addClass(d.css.fieldError):a.removeClass(d.css.fieldError)};b.prototype._updateErrorUI=
function(c,a){if(c){var b=this.$el;a&&0<a.length?(g.addToolTip(b,this._getErrorTipInfo(a),!0),this._setFieldError(!0)):(this._setToolTip(b,this.toolTip),this._setFieldError(!1))}};b.prototype.handleError=function(a,b){var e=c.prototype.handleError.call(this,a,b);return e?e:this._app.handleError(a,b)};b.prototype._setToolTip=function(c,a,b){g.addToolTip(c,a,b)};b.prototype.toString=function(){return"BaseElView"};Object.defineProperty(b.prototype,"$el",{get:function(){this._el&&!this._$el&&(this._$el=
a.global.$(this._el));return this._$el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isVisible",{get:function(){return"none"!==this.el.style.display},set:function(c){c=!!c;c!==this.isVisible&&(c?this.el.style.display=this._oldDisplay?this._oldDisplay:"":(this._oldDisplay=
this.el.style.display,this.el.style.display="none"),this.raisePropertyChanged("isVisible"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"propChangedCommand",{get:function(){return this._propChangedCommand},set:function(c){c!==this._propChangedCommand&&(this._propChangedCommand=c,this.invokePropChanged("*"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"validationErrors",{get:function(){return this._errors},set:function(c){c!==this._errors&&(this._errors=
c,this.raisePropertyChanged("validationErrors"),this._updateErrorUI(this._el,this._errors))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"dataNameAttr",{get:function(){return this._el.getAttribute(m.DATA_ATTR.DATA_NAME)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"toolTip",{get:function(){return this._toolTip},set:function(c){this._toolTip!=c&&(this._toolTip=c,this._setToolTip(this.$el,c),this.raisePropertyChanged("toolTip"))},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"css",{get:function(){return this._css},set:function(c){var a=this.$el;this._css!=c&&(this._css&&a.removeClass(this._css),(this._css=c)&&a.addClass(this._css),this.raisePropertyChanged("css"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"app",{get:function(){return this._app},enumerable:!0,configurable:!0});return b}(a.BaseObject);d.BaseElView=h;var p=function(c){function a(b,e,d){c.call(this,b,e,d)}__extends(a,c);a.prototype.toString=function(){return"InputElView"};
Object.defineProperty(a.prototype,"isEnabled",{get:function(){return!this.el.disabled},set:function(c){c=!!c;c!==this.isEnabled&&(this.el.disabled=!c,this.raisePropertyChanged("isEnabled"))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"value",{get:function(){var c=this.el;return c?c.value:""},set:function(c){if(this._el){var a=this.el,b=a.value;c=null===c?"":""+c;b!==c&&(a.value=
c,this.raisePropertyChanged("value"))}},enumerable:!0,configurable:!0});return a}(h);d.InputElView=p;var q=function(c){function a(b,e,d){c.call(this,b,e,d);this._commandParam=this._command=null;this.isEnabled||this.$el.addClass("disabled")}__extends(a,c);a.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._command&&this._command.removeNSHandlers(this._objId),this.commandParam=this.command=null,c.prototype.destroy.call(this))};a.prototype.invokeCommand=function(){var c=
this,a=c.command,b=c.commandParam;a&&a.canExecute(c,b)&&setTimeout(function(){a.canExecute(c,b)&&a.execute(c,b)},0)};a.prototype._onCommandChanged=function(){this.raisePropertyChanged("command")};a.prototype._setCommand=function(c){var a=this;c!==this._command&&(this._command&&this._command.removeNSHandlers(this._objId),(this._command=c)?(this._command.addOnCanExecuteChanged(function(c,b){a.isEnabled=c.canExecute(a,a.commandParam)},this._objId),a.isEnabled=this._command.canExecute(a,a.commandParam)):
a.isEnabled=!1,this._onCommandChanged())};a.prototype.toString=function(){return"CommandElView"};Object.defineProperty(a.prototype,"isEnabled",{get:function(){return!this.$el.prop("disabled")},set:function(c){c!==this.isEnabled&&(this.$el.prop("disabled",!c),c?this.$el.removeClass("disabled"):this.$el.addClass("disabled"),this.raisePropertyChanged("isEnabled"))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"command",{get:function(){return this._command},set:function(c){this._setCommand(c)},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"commandParam",{get:function(){return this._commandParam},set:function(c){c!==this._commandParam&&(this._commandParam=c,this.raisePropertyChanged("commandParam"))},enumerable:!0,configurable:!0});return a}(h);d.CommandElView=q;n=function(c){function b(a,e,d){c.call(this,a,e,d)}__extends(b,c);b.prototype._init=function(b){c.prototype._init.call(this,b);var e;e=b.img?b.img:m.LOADER_GIF.NORMAL;this._delay=400;this._timeOut=null;g.check.isNt(b.delay)||
(this._delay=parseInt(b.delay));this._loaderPath=a.global.getImagePath(e);this._$loader=a.global.$(new Image);this._$loader.css({position:"absolute",display:"none",zIndex:"10000"});this._$loader.prop("src",this._loaderPath);this._$loader.appendTo(this.el);this._isBusy=!1};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._timeOut&&(clearTimeout(this._timeOut),this._timeOut=null),this._$loader.remove(),this._$loader=null,c.prototype.destroy.call(this))};b.prototype.toString=
function(){return"BusyElView"};Object.defineProperty(b.prototype,"isBusy",{get:function(){return this._isBusy},set:function(c){var b=this,e=function(){b._timeOut=null;b._$loader.show();b._$loader.position({of:a.global.$(b.el)})};c!==b._isBusy&&(b._isBusy=c,b._isBusy?(b._timeOut&&(clearTimeout(b._timeOut),b._timeOut=null),0<b._delay?b._timeOut=setTimeout(e,b._delay):e()):b._timeOut?(clearTimeout(b._timeOut),b._timeOut=null):b._$loader.hide(),b.raisePropertyChanged("isBusy"))},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"delay",{get:function(){return this._delay},set:function(c){c!==this._delay&&(this._delay=c,this.raisePropertyChanged("delay"))},enumerable:!0,configurable:!0});return b}(h);d.BusyElView=n;var f=function(c){function b(){c.apply(this,arguments)}__extends(b,c);b.prototype._init=function(a){var b=this;c.prototype._init.call(this,a);this._val=this.el.checked;this.$el.on("change."+this._objId,function(c){c.stopPropagation();b.checked=this.checked})};b.prototype._setFieldError=
function(c){var b=this.$el;c?(c=a.global.$("<div></div>").addClass(d.css.fieldError),b.wrap(c)):0<b.parent("."+d.css.fieldError).length&&b.unwrap()};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this.$el.off("."+this._objId),c.prototype.destroy.call(this))};b.prototype.toString=function(){return"CheckBoxElView"};Object.defineProperty(b.prototype,"checked",{get:function(){return this._val},set:function(c){var a=this.el;null!==c&&(c=!!c);c!==this._val&&(this._val=c,a&&
(a.checked=!!this._val),null===this._val?this.$el.css("opacity",.33):this.$el.css("opacity",1),this.raisePropertyChanged("checked"))},enumerable:!0,configurable:!0});return b}(p);d.CheckBoxElView=f;var e=function(c){function b(){c.apply(this,arguments)}__extends(b,c);b.prototype._init=function(a){var b=this;c.prototype._init.call(this,a);this._val=this.el.checked;this._cbxVal=null==this._val?1:this._val?2:0;this.$el.on("change."+this._objId,function(c){c.stopPropagation();switch(b._cbxVal){case 0:b._cbxVal=
1;break;case 1:b._cbxVal=2;break;default:b._cbxVal=0}b.checked=1==b._cbxVal?null:2==b._cbxVal?!0:!1})};b.prototype._setFieldError=function(c){var b=this.$el;c?(c=a.global.$("<div></div>").addClass(d.css.fieldError),b.wrap(c)):0<b.parent("."+d.css.fieldError).length&&b.unwrap()};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this.$el.off("."+this._objId),c.prototype.destroy.call(this))};b.prototype.toString=function(){return"CheckBoxThreeStateElView"};Object.defineProperty(b.prototype,
"checked",{get:function(){return this._val},set:function(c){var a=this.$el;if(c!==this._val){this._val=c;switch(this._val){case null:a.prop("indeterminate",!0);this._cbxVal=1;break;case !0:a.prop("indeterminate",!1);a.prop("checked",!0);this._cbxVal=2;break;default:a.prop("indeterminate",!1),a.prop("checked",!1),this._cbxVal=0}this.raisePropertyChanged("checked")}},enumerable:!0,configurable:!0});return b}(p);d.CheckBoxThreeStateElView=e;var l=function(c){function a(){c.apply(this,arguments)}__extends(a,
c);a.prototype._init=function(a){var b=this;c.prototype._init.call(this,a);var e=this.$el;e.on("change."+this._objId,function(c){c.stopPropagation();b.raisePropertyChanged("value")});e.on("keypress."+this._objId,function(c){c.stopPropagation();var a={keyCode:c.which,value:c.target.value,isCancel:!1};b.raiseEvent("keypress",a);a.isCancel&&c.preventDefault()});if(a.updateOnKeyUp)e.on("keyup."+this._objId,function(c){c.stopPropagation();b.raisePropertyChanged("value")})};a.prototype._getEventNames=function(){var a=
c.prototype._getEventNames.call(this);return["keypress"].concat(a)};a.prototype.addOnKeyPress=function(c,a){this.addHandler("keypress",c,a)};a.prototype.removeOnKeyPress=function(c){this.removeHandler("keypress",c)};a.prototype.toString=function(){return"TextBoxElView"};Object.defineProperty(a.prototype,"color",{get:function(){return this.$el.css("color")},set:function(c){var a=this.$el,b=a.css("color");c!==b&&(a.css("color",c),this.raisePropertyChanged("color"))},enumerable:!0,configurable:!0});
return a}(p);d.TextBoxElView=l;var b=function(c){function a(){c.apply(this,arguments)}__extends(a,c);a.prototype.toString=function(){return"HiddenElView"};return a}(p);d.HiddenElView=b;var c=function(c){function a(b,e,d){c.call(this,b,e,d)}__extends(a,c);a.prototype._init=function(a){c.prototype._init.call(this,a);var b=this;a.rows&&(this.rows=a.rows);a.cols&&(this.cols=a.cols);a.wrap&&(this.wrap=a.wrap);var e=this.$el;e.on("change."+this._objId,function(c){c.stopPropagation();b.raisePropertyChanged("value")});
e.on("keypress."+this._objId,function(c){c.stopPropagation();var a={keyCode:c.which,value:c.target.value,isCancel:!1};b.raiseEvent("keypress",a);a.isCancel&&c.preventDefault()});if(a.updateOnKeyUp)e.on("keyup."+this._objId,function(c){c.stopPropagation();b.raisePropertyChanged("value")})};a.prototype._getEventNames=function(){var a=c.prototype._getEventNames.call(this);return["keypress"].concat(a)};a.prototype.addOnKeyPress=function(c,a){this.addHandler("keypress",c,a)};a.prototype.removeOnKeyPress=
function(c){this.removeHandler("keypress",c)};a.prototype.toString=function(){return"TextAreaElView"};Object.defineProperty(a.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"value",{get:function(){var c=this.el;return c?c.value:""},set:function(c){if(this._el){var a=this.el,b=a.value;c=null===c?"":""+c;b!==c&&(a.value=c,this.raisePropertyChanged("value"))}},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isEnabled",
{get:function(){return!this.el.disabled},set:function(c){c=!!c;c!==this.isEnabled&&(this.el.disabled=!c,this.raisePropertyChanged("isEnabled"))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"rows",{get:function(){var c=this.el;return c?c.rows:1},set:function(c){var a=this.el;if(a){var b=a.rows;c=c?c:1;b!==c&&(a.rows=c,this.raisePropertyChanged("rows"))}},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"cols",{get:function(){var c=this.el;return c?c.cols:1},set:function(c){var a=
this.el;if(a){var b=a.cols;c=c?c:1;b!==c&&(a.cols=c,this.raisePropertyChanged("cols"))}},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"wrap",{get:function(){var c=this.el;return c?c.wrap:"off"},set:function(c){var a=this.el;if(a){var b=a.wrap;c=c?c:"off";0>["hard","off","soft"].indexOf(c)&&(c="off");b!==c&&(a.wrap=c,this.raisePropertyChanged("wrap"))}},enumerable:!0,configurable:!0});return a}(h);d.TextAreaElView=c;p=function(c){function b(){c.apply(this,arguments)}__extends(b,
c);b.prototype._init=function(a){var b=this;c.prototype._init.call(this,a);this._val=this.el.checked;this.$el.on("change."+this._objId,function(c){c.stopPropagation();b.checked=this.checked;b._updateGroup()})};b.prototype._updateGroup=function(){var c=this.el.getAttribute("name"),b=this;if(c){var e=this.el.parentElement;if(e){var b=this,d=b.el;a.global.$('input[type="radio"][name="'+c+'"]',e).each(function(c,a){if(d!==this){var e=b.app._getElView(this);e&&(e.checked=this.checked)}})}}};b.prototype._setFieldError=
function(c){var b=this.$el;c?(c=a.global.$("<div></div>").addClass(d.css.fieldError),b.wrap(c)):0<b.parent("."+d.css.fieldError).length&&b.unwrap()};b.prototype.toString=function(){return"RadioElView"};Object.defineProperty(b.prototype,"checked",{get:function(){return this._val},set:function(c){var a=this.el;null!==c&&(c=!!c);c!==this._val&&(this._val=c,a&&(a.checked=!!this._val),null===this._val?this.$el.css("opacity",.33):this.$el.css("opacity",1),this.raisePropertyChanged("checked"))},enumerable:!0,
configurable:!0});Object.defineProperty(b.prototype,"value",{get:function(){return this.el.value},set:function(c){var a=this.el;if(a){var b=""+c;null===c&&(b="");b!==a.value&&(a.value=b,this.raisePropertyChanged("value"))}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"name",{get:function(){return this.el.name},enumerable:!0,configurable:!0});return b}(p);d.RadioElView=p;var v=function(c){function a(b,e,d){this._preventDefault=!1;c.call(this,b,e,d)}__extends(a,c);a.prototype._init=
function(a){c.prototype._init.call(this,a);var b=this,e=this.$el;a.preventDefault&&(this._preventDefault=!0);e.on("click."+this._objId,function(c){b._onClick(c)})};a.prototype._onClick=function(c){this._preventDefault&&c.preventDefault();this.invokeCommand()};a.prototype.toString=function(){return"ButtonElView"};Object.defineProperty(a.prototype,"value",{get:function(){return this._el?this.$el.val():""},set:function(c){if(this._el){var a=this.$el.val();c=null===c?"":""+c;a!==c&&(this.$el.val(c),this.raisePropertyChanged("value"))}},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"text",{get:function(){return this._el?this.$el.text():""},set:function(c){if(this._el){var a=this.$el.text();c=null===c?"":""+c;a!==c&&(this.$el.text(c),this.raisePropertyChanged("text"))}},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"html",{get:function(){return this._el?this.$el.html():""},set:function(c){if(this._el){var a=this.$el.html();c=null===c?"":""+c;a!==c&&(this.$el.html(c),this.raisePropertyChanged("html"))}},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"preventDefault",{get:function(){return this._preventDefault},set:function(c){this._preventDefault!==c&&(this._preventDefault=c,this.raisePropertyChanged("preventDefault"))},enumerable:!0,configurable:!0});return a}(q);d.ButtonElView=v;q=function(c){function b(a,e,d){this._image=this._imageSrc=null;this._preventDefault=!1;c.call(this,a,e,d)}__extends(b,c);b.prototype._init=function(a){c.prototype._init.call(this,a);var b=this,e=this.$el;
a.imageSrc&&(this.imageSrc=a.imageSrc);a.preventDefault&&(this._preventDefault=!0);e.addClass(d.css.commandLink);e.on("click."+this._objId,function(c){b._onClick(c)})};b.prototype._onClick=function(c){this._preventDefault&&c.preventDefault();this.invokeCommand()};b.prototype._updateImage=function(c){var b=this.$el,e=this;this._imageSrc!==c&&(this._imageSrc=c,this._image&&!c&&(a.global.$(this._image).remove(),this._image=null),c&&(this._image?this._image.src=c:(e.html=null,c=a.global.$(new Image).attr("src",
c).mouseenter(function(c){e.isEnabled&&a.global.$(this).css("opacity",.5)}).mouseout(function(c){e.isEnabled&&a.global.$(this).css("opacity",1)}).appendTo(b),this._image=c.get(0))))};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this.$el.removeClass(d.css.commandLink),this.imageSrc=null,c.prototype.destroy.call(this))};b.prototype.toString=function(){return"AnchorElView"};Object.defineProperty(b.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"imageSrc",{get:function(){return this._imageSrc},set:function(c){this._$el&&this._imageSrc!==c&&(this._updateImage(c),this.raisePropertyChanged("imageSrc"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"html",{get:function(){return this._el?this.$el.html():""},set:function(c){if(this._el){var a=this.$el.html();c=null===c?"":""+c;a!==c&&(this.$el.html(c),this.raisePropertyChanged("html"))}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"text",{get:function(){return this._el?this.$el.text():""},set:function(c){if(this._el){var a=this.$el.text();c=null===c?"":""+c;a!==c&&(this.$el.text(c),this.raisePropertyChanged("text"))}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"href",{get:function(){return this._el?this.el.href:""},set:function(c){if(this._el){var a=this.href;c=null===c?"":""+c;a!==c&&(this.el.href=c,this.raisePropertyChanged("href"))}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"preventDefault",{get:function(){return this._preventDefault},set:function(c){this._preventDefault!==c&&(this._preventDefault=c,this.raisePropertyChanged("preventDefault"))},enumerable:!0,configurable:!0});return b}(q);d.AnchorElView=q;var A=function(c){function b(){c.apply(this,arguments)}__extends(b,c);b.prototype._init=function(b){this._expandedsrc=b.expandedsrc||a.global.getImagePath("collapse.jpg");this._collapsedsrc=b.collapsedsrc||a.global.getImagePath("expand.jpg");this._isExpanded=!!b.isExpanded;
c.prototype._init.call(this,{imageSrc:this._isExpanded?this._expandedsrc:this._collapsedsrc})};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._collapsedsrc=this._expandedsrc=null,this._isExpanded=!1,c.prototype.destroy.call(this))};b.prototype._onCommandChanged=function(){c.prototype._onCommandChanged.call(this);this.invokeCommand()};b.prototype._onClick=function(a){this._isExpanded=!this._isExpanded;c.prototype._onClick.call(this,a)};b.prototype.invokeCommand=function(){this.imageSrc=
this._isExpanded?this._expandedsrc:this._collapsedsrc;c.prototype.invokeCommand.call(this)};b.prototype.toString=function(){return"ExpanderElView"};Object.defineProperty(b.prototype,"isExpanded",{get:function(){return this._isExpanded},set:function(c){this._isExpanded!==c&&(this._isExpanded=c,this.invokeCommand(),this.raisePropertyChanged("isExpanded"))},enumerable:!0,configurable:!0});return b}(q);d.ExpanderElView=A;var B=function(c){function a(){c.apply(this,arguments)}__extends(a,c);a.prototype.toString=
function(){return"SpanElView"};Object.defineProperty(a.prototype,"text",{get:function(){return this.$el.text()},set:function(c){var a=this.$el,b=a.text();c=null===c?"":""+c;b!==c&&(a.text(c),this.raisePropertyChanged("text"),this.raisePropertyChanged("value"))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"value",{get:function(){return this.text},set:function(c){this.text=c},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"html",{get:function(){return this.el.innerHTML},
set:function(c){var a=this.el.innerHTML;c=null===c?"":""+c;a!==c&&(this.el.innerHTML=c,this.raisePropertyChanged("html"))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"color",{get:function(){return this.$el.css("color")},set:function(c){var a=this.$el,b=a.css("color");c!==b&&(a.css("color",c),this.raisePropertyChanged("color"))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fontSize",{get:function(){return this.$el.css("font-size")},set:function(c){var a=
this.$el,b=a.css("font-size");c!==b&&(a.css("font-size",c),this.raisePropertyChanged("fontSize"))},enumerable:!0,configurable:!0});return a}(h);d.SpanElView=B;var r=function(c){function a(){c.apply(this,arguments)}__extends(a,c);a.prototype.toString=function(){return"BlockElView"};Object.defineProperty(a.prototype,"borderColor",{get:function(){return this.$el.css("border-top-color")},set:function(c){var a=this.$el.css("border-top-color");c!==a&&(this.el.style.borderColor=c,this.raisePropertyChanged("borderColor"))},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"borderStyle",{get:function(){return this.$el.css("border-top-style")},set:function(c){var a=this.$el,b=a.css("border-top-style");c!==b&&(a.css("border-style",c),this.raisePropertyChanged("borderStyle"))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"width",{get:function(){return this.$el.width()},set:function(c){var a=this.$el,b=a.width();c!==b&&(a.width(c),this.raisePropertyChanged("width"))},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"height",{get:function(){return this.$el.height()},set:function(c){var a=this.$el,b=a.height();c!==b&&(a.height(c),this.raisePropertyChanged("height"))},enumerable:!0,configurable:!0});return a}(B);d.BlockElView=r;h=function(c){function a(b,e,d){c.call(this,b,e,d)}__extends(a,c);a.prototype.toString=function(){return"ImgElView"};Object.defineProperty(a.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"src",{get:function(){return this.el.src},set:function(c){this.el.src!==c&&(this.el.src=c,this.raisePropertyChanged("src"))},enumerable:!0,configurable:!0});return a}(h);d.ImgElView=h;a.global.registerElView("busy_indicator",n);a.global.registerElView("input:checkbox",f);a.global.registerElView("threeState",e);a.global.registerElView("input:text",l);a.global.registerElView("input:hidden",b);a.global.registerElView("textarea",c);a.global.registerElView("input:radio",p);a.global.registerElView("input:button",
v);a.global.registerElView("input:submit",v);a.global.registerElView("button",v);a.global.registerElView("a",q);a.global.registerElView("abutton",q);a.global.registerElView("expander",A);a.global.registerElView("span",B);a.global.registerElView("div",r);a.global.registerElView("section",r);a.global.registerElView("block",r);a.global.registerElView("img",h);a.global.onModuleLoaded("baseElView",d)})(r.baseElView||(r.baseElView={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(d){(function(a){a[a.OneTime=0]="OneTime";a[a.OneWay=1]="OneWay";a[a.TwoWay=2]="TwoWay"})(d.BINDING_MODE||(d.BINDING_MODE={}));var m=d.BINDING_MODE,n=a.global,k=a.baseUtils,g,h;n.addOnInitialize(function(a,d){g=a.utils;h=a.parser});var p=function(d){function f(e,l){d.call(this);var b=g.extend(!1,{target:null,source:null,targetPath:null,sourcePath:null,mode:1,converter:null,converterParam:null,isSourceFixed:!1},e);g.check.isString(b.mode)&&(b.mode=m[b.mode]);if(!g.check.isString(b.targetPath)){if(2==
a.DebugLevel)debugger;throw Error(k.format(a.ERRS.ERR_BIND_TGTPATH_INVALID,b.targetPath));}if(g.check.isUndefined(m[b.mode])){if(2==a.DebugLevel)debugger;throw Error(k.format(a.ERRS.ERR_BIND_MODE_INVALID,b.mode));}if(!b.target)throw Error(a.ERRS.ERR_BIND_TARGET_EMPTY);if(!g.check.isBaseObj(b.target))throw Error(a.ERRS.ERR_BIND_TARGET_INVALID);this._appName=l;this._state=null;this._mode=b.mode;this._converter=b.converter||n._getConverter("BaseConverter");this._converterParam=b.converterParam;this._srcPath=
h.getPathParts(b.sourcePath);this._tgtPath=h.getPathParts(b.targetPath);if(1>this._tgtPath.length)throw Error(g.format(a.ERRS.ERR_BIND_TGTPATH_INVALID,b.targetPath));this._isSourceFixed=!!b.isSourceFixed;this._pathItems={};this._objId="bnd"+g.getNewID();this._ignoreTgtChange=this._ignoreSrcChange=!1;this._target=this._source=this._targetObj=this._sourceObj=null;this.target=b.target;this.source=b.source;(b=g.getErrorNotification(this._sourceObj))&&b.getIsHasErrors()&&this._onSrcErrorsChanged(b)}__extends(f,
d);f.prototype._getOnTgtDestroyedProxy=function(){var a=this;return function(d,b){a._onTgtDestroyed(d,b)}};f.prototype._getOnSrcDestroyedProxy=function(){var a=this;return function(d,b){a._onSrcDestroyed(d,b)}};f.prototype._getUpdTgtProxy=function(){var a=this;return function(d,b){a._updateTarget()}};f.prototype._getUpdSrcProxy=function(){var a=this;return function(d,b){a._updateSource()}};f.prototype._getSrcErrChangedProxy=function(){var a=this;return function(d,b){a._onSrcErrorsChanged(d)}};f.prototype._onSrcErrorsChanged=
function(a){var d=[],b=this._targetObj,c=this._sourceObj,f=this._srcPath;b&&g.check.isElView(b)&&(c&&0<f.length&&(d=a.getFieldErrors(f[f.length-1])),b.validationErrors=d)};f.prototype._getTgtChangedFn=function(a,d,b,c,f){return function(g,q){var p=h.resolveProp(d,b);0<c.length&&a._setPathItem(null,1,f,c);a._parseTgtPath(p,c,f)}};f.prototype._getSrcChangedFn=function(a,d,b,c,f){return function(g,q){var p=h.resolveProp(d,b);0<c.length&&a._setPathItem(null,0,f,c);a._parseSrcPath(p,c,f)}};f.prototype._parseSrcPath=
function(a,d,b){var c=!1;this._sourceObj=null;0===d.length?this._sourceObj=a:this._parseSrcPath2(a,d,b);g.check.isBaseObj(this._targetObj)&&(c=this._targetObj.getIsDestroyCalled());this._targetObj&&!c&&this._updateTarget()};f.prototype._parseSrcPath2=function(e,d,b){var c=!!e&&g.check.isBaseObj(e);c&&(e.addOnDestroyed(this._getOnSrcDestroyedProxy(),this._objId),this._setPathItem(e,0,b,d));if(1<d.length){if(c&&e.addOnPropertyChange(d[0],this._getSrcChangedFn(this,e,d[0],d.slice(1),b+1),this._objId),
e)if(e=n.parser.resolveProp(e,d[0]))this._parseSrcPath2(e,d.slice(1),b+1);else if(k.isUndefined(e)){if(2==a.DebugLevel)debugger;0<a.DebugLevel&&n._onUnResolvedBinding(0,this.source,this._srcPath.join("."),d[0])}}else if(e&&1==d.length)if(b=!0,0!=a.DebugLevel&&(b=c?e._isHasProp(d[0]):k.hasProp(e,d[0])),b)!c||1!==this._mode&&2!==this._mode||e.addOnPropertyChange(d[0],this._getUpdTgtProxy(),this._objId),(d=g.getErrorNotification(e))&&d.addOnErrorsChanged(this._getSrcErrChangedProxy(),this._objId),this._sourceObj=
e;else{if(2==a.DebugLevel)debugger;n._onUnResolvedBinding(0,this.source,this._srcPath.join("."),d[0])}};f.prototype._parseTgtPath=function(a,d,b){this._targetObj=null;0===d.length?this._targetObj=a:this._parseTgtPath2(a,d,b);this._targetObj&&this._updateTarget()};f.prototype._parseTgtPath2=function(e,d,b){var c=!!e&&g.check.isBaseObj(e);c&&(e.addOnDestroyed(this._getOnTgtDestroyedProxy(),this._objId),this._setPathItem(e,1,b,d));if(1<d.length){if(c&&e.addOnPropertyChange(d[0],this._getTgtChangedFn(this,
e,d[0],d.slice(1),b+1),this._objId),e)if(e=n.parser.resolveProp(e,d[0]))this._parseTgtPath2(e,d.slice(1),b+1);else if(k.isUndefined(e)){if(2==a.DebugLevel)debugger;0<a.DebugLevel&&n._onUnResolvedBinding(1,this.target,this._tgtPath.join("."),d[0])}}else if(e&&1===d.length)if(b=!0,0!=a.DebugLevel&&(b=c?e._isHasProp(d[0]):k.hasProp(e,d[0])),b)c&&2===this._mode&&e.addOnPropertyChange(d[0],this._getUpdSrcProxy(),this._objId),this._targetObj=e;else{if(2==a.DebugLevel)debugger;n._onUnResolvedBinding(1,this.target,
this._tgtPath.join("."),d[0])}};f.prototype._setPathItem=function(e,d,b,c){for(var f,g=b+c.length,h=b;h<g;h+=1){switch(d){case 0:f="s"+h;break;case 1:f="t"+h;break;default:throw Error(a.baseUtils.format(a.ERRS.ERR_PARAM_INVALID,"bindingTo",d));}if(c=this._pathItems[f])this._cleanUpObj(c),delete this._pathItems[f];e&&h==b&&(this._pathItems[f]=e)}};f.prototype._cleanUpObj=function(a){a&&(a.removeNSHandlers(this._objId),(a=g.getErrorNotification(a))&&a.removeOnErrorsChanged(this._objId))};f.prototype._onTgtDestroyed=
function(a,d){this._isDestroyCalled||this._setTarget(null)};f.prototype._onSrcDestroyed=function(a,d){var b=this;b._isDestroyCalled||(a===b.source?b._setSource(null):(b._setPathItem(null,0,0,b._srcPath),setTimeout(function(){b._isDestroyCalled||b._bindToSource()},0)))};f.prototype._bindToSource=function(){this._parseSrcPath(this.source,this._srcPath,0)};f.prototype._bindToTarget=function(){this._parseTgtPath(this.target,this._tgtPath,0)};f.prototype._updateTarget=function(){if(!this._ignoreSrcChange){this._ignoreTgtChange=
!0;try{var a=this._converter.convertToTarget(this.sourceValue,this._converterParam,this._sourceObj);void 0!==a&&(this.targetValue=a)}catch(d){n.reThrow(d,this.handleError(d,this))}finally{this._ignoreTgtChange=!1}}};f.prototype._updateSource=function(){if(!this._ignoreTgtChange){this._ignoreSrcChange=!0;try{var e=this._converter.convertToSource(this.targetValue,this._converterParam,this._sourceObj);void 0!==e&&(this.sourceValue=e)}catch(d){if(!(d instanceof a.MOD.errors.ValidationError&&g.check.isElView(this._targetObj)||
(this._ignoreSrcChange=!1,this._updateTarget(),this.handleError(d,this))))throw d;}finally{this._ignoreSrcChange=!1}}};f.prototype._setTarget=function(e){var d=!1;g.check.isBaseObj(this._targetObj)&&(d=this._targetObj.getIsDestroyCalled());if(this._state)this._state.target=e;else if(this._target!==e){if(this._targetObj&&!d){this._ignoreTgtChange=!0;try{this.targetValue=null}finally{this._ignoreTgtChange=!1}}this._setPathItem(null,1,0,this._tgtPath);if(e&&!g.check.isBaseObj(e))throw Error(a.ERRS.ERR_BIND_TARGET_INVALID);
this._target=e;this._bindToTarget();if(this._target&&!this._targetObj)throw Error(g.format(a.ERRS.ERR_BIND_TGTPATH_INVALID,this._tgtPath.join(".")));}};f.prototype._setSource=function(a){this._state?this._state.source=a:this._source!==a&&(this._setPathItem(null,0,0,this._srcPath),this._source=a,this._bindToSource())};f.prototype.handleError=function(a,l){var b=d.prototype.handleError.call(this,a,l);return b?b:this._appName?n.findApp(this._appName).handleError(a,l):n.handleError(a,l)};f.prototype.destroy=
function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var a=this;g.forEachProp(this._pathItems,function(d){a._cleanUpObj(a._pathItems[d])});this._pathItems={};this._setSource(null);this._setTarget(null);this._target=this._source=this._targetObj=this._sourceObj=this._tgtPath=this._srcPath=this._converterParam=this._converter=this._state=null;d.prototype.destroy.call(this)}};f.prototype.toString=function(){return"Binding"};Object.defineProperty(f.prototype,"bindingID",{get:function(){return this._objId},
enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"target",{get:function(){return this._target},set:function(a){this._setTarget(a)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"source",{get:function(){return this._source},set:function(a){this._setSource(a)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"targetPath",{get:function(){return this._tgtPath},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"sourcePath",{get:function(){return this._srcPath},
enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"sourceValue",{get:function(){return 0===this._srcPath.length?this._sourceObj:null===this._sourceObj?null:n.parser.resolveProp(this._sourceObj,this._srcPath[this._srcPath.length-1])},set:function(a){0!==this._srcPath.length&&null!==this._sourceObj&&(g.check.isBaseObj(this._sourceObj)&&this._sourceObj.getIsDestroyCalled()||n.parser.setPropertyValue(this._sourceObj,this._srcPath[this._srcPath.length-1],a))},enumerable:!0,configurable:!0});
Object.defineProperty(f.prototype,"targetValue",{get:function(){return null===this._targetObj?null:n.parser.resolveProp(this._targetObj,this._tgtPath[this._tgtPath.length-1])},set:function(a){null!==this._targetObj&&(g.check.isBaseObj(this._targetObj)&&this._targetObj.getIsDestroyCalled()||n.parser.setPropertyValue(this._targetObj,this._tgtPath[this._tgtPath.length-1],a))},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"mode",{get:function(){return this._mode},enumerable:!0,configurable:!0});
Object.defineProperty(f.prototype,"converter",{get:function(){return this._converter},set:function(a){this._converter=a},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"converterParam",{get:function(){return this._converterParam},set:function(a){this._converterParam=a},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"isSourceFixed",{get:function(){return this._isSourceFixed},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"isDisabled",{get:function(){return!!this._state},
set:function(a){a=!!a;if(this.isDisabled!=a)if(a){a={source:this._source,target:this._target};try{this.source=this.target=null}finally{this._state=a}}else a=this._state,this._state=null,this._setTarget(a.target),this._setSource(a.source)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"appName",{get:function(){return this._appName},enumerable:!0,configurable:!0});return f}(a.BaseObject);d.Binding=p;n.onModuleLoaded("binding",d)})(r.binding||(r.binding={}))})(a.MOD||(a.MOD={}))})(RIAPP||
(RIAPP={}));
(function(a){(function(r){(function(d){function m(d,b){var c=b.filter(function(c){return c.fieldName==d});if(!c||1!=c.length)throw Error(q.format(a.ERRS.ERR_ASSERTION_FAILED,"arrProps.length == 1"));return c[0]}function n(a,b){function c(a,b,d){if(5==b.fieldType){if(d(a,b),b.nested&&0<b.nested.length){var e,l,f=b.nested.length;for(l=0;l<f;l+=1)e=b.nested[l],5==e.fieldType?c(a+"."+e.fieldName,e,d):d(a+"."+e.fieldName,e)}}else d(a,b)}c(a.fieldName,a,b)}var k=a.MOD.utils,g=a.MOD.errors.ValidationError,h=
k.valueUtils,p=a.baseUtils,q;a.global.addOnInitialize(function(a,b){q=a.utils});(function(a){a[a.None=0]="None";a[a.ClientOnly=1]="ClientOnly";a[a.Calculated=2]="Calculated";a[a.Navigation=3]="Navigation";a[a.RowTimeStamp=4]="RowTimeStamp";a[a.Object=5]="Object";a[a.ServerCalculated=6]="ServerCalculated"})(d.FIELD_TYPE||(d.FIELD_TYPE={}));(function(a){a[a.NONE=0]="NONE";a[a.ADDED=1]="ADDED";a[a.UPDATED=2]="UPDATED";a[a.DELETED=3]="DELETED"})(d.STATUS||(d.STATUS={}));(function(a){a[a.REMOVE=0]="REMOVE";
a[a.ADDED=1]="ADDED";a[a.RESET=2]="RESET";a[a.REMAP_KEY=3]="REMAP_KEY"})(d.COLL_CHANGE_TYPE||(d.COLL_CHANGE_TYPE={}));(function(a){a[a.ASC=0]="ASC";a[a.DESC=1]="DESC"})(d.SORT_ORDER||(d.SORT_ORDER={}));(function(a){a[a.Equals=0]="Equals";a[a.Between=1]="Between";a[a.StartsWith=2]="StartsWith";a[a.EndsWith=3]="EndsWith";a[a.Contains=4]="Contains";a[a.Gt=5]="Gt";a[a.Lt=6]="Lt";a[a.GtEq=7]="GtEq";a[a.LtEq=8]="LtEq";a[a.NotEq=9]="NotEq"})(d.FILTER_TYPE||(d.FILTER_TYPE={}));d.fn_getPropertyByName=m;d.fn_traverseField=
n;var f=function(d){function b(){d.call(this);this._fkey=null;this._isEditing=!1;this._saveVals=null;this._vals={};this._notEdited=!0}__extends(b,d);b.prototype._getEventNames=function(){var c=d.prototype._getEventNames.call(this);return["errors_changed"].concat(c)};b.prototype._onErrorsChanged=function(c){this.raiseEvent("errors_changed",c)};b.prototype.handleError=function(c,a){var b=d.prototype.handleError.call(this,c,a);return b?b:this._collection.handleError(c,a)};b.prototype._beginEdit=function(){var c=
this._collection;if(c.isEditing){var b=c._getEditingItem();if(b._aspect===this)return!1;try{b._aspect.endEdit(),b._aspect.getIsHasErrors()&&(this.handleError(new g(b._aspect.getAllErrors(),b),b),b._aspect.cancelEdit())}catch(d){c=this.handleError(d,b),b._aspect.cancelEdit(),a.global.reThrow(d,c)}}if(!this._key)return!1;this._isEditing=!0;this._saveVals=q.cloneObj(this._vals);this._collection.currentItem=this.getItem();return!0};b.prototype._endEdit=function(){if(!this._isEditing)return!1;var c=this._collection;
if(this.getIsHasErrors())return!1;c._removeAllErrors(this.getItem());var a=this._validateAll();0<a.length&&c._addErrors(this.getItem(),a);if(this.getIsHasErrors())return!1;this._isEditing=!1;this._saveVals=null;return!0};b.prototype._validate=function(){return this._collection._validateItem(this.getItem())};b.prototype._skipValidate=function(c,a){return!1};b.prototype._validateField=function(c){var b,d=this.getFieldInfo(c),e=null;try{b=p.getValue(this._vals,c);if(this._skipValidate(d,b))return e;
if(this._isNew){if(null===b&&!d.isNullable&&!d.isReadOnly&&!d.isAutoGenerated)throw Error(a.ERRS.ERR_FIELD_ISNOT_NULLABLE);}else if(null===b&&!d.isNullable&&!d.isReadOnly)throw Error(a.ERRS.ERR_FIELD_ISNOT_NULLABLE);}catch(l){e={fieldName:c,errors:[l.message]}}c=this._collection._validateItemField(this.getItem(),c);e&&c?e.errors=e.errors.concat(c.errors):c&&(e=c);return e};b.prototype._validateAll=function(){var c=this,a=[];this._collection.getFieldInfos().forEach(function(b){n(b,function(b,d){if(5!=
d.fieldType){var e=c._validateField(b);e&&a.push(e)}})});var b=c._validate();b&&a.push(b);return a};b.prototype._checkVal=function(c,b){var d=b,e=a.ERRS;if(this._skipValidate(c,b))return d;if(c.isReadOnly&&(!c.allowClientDefault||!this._isNew))throw Error(e.ERR_FIELD_READONLY);if((null===b||q.check.isString(b)&&!b)&&!c.isNullable)throw Error(e.ERR_FIELD_ISNOT_NULLABLE);if(null===b)return b;switch(c.dataType){case 0:break;case 9:case 1:if(!q.check.isString(b))throw Error(q.format(e.ERR_FIELD_WRONG_TYPE,
b,"String"));if(0<c.maxLength&&b.length>c.maxLength)throw Error(q.format(e.ERR_FIELD_MAXLEN,c.maxLength));c.isNullable&&""===b&&(d=null);if(c.regex&&!(new RegExp(c.regex,"i")).test(b))throw Error(q.format(e.ERR_FIELD_REGEX,b));break;case 10:if(!q.check.isArray(b))throw Error(q.format(e.ERR_FIELD_WRONG_TYPE,b,"Array"));if(0<c.maxLength&&b.length>c.maxLength)throw Error(q.format(e.ERR_FIELD_MAXLEN,c.maxLength));break;case 2:if(!q.check.isBoolean(b))throw Error(q.format(e.ERR_FIELD_WRONG_TYPE,b,"Boolean"));
break;case 3:case 4:case 5:if(!q.check.isNumber(b))throw Error(q.format(e.ERR_FIELD_WRONG_TYPE,b,"Number"));c.range&&q.validation.checkNumRange(Number(b),c.range);break;case 6:case 7:if(!q.check.isDate(b))throw Error(q.format(e.ERR_FIELD_WRONG_TYPE,b,"Date"));c.range&&q.validation.checkDateRange(b,c.range);break;case 8:if(!q.check.isDate(b))throw Error(q.format(e.ERR_FIELD_WRONG_TYPE,b,"Time"));break;default:throw Error(q.format(e.ERR_PARAM_INVALID,"dataType",c.dataType));}return d};b.prototype._resetIsNew=
function(){};b.prototype.addOnErrorsChanged=function(c,a){this.addHandler("errors_changed",c,a)};b.prototype.removeOnErrorsChanged=function(c){this.removeHandler("errors_changed",c)};b.prototype._onAttaching=function(){};b.prototype._onAttach=function(){};b.prototype.raiseErrorsChanged=function(c){this._onErrorsChanged(c)};b.prototype.getFieldInfo=function(c){return this._collection.getFieldInfo(c)};b.prototype.getFieldNames=function(){return this._collection.getFieldNames()};b.prototype.getFieldErrors=
function(c){var a=this._collection._getErrors(this.getItem());if(!a)return[];var b=c;c||(c="*");if(!a[c])return[];"*"==c&&(b=null);return[{fieldName:b,errors:a[c]}]};b.prototype.getAllErrors=function(){var c=this._collection._getErrors(this.getItem());if(!c)return[];var a=[];q.forEachProp(c,function(b){var d=null;"*"!==b&&(d=b);a.push({fieldName:d,errors:c[b]})});return a};b.prototype.getErrorString=function(){var c=this._collection._getErrors(this.getItem());if(!c)return"";var a=[];q.forEachProp(c,
function(b){a.push(p.format("{0}: {1}",b,c[b]))});return a.join("|")};b.prototype.submitChanges=function(){var c=q.createDeferred();c.reject();return c.promise()};b.prototype.rejectChanges=function(){};b.prototype.beginEdit=function(){var c=this._collection;if(!this._beginEdit())return!1;c._onEditing(this.getItem(),!0,!1);this.raisePropertyChanged("isEditing");return!0};b.prototype.endEdit=function(){var c=this._collection;if(!this._endEdit())return!1;c._onEditing(this.getItem(),!1,!1);this._notEdited=
!1;this.raisePropertyChanged("isEditing");return!0};b.prototype.cancelEdit=function(){if(!this._isEditing)return!1;var c=this._collection,a=this._isNew,b=this._saveVals;this._vals=this._saveVals;this._saveVals=null;c._removeAllErrors(this.getItem());c.getFieldNames().forEach(function(a){b[a]!==this._vals[a]&&this.raisePropertyChanged(a)},this);a&&this._notEdited&&c.removeItem(this.getItem());this._isEditing=!1;c._onEditing(this.getItem(),!1,!0);this.raisePropertyChanged("isEditing");return!0};b.prototype.deleteItem=
function(){var a=this._collection;if(null===this._key||!a._onItemDeleting(this.getItem()))return!1;a.removeItem(this.getItem());return!0};b.prototype.getIsNew=function(){return this._isNew};b.prototype.getIsDeleted=function(){return this._isDeleted};b.prototype.getKey=function(){return this._key};b.prototype.getCollection=function(){return this._collection};b.prototype.getIsEditing=function(){return this._isEditing};b.prototype.getIsHasErrors=function(){return!!this._collection._getErrors(this.getItem())};
b.prototype.getIErrorNotification=function(){return this};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._fkey&&this._collection&&!this._collection.getIsClearing()&&this._collection.removeItem(this.getItem()),this._saveVals=this._fkey=null,this._vals={},this._isEditing=!1,d.prototype.destroy.call(this))};b.prototype.toString=function(){return"ItemAspect"};b.prototype.getItem=function(){throw Error("Not implemented");};Object.defineProperty(b.prototype,"_isCanSubmit",
{get:function(){return!1},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"_changeType",{get:function(){return 0},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"_isNew",{get:function(){return!1},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"_isDeleted",{get:function(){return!1},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"_key",{get:function(){return this._fkey},set:function(a){null!==a&&(a=""+a);this._fkey=a},enumerable:!0,
configurable:!0});Object.defineProperty(b.prototype,"_collection",{get:function(){return null},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"_isUpdating",{get:function(){var a=this._collection;return a?a.isUpdating:!1},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isEditing",{get:function(){return this._isEditing},enumerable:!0,configurable:!0});return b}(a.BaseObject);d.ItemAspect=f;var e=function(d){function b(){d.call(this);this._options={enablePaging:!1,
pageSize:50};this._isUpdating=this._isClearing=this._isLoading=!1;this._EditingItem=null;this._perms={canAddRow:!0,canEditRow:!0,canDeleteRow:!0,canRefreshRow:!1};this._pageIndex=this._totalCount=0;this._items=[];this._itemsByKey={};this._currentPos=-1;this._newKey=0;this._fieldMap={};this._fieldInfos=[];this._errors={};this._ignoreChangeErrors=!1;this._pkInfo=null;this._waitQueue=new k.WaitQueue(this)}__extends(b,d);b.getEmptyFieldInfo=function(a){return{fieldName:a,isPrimaryKey:0,dataType:0,isNullable:!0,
maxLength:-1,isReadOnly:!1,isAutoGenerated:!1,allowClientDefault:!1,dateConversion:0,fieldType:1,isNeedOriginal:!1,range:null,regex:null,nested:null,dependentOn:null,fullName:null}};b.prototype._getEventNames=function(){var a=d.prototype._getEventNames.call(this);return"begin_edit end_edit fill coll_changed item_deleting item_adding item_added validate current_changing page_changing errors_changed status_changed clearing cleared commit_changes".split(" ").concat(a)};b.prototype.handleError=function(c,
b){var e=d.prototype.handleError.call(this,c,b);return e?e:a.global.handleError(c,b)};b.prototype.addOnClearing=function(a,b){this.addHandler("clearing",a,b)};b.prototype.removeOnClearing=function(a){this.removeHandler("clearing",a)};b.prototype.addOnCleared=function(a,b){this.addHandler("cleared",a,b)};b.prototype.removeOnCleared=function(a){this.removeHandler("cleared",a)};b.prototype.addOnFill=function(a,b){this.addHandler("fill",a,b)};b.prototype.removeOnFill=function(a){this.removeHandler("fill",
a)};b.prototype.addOnCollChanged=function(a,b){this.addHandler("coll_changed",a,b)};b.prototype.removeOnCollChanged=function(a){this.removeHandler("coll_changed",a)};b.prototype.addOnValidate=function(a,b){this.addHandler("validate",a,b)};b.prototype.removeOnValidate=function(a){this.removeHandler("validate",a)};b.prototype.addOnItemDeleting=function(a,b){this.addHandler("item_deleting",a,b)};b.prototype.removeOnItemDeleting=function(a){this.removeHandler("item_deleting",a)};b.prototype.addOnItemAdding=
function(a,b){this.addHandler("item_adding",a,b)};b.prototype.removeOnItemAdding=function(a){this.removeHandler("item_adding",a)};b.prototype.addOnItemAdded=function(a,b){this.addHandler("item_added",a,b)};b.prototype.removeOnItemAdded=function(a){this.removeHandler("item_added",a)};b.prototype.addOnCurrentChanging=function(a,b){this.addHandler("current_changing",a,b)};b.prototype.removeOnCurrentChanging=function(a){this.removeHandler("current_changing",a)};b.prototype.addOnPageChanging=function(a,
b){this.addHandler("page_changing",a,b)};b.prototype.removeOnPageChanging=function(a){this.removeHandler("page_changing",a)};b.prototype.addOnErrorsChanged=function(a,b){this.addHandler("errors_changed",a,b)};b.prototype.removeOnErrorsChanged=function(a){this.removeHandler("errors_changed",a)};b.prototype.addOnBeginEdit=function(a,b){this.addHandler("begin_edit",a,b)};b.prototype.removeOnBeginEdit=function(a){this.removeHandler("begin_edit",a)};b.prototype.addOnEndEdit=function(a,b){this.addHandler("end_edit",
a,b)};b.prototype.removeOnEndEdit=function(a){this.removeHandler("end_edit",a)};b.prototype.addOnCommitChanges=function(a,b){this.addHandler("commit_changes",a,b)};b.prototype.removeOnCommitChanges=function(a){this.removeHandler("commit_changes",a)};b.prototype.addOnStatusChanged=function(a,b){this.addHandler("status_changed",a,b)};b.prototype.removeOnStatusChanged=function(a){this.removeHandler("status_changed",a)};b.prototype._getPKFieldInfos=function(){if(this._pkInfo)return this._pkInfo;var a=
this._fieldMap,b=[];q.forEachProp(a,function(d){0<a[d].isPrimaryKey&&b.push(a[d])});b.sort(function(a,c){return a.isPrimaryKey-c.isPrimaryKey});return this._pkInfo=b};b.prototype._onCurrentChanging=function(c){try{this.endEdit()}catch(b){a.global.reThrow(b,this.handleError(b,this))}this.raiseEvent("current_changing",{newCurrent:c})};b.prototype._onCurrentChanged=function(){this.raisePropertyChanged("currentItem")};b.prototype._onItemStatusChanged=function(a,b){this.raiseEvent("status_changed",{item:a,
oldChangeType:b,key:a._aspect._key})};b.prototype._onFillStart=function(a){this.raiseEvent("fill",a)};b.prototype._onFillEnd=function(a){this.raiseEvent("fill",a)};b.prototype._onItemsChanged=function(a){this.raiseEvent("coll_changed",a)};b.prototype._onItemAdding=function(c){c={item:c,isCancel:!1};this.raiseEvent("item_adding",c);c.isCancel&&a.global._throwDummy(Error("operation canceled"))};b.prototype._onItemAdded=function(a){this.raiseEvent("item_added",{item:a,isAddNewHandled:!1})};b.prototype._createNew=
function(){throw Error("_createNew Not implemented");};b.prototype._attach=function(c,b){if(this._itemsByKey[c._aspect._key])throw Error(a.ERRS.ERR_ITEM_IS_ATTACHED);try{this.endEdit()}catch(d){a.global.reThrow(d,this.handleError(d,this))}var e;c._aspect._onAttaching();q.check.isNt(b)?(e=this._items.length,this._items.push(c)):(e=b,q.insertIntoArray(this._items,c,e));this._itemsByKey[c._aspect._key]=c;this._onItemsChanged({change_type:1,items:[c],pos:[e]});c._aspect._onAttach();this.raisePropertyChanged("count");
this._onCurrentChanging(c);this._currentPos=e;this._onCurrentChanged();return e};b.prototype._onRemoved=function(a,b){try{this._onItemsChanged({change_type:0,items:[a],pos:[b]})}finally{this.raisePropertyChanged("count")}};b.prototype._onPageSizeChanged=function(){};b.prototype._onPageChanging=function(){var c={page:this.pageIndex,isCancel:!1};this._raiseEvent("page_changing",c);if(!c.isCancel)try{this.endEdit()}catch(b){a.global.reThrow(b,this.handleError(b,this))}return!c.isCancel};b.prototype._onPageChanged=
function(){};b.prototype._setCurrentItem=function(c){var b=this._currentPos;if(c){if(!c._aspect._key)throw Error(a.ERRS.ERR_ITEM_IS_DETACHED);var d,e;if(!this.getItemByKey(c._aspect._key))throw Error(a.ERRS.ERR_ITEM_IS_NOTFOUND);d=this.getItemByPos(b);e=this._items.indexOf(c);if(0>e)throw Error(a.ERRS.ERR_ITEM_IS_NOTFOUND);if(b!==e||d!==c)this._onCurrentChanging(c),this._currentPos=e,this._onCurrentChanged()}else-1!==b&&(this._onCurrentChanging(null),this._currentPos=-1,this._onCurrentChanged())};
b.prototype._destroyItems=function(){this._items.forEach(function(a){a._aspect.destroy()})};b.prototype._isHasProp=function(c){return p.startsWith(c,"[")?(c=a.global.parser.resolveProp(this,c),!p.isUndefined(c)):d.prototype._isHasProp.call(this,c)};b.prototype._getEditingItem=function(){return this._EditingItem};b.prototype._getStrValue=function(a,b){var d=b.dateConversion,e=q.get_timeZoneOffset();return h.stringifyValue(a,d,b.dataType,e)};b.prototype._onEditing=function(a,b,d){this._isUpdating||
(b?(this._EditingItem=a,this.raiseEvent("begin_edit",{item:a})):(this._EditingItem=null,this.raiseEvent("end_edit",{item:a,isCanceled:d})))};b.prototype._onCommitChanges=function(a,b,d,e){this.raiseEvent("commit_changes",{item:a,isBegin:b,isRejected:d,changeType:e})};b.prototype._validateItem=function(a){a={item:a,fieldName:null,errors:[]};this.raiseEvent("validate",a);return a.errors&&0<a.errors.length?{fieldName:null,errors:a.errors}:null};b.prototype._validateItemField=function(a,b){var d={item:a,
fieldName:b,errors:[]};this.raiseEvent("validate",d);return d.errors&&0<d.errors.length?{fieldName:b,errors:d.errors}:null};b.prototype._addErrors=function(a,b){var d=this;this._ignoreChangeErrors=!0;try{b.forEach(function(b){d._addError(a,b.fieldName,b.errors)})}finally{this._ignoreChangeErrors=!1}this._onErrorsChanged(a)};b.prototype._addError=function(a,b,d){b||(b="*");q.check.isArray(d)&&0<d.length?(this._errors[a._aspect._key]||(this._errors[a._aspect._key]={}),this._errors[a._aspect._key][b]=
d,this._ignoreChangeErrors||this._onErrorsChanged(a)):this._removeError(a,b)};b.prototype._removeError=function(a,b){var d=this._errors[a._aspect._key];d&&(b||(b="*"),d[b]&&(delete d[b],0===q.getProps(d).length&&delete this._errors[a._aspect._key],this._onErrorsChanged(a)))};b.prototype._removeAllErrors=function(a){this._errors[a._aspect._key]&&(delete this._errors[a._aspect._key],this._onErrorsChanged(a))};b.prototype._getErrors=function(a){return this._errors[a._aspect._key]};b.prototype._onErrorsChanged=
function(a){this.raiseEvent("errors_changed",{item:a});a._aspect.raiseErrorsChanged({})};b.prototype._onItemDeleting=function(a){a={item:a,isCancel:!1};this.raiseEvent("item_deleting",a);return!a.isCancel};b.prototype.getFieldInfo=function(c){var b=c.split("."),d=this._fieldMap[b[0]];if(1==b.length)return d;if(5==d.fieldType){for(c=1;c<b.length;c+=1)d=m(b[c],d.nested);return d}throw Error(p.format(a.ERRS.ERR_PARAM_INVALID,"fieldName",c));};b.prototype.getFieldNames=function(){return this.getFieldInfos().map(function(a){return a.fieldName})};
b.prototype.getIsClearing=function(){return this._isClearing};b.prototype.getFieldInfos=function(){return this._fieldInfos};b.prototype.cancelEdit=function(){this.isEditing&&this._EditingItem._aspect.cancelEdit()};b.prototype.endEdit=function(){var a;this.isEditing&&(a=this._EditingItem,!a.endEdit()&&a.getIsHasErrors()&&(this.handleError(new g(a.getAllErrors(),a),a),this.cancelEdit()))};b.prototype.getItemsWithErrors=function(){var a=this,b=[];q.forEachProp(this._errors,function(d){d=a.getItemByKey(d);
b.push(d)});return b};b.prototype.addNew=function(){var c,b;c=this._createNew();this._onItemAdding(c);this._attach(c,null);try{this.currentItem=c,c._aspect.beginEdit(),this._onItemAdded(c)}catch(d){b=this.handleError(d,this),c._aspect.cancelEdit(),a.global.reThrow(d,b)}return c};b.prototype.getItemByPos=function(a){return 0>a||a>=this._items.length?null:this._items[a]};b.prototype.getItemByKey=function(c){if(!c)throw Error(a.ERRS.ERR_KEY_IS_EMPTY);return this._itemsByKey[""+c]};b.prototype.findByPK=
function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];if(0===arguments.length)return null;var b=this._getPKFieldInfos(),d=[],e=[],e=1===a.length&&q.check.isArray(a[0])?a[0]:a;if(e.length!==b.length)return null;for(var a=0,l=b.length;a<l;a+=1)d.push(this._getStrValue(e[a],b[a]));b=d.join(";");return this.getItemByKey(b)};b.prototype.moveFirst=function(a){if(0===this._currentPos)return!1;var b=this.getItemByPos(0);if(!b)return!1;if(a&&b._aspect._isDeleted)return this.moveNext(!0);this._onCurrentChanging(b);
this._currentPos=0;this._onCurrentChanged();return!0};b.prototype.movePrev=function(a){var b=-1,d=this._currentPos,e=this.getItemByPos(d);e&&(b=d,--b);e=this.getItemByPos(b);if(!e)return!1;if(a&&e._aspect._isDeleted)return this._currentPos=b,this.movePrev(!0);this._onCurrentChanging(e);this._currentPos=b;this._onCurrentChanged();return!0};b.prototype.moveNext=function(a){var b=-1,d=this._currentPos,e=this.getItemByPos(d);e&&(b=d+1);e=this.getItemByPos(b);if(!e)return!1;if(a&&e._aspect._isDeleted)return this._currentPos=
b,this.moveNext(!0);this._onCurrentChanging(e);this._currentPos=b;this._onCurrentChanged();return!0};b.prototype.moveLast=function(a){var b=this._items.length-1;if(this._currentPos===b)return!1;var d=this.getItemByPos(b);if(!d)return!1;if(a&&d._aspect._isDeleted)return this.movePrev(!0);this._onCurrentChanging(d);this._currentPos=b;this._onCurrentChanged();return!0};b.prototype.goTo=function(a){if(this._currentPos===a)return!1;var b=this.getItemByPos(a);if(!b)return!1;this._onCurrentChanging(b);this._currentPos=
a;this._onCurrentChanged();return!0};b.prototype.forEach=function(a,b){this._items.forEach(a,b)};b.prototype.removeItem=function(c){if(null===c._aspect._key)throw Error(a.ERRS.ERR_ITEM_IS_DETACHED);if(this._itemsByKey[c._aspect._key]){var b=q.removeFromArray(this._items,c);if(0>b)throw Error(a.ERRS.ERR_ITEM_IS_NOTFOUND);delete this._itemsByKey[c._aspect._key];delete this._errors[c._aspect._key];this._onRemoved(c,b);c._aspect._key=null;c._aspect.removeNSHandlers(null);c=this.getItemByPos(b);var d=
this._currentPos;d===b&&(c||(this._currentPos=d-1),this._onCurrentChanged());d>b&&(this._currentPos=d-1,this._onCurrentChanged())}};b.prototype.getIsHasErrors=function(){return this._errors?0<q.getProps(this._errors).length:!1};b.prototype.sort=function(a,b){return this.sortLocal(a,b)};b.prototype.sortLocal=function(a,b){var d=1;1===b&&(d=-1);return this.sortLocalByFunc(function(b,e){var l=0,f,g,h;f=0;for(g=a.length;f<g&&(h=a[f],l=b[h],h=e[h],l=l<h?-1*d:l>h?d:0,0===l);f+=1);return l})};b.prototype.sortLocalByFunc=
function(a){var b=this,d=q.createDeferred();this.waitForNotLoading(function(){var e=b.currentItem;b.isLoading=!0;try{b._items.sort(a),b._onItemsChanged({change_type:2,items:[],pos:[]})}finally{b.isLoading=!1,d.resolve()}b.currentItem=null;b.currentItem=e},[],!1,null);return d.promise()};b.prototype.clear=function(){this._isClearing=!0;try{this.raiseEvent("clearing",{}),this.cancelEdit(),this._EditingItem=null,this._newKey=0,this.currentItem=null,this._destroyItems(),this._items=[],this._itemsByKey=
{},this._errors={},this._onItemsChanged({change_type:2,items:[],pos:[]})}finally{this._isClearing=!1}this.raiseEvent("cleared",{});this.raisePropertyChanged("count")};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._waitQueue.destroy(),this._waitQueue=null,this.clear(),this._fieldMap={},this._fieldInfos=[],d.prototype.destroy.call(this))};b.prototype.waitForNotLoading=function(a,b,d,e){this._waitQueue.enQueue({prop:"isLoading",groupName:null,predicate:function(a){return!a},
action:a,actionArgs:b,lastWins:!!e,syncCheck:!!d})};b.prototype.toString=function(){return"Collection"};Object.defineProperty(b.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"currentItem",{get:function(){return this.getItemByPos(this._currentPos)},set:function(a){this._setCurrentItem(a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"count",{get:function(){return this._items.length},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"totalCount",{get:function(){return this._totalCount},set:function(a){a!=this._totalCount&&(this._totalCount=a,this.raisePropertyChanged("totalCount"),this.raisePropertyChanged("pageCount"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"pageSize",{get:function(){return this._options.pageSize},set:function(a){this._options.pageSize!==a&&(this._options.pageSize=a,this.raisePropertyChanged("pageSize"),this._onPageSizeChanged())},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"pageIndex",{get:function(){return this._pageIndex},set:function(a){a===this._pageIndex||!this.isPagingEnabled||0>a||!this._onPageChanging()||(this._pageIndex=a,this._onPageChanged(),this.raisePropertyChanged("pageIndex"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"items",{get:function(){return this._items},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isPagingEnabled",{get:function(){return this._options.enablePaging},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"permissions",{get:function(){return this._perms},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isEditing",{get:function(){return!!this._EditingItem},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isLoading",{get:function(){return this._isLoading},set:function(a){this._isLoading!==a&&(this._isLoading=a,this.raisePropertyChanged("isLoading"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"isUpdating",{get:function(){return this._isUpdating},set:function(a){this._isUpdating!==a&&(this._isUpdating=a,this.raisePropertyChanged("isUpdating"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"pageCount",{get:function(){var a=this.totalCount,b=this.pageSize;return 0===a||0===b?0:a=0===a%b?a/b:Math.floor(a/b)+1},enumerable:!0,configurable:!0});return b}(a.BaseObject);d.BaseCollection=e;f=function(a){function b(c,d){a.call(this);this.__coll=c;this.__isNew=d?!1:!0;this._item=
null;this._vals=d?d:b._initVals(c,d)}__extends(b,a);b._initVals=function(a,b){var d=b||{};b&&a.getFieldInfos().forEach(function(a){5!=a.fieldType?d[a.fieldName]=null:n(a,function(a,c){5==c.fieldType?p.setValue(d,a,{},!1):p.setValue(d,a,null,!1)})});return d};b.prototype._setProp=function(a,b){var d,e=this._collection;if(this._getProp(a)!==b)try{if(p.setValue(this._vals,a,b,!1),this.getItem().raisePropertyChanged(a),e._removeError(this.getItem(),a),d=this._validateField(a))throw new g([d],this);}catch(l){throw d=
l instanceof g?l:new g([{fieldName:a,errors:[l.message]}],this),e._addError(this.getItem(),a,d.errors[0].errors),d;}};b.prototype._getProp=function(a){return p.getValue(this._vals,a)};b.prototype._resetIsNew=function(){this.__isNew=!1};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._item&&(this._item.destroy(),this._item=null),a.prototype.destroy.call(this))};b.prototype.getItem=function(){return this._item};b.prototype.toString=function(){return this._collection.toString()+
"Item"};Object.defineProperty(b.prototype,"vals",{get:function(){return this._vals},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"_isNew",{get:function(){return this.__isNew},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"_collection",{get:function(){return this.__coll},enumerable:!0,configurable:!0});return b}(f);d.ListItemAspect=f;f=function(d){function b(a,b){d.call(this);this._itemType=a;b&&this._updateFieldMap(b)}__extends(b,d);b.prototype._updateFieldMap=
function(c){var b=this;if(!q.check.isArray(c)||0==c.length)throw Error(p.format(a.ERRS.ERR_PARAM_INVALID,"props",c));b._fieldMap={};b._fieldInfos=[];c.forEach(function(a){var c=e.getEmptyFieldInfo(a.name);c.dataType=a.dtype;b._fieldMap[a.name]=c;b._fieldInfos.push(c);n(c,function(a,c){c.dependents=null;c.fullName=a})})};b.prototype._attach=function(c){try{this.endEdit()}catch(b){a.global.reThrow(b,this.handleError(b,this))}return d.prototype._attach.call(this,c)};b.prototype._createNew=function(){var a=
new this._itemType(this,null);a._key=this._getNewKey(null);return a.getItem()};b.prototype._getNewKey=function(a){a="clkey_"+this._newKey;this._newKey+=1;return a};b.prototype.fillItems=function(a,b){var d=this,e=[],l=[],f=[];a||(a=[]);this._onFillStart({isBegin:!0,rowCount:a.length,time:new Date,isPageChanged:!1});try{b&&this.clear(),a.forEach(function(a){a=new d._itemType(d,a);var b=a.getItem();a._key=d._getNewKey(b);var c=d._itemsByKey[a._key];c?f.push(c):(d._items.push(b),d._itemsByKey[a._key]=
b,e.push(b),l.push(d._items.length-1),f.push(b))}),0<e.length&&(this._onItemsChanged({change_type:1,items:e,pos:l}),this.raisePropertyChanged("count"))}finally{this._onFillEnd({isBegin:!1,rowCount:f.length,time:new Date,resetUI:!!b,fetchedItems:f,newItems:e,isPageChanged:!1})}this.moveFirst()};b.prototype.getNewObjects=function(){return this._items.filter(function(a){return a._aspect._isNew})};b.prototype.resetNewObjects=function(){this._items.forEach(function(a){a._aspect._resetIsNew()})};b.prototype.toString=
function(){return"BaseList"};return b}(e);d.BaseList=f;f=function(d){function b(b,e,f){if(!e)throw Error(p.format(a.ERRS.ERR_PARAM_INVALID,"keyName",e));this._keyName=e;d.call(this,b,f);b=this.getFieldInfo(e);if(!b)throw Error(p.format(a.ERRS.ERR_DICTKEY_IS_NOTFOUND,e));b.isPrimaryKey=1}__extends(b,d);b.prototype._getNewKey=function(b){if(!b)return d.prototype._getNewKey.call(this,null);b=b[this._keyName];if(q.check.isNt(b))throw Error(p.format(a.ERRS.ERR_DICTKEY_IS_EMPTY,this.keyName));return""+
b};b.prototype._onItemAdded=function(a){d.prototype._onItemAdded.call(this,a);this.raisePropertyChanged("["+a[this._keyName]+"]")};b.prototype._onRemoved=function(a,b){var e=a[this._keyName];d.prototype._onRemoved.call(this,a,b);this.raisePropertyChanged("["+e+"]")};Object.defineProperty(b.prototype,"keyName",{get:function(){return this._keyName},enumerable:!0,configurable:!0});return b}(f);d.BaseDictionary=f;a.global.onModuleLoaded("collection",d)})(r.collection||(r.collection={}))})(a.MOD||(a.MOD=
{}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){var d;(function(m){var n=a.MOD.consts,k=a.MOD.baseElView,g=a.MOD.mvvm;m.css={templateContainer:"ria-template-container"};var h,p=a.global;p.addOnInitialize(function(a,d){h=a.utils});var q=function(d){function e(a){d.call(this);this._options=a=h.extend(!1,{app:null,templateID:null,dataContext:null,templEvents:null,isDisabled:!1},a);this._lfTime=this._loadedElem=null;this._templElView=void 0;this._busyTimeOut=this._promise=null;this._el=p.document.createElement("div");this._el.className=
m.css.templateContainer;a.templateID&&this._loadTemplate()}__extends(e,d);e.prototype._getBindings=function(){if(!this._lfTime)return[];for(var a=this._lfTime.getObjs(),b=[],c=0,d=a.length;c<d;c+=1)h.check.isBinding(a[c])&&b.push(a[c]);return b};e.prototype._getElViews=function(){if(!this._lfTime)return[];for(var a=this._lfTime.getObjs(),b=[],c=0,d=a.length;c<d;c+=1)h.check.isElView(a[c])&&b.push(a[c]);return b};e.prototype._getTemplateElView=function(){if(!this._lfTime||null===this._templElView)return null;
if(this._templElView)return this._templElView;for(var a=null,b=this._getElViews(),c=0,d=b.length;c<d;c+=1)if(h.check.isTemplateElView(b[c])){a=b[c];break}return this._templElView=a};e.prototype._getTemplateEvents=function(){var a=this._getTemplateElView(),b=this._options.templEvents;return a&&b?[a,b]:a?[a]:b?[b]:[]};e.prototype._loadTemplateElAsync=function(d){var b=this;d=this.app.getTemplateLoader(d);var c=h.createDeferred();d?d().then(function(a){var b=p.document.createElement("div");b.innerHTML=
a;c.resolve(b.firstElementChild)},function(d){c.reject(Error(h.format(a.ERRS.ERR_TEMPLATE_ID_INVALID,b.templateID)))}):c.reject(Error(h.format(a.ERRS.ERR_TEMPLATE_ID_INVALID,b.templateID)));return c};e.prototype._appendIsBusy=function(a){var b=this;this._busyTimeOut=setTimeout(function(){b._busyTimeOut&&!b._isDestroyCalled&&(b._busyTimeOut=null,(new k.BusyElView(b.app,a,{img:n.LOADER_GIF.SMALL,delay:0})).isBusy=!0)},400)};e.prototype._removeIsBusy=function(a){this._busyTimeOut&&(clearTimeout(this._busyTimeOut),
this._busyTimeOut=null);(a=this.app._getElView(a))&&a instanceof k.BusyElView&&a.destroy()};e.prototype._loadTemplate=function(){var a=this.templateID,b;try{this._promise&&(this._promise.reject("cancel"),this._promise=null),this._loadedElem&&this._unloadTemplate(),a&&(b=this._loadTemplateElAsync(a),this._processTemplate(b,"pending"==b.state()))}catch(c){this.handleError(c,this),p._throwDummy(c)}};e.prototype._processTemplate=function(d,b){var c=this,e,f=c.el;c._promise=e=h.createDeferred();d.done(function(a){"pending"==
e.state()&&e.resolve(a)});d.fail(function(a){"pending"==e.state()&&e.reject(a)});b&&(c._appendIsBusy(f),e.done(function(){c._removeIsBusy(f)}),e.fail(function(a){"cancel"==a&&c._removeIsBusy(f)}));e.then(function(a){var b,d,e;if(!c._isDestroyCalled)try{if(c._promise=null,c._loadedElem&&!a)c._unloadTemplate();else{c._loadedElem=a;d=c._getTemplateEvents();e=d.length;for(b=0;b<e;b+=1)d[b].templateLoading(c);f.appendChild(a);c._lfTime=c.app._bindTemplateElements(a);c._updateBindingSource();d=c._getTemplateEvents();
e=d.length;for(b=0;b<e;b+=1)d[b].templateLoaded(c)}}catch(l){c.handleError(l,c),p._throwDummy(l)}},function(b){if(!c._isDestroyCalled&&(c._promise=null,"cancel"!=b)){var d;b&&(b.message?d=b:b.statusText?d=Error(b.statusText):h.check.isString(b)&&(d=Error(b)));d||(d=Error(h.format(a.ERRS.ERR_TEMPLATE_ID_INVALID,c.templateID)));c.handleError(d,c)}})};e.prototype._updateBindingSource=function(){var a,b,c,d=this._getBindings();a=0;for(b=d.length;a<b;a+=1)c=d[a],c.isSourceFixed||(c.source=this.dataContext)};
e.prototype._unloadTemplate=function(){var a,b=this._getTemplateEvents(),c=b.length;try{if(this._el)for(a=0;a<c;a+=1)b[a].templateUnLoading(this)}finally{this._cleanUp()}};e.prototype._cleanUp=function(){this._lfTime&&(this._lfTime.destroy(),this._lfTime=null);this._templElView=null;this._loadedElem&&p.$(this._loadedElem).remove();this._loadedElem=null;this._isDestroyCalled&&this._el&&(p.$(this._el).remove(),this._el=null)};e.prototype.handleError=function(a,b){var c=d.prototype.handleError.call(this,
a,b);return c?c:this.app.handleError(a,b)};e.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._busyTimeOut&&(clearTimeout(this._busyTimeOut),this._busyTimeOut=null),this._promise&&(this._promise.reject("cancel"),this._promise=null),this._unloadTemplate(),this._options={},d.prototype.destroy.call(this))};e.prototype.findElByDataName=function(a){return p.$(this._el).find(["*[",n.DATA_ATTR.DATA_NAME,'="',a,'"]'].join("")).toArray()};e.prototype.findElViewsByDataName=function(a){var b=
this,c=[];this.findElByDataName(a).forEach(function(a){(a=b.app._getElView(a))&&c.push(a)});return c};e.prototype.toString=function(){return"Template"};Object.defineProperty(e.prototype,"loadedElem",{get:function(){return this._loadedElem},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"dataContext",{get:function(){return this._options.dataContext},set:function(a){this.dataContext!==a&&(this._options.dataContext=a,this.raisePropertyChanged("dataContext"),this._updateBindingSource())},
enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"templateID",{get:function(){return this._options.templateID},set:function(a){this.templateID!==a&&(this._options.templateID=a,this._loadTemplate(),this.raisePropertyChanged("templateID"))},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"app",{get:function(){return this._options.app},enumerable:!0,configurable:!0});
return e}(a.BaseObject);m.Template=q;g=function(a){function d(e,b,c){a.call(this,e,b,c)}__extends(d,a);return d}(g.Command);m.TemplateCommand=g;g=function(a){function d(e,b,c){this._template=null;this._isEnabled=!0;a.call(this,e,b,c)}__extends(d,a);d.prototype.templateLoading=function(a){};d.prototype.templateLoaded=function(a){var b=this._commandParam;try{this._template=a,this._commandParam={template:a,isLoaded:!0},this.invokeCommand(),this._commandParam=b,this.raisePropertyChanged("template")}catch(c){this.handleError(c,
this),p._throwDummy(c)}};d.prototype.templateUnLoading=function(a){var b=this._commandParam;try{this._commandParam={template:a,isLoaded:!1},this.invokeCommand()}catch(c){this.handleError(c,this)}finally{this._commandParam=b,this._template=null}this.raisePropertyChanged("template")};d.prototype.toString=function(){return"TemplateElView"};Object.defineProperty(d.prototype,"isEnabled",{get:function(){return this._isEnabled},set:function(a){this._isEnabled!==a&&(this._isEnabled=a,this.raisePropertyChanged("isEnabled"))},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"template",{get:function(){return this._template},enumerable:!0,configurable:!0});return d}(k.CommandElView);m.TemplateElView=g;p.registerType("Template",q);p.registerElView("template",g);p.onModuleLoaded("template",d)})(d=r.template||(r.template={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(d){function m(a,b,c,d){var e={mode:1,converterParam:null,converter:null,targetPath:null,sourcePath:null,target:null,source:null,isSourceFixed:!1},f=b.source,s=b.target;!b.sourcePath&&b.to?e.sourcePath=b.to:b.sourcePath&&(e.sourcePath=b.sourcePath);b.targetPath&&(e.targetPath=b.targetPath);b.converterParam&&(e.converterParam=b.converterParam);b.mode&&(e.mode=g.BINDING_MODE[b.mode]);b.converter&&(p.check.isString(b.converter)?e.converter=a.getConverter(b.converter):
e.converter=b.converter);s?p.check.isString(s)?e.target="this"==s?c:q.resolveBindingSource(a,q.getPathParts(s)):e.target=s:e.target=c;f?(e.isSourceFixed=!0,p.check.isString(f)?e.source="this"==f?c:q.resolveBindingSource(a,q.getPathParts(f)):e.source=f):e.source=d;return e}var n=a.MOD.utils,k=a.MOD.baseElView,g=a.MOD.binding,h=a.MOD.template,p,q;a.global.addOnInitialize(function(a,b){p=a.utils;q=a.parser});d.css={content:"ria-content-field",required:"ria-required-field"};d.parseContentAttr=function(a){var b=
{name:null,templateInfo:null,bindingInfo:null,displayInfo:null,fieldName:null,options:null};a=q.parseOptions(a);if(0===a.length)return b;a=a[0];!a.template&&a.fieldName?(b.bindingInfo={target:null,source:null,targetPath:null,sourcePath:a.fieldName,mode:g.BINDING_MODE[1],converter:null,converterParam:null},b.displayInfo=a.css,b.fieldName=a.fieldName,a.name&&(b.name=a.name),a.options&&(b.options=a.options),void 0!==a.readOnly&&(b.readOnly=p.parseBool(a.readOnly))):a.template&&(b.templateInfo=a.template,
delete a.template);return b};d.getBindingOptions=m;var f=function(b){function c(e,f){b.call(this);f=p.extend(!1,{app:null,parentEl:null,options:null,dataContext:null,isEditing:!1},f);this._el=null;this._app=e;this._parentEl=f.parentEl;this._isEditing=!!f.isEditing;this._dataContext=f.dataContext;this._options=f.contentOptions;this._isReadOnly=!!this._options.readOnly;this._target=this._lfScope=null;a.global.$(this._parentEl).addClass(d.css.content);this._init();this.update()}__extends(c,b);c.prototype._init=
function(){};c.prototype.handleError=function(a,c){var d=b.prototype.handleError.call(this,a,c);return d?d:this._app.handleError(a,c)};c.prototype._updateCss=function(){var b=this._getDisplayInfo(),c=a.global.$(this._parentEl),e=this.getFieldInfo();this._isEditing&&this._canBeEdited()?(b&&(b.editCss&&c.addClass(b.editCss),b.displayCss&&c.removeClass(b.displayCss)),e&&!e.isNullable&&c.addClass(d.css.required)):b&&(b.displayCss&&c.addClass(b.displayCss),b.editCss&&c.removeClass(b.editCss),e&&!e.isNullable&&
c.removeClass(d.css.required))};c.prototype._canBeEdited=function(){if(this._isReadOnly)return!1;var a=this.getFieldInfo();return a?!!p.getEditable(this._dataContext)&&!a.isReadOnly&&2!=a.fieldType:!1};c.prototype._createTargetElement=function(){var b;b=a.global.document;var c={name:null,options:null};this._isEditing&&this._canBeEdited()?(b=b.createElement("input"),b.setAttribute("type","text"),c.options=this._options.options):b=b.createElement("span");this._updateCss();this._el=b;return this._getElementView(this._el,
c)};c.prototype._getBindingOption=function(a,b,c,d){a=m(this.app,a,b,c);this.isEditing&&this._canBeEdited()?a.mode=2:a.mode=1;d&&(a.targetPath=d);return a};c.prototype._getBindings=function(){if(!this._lfScope)return[];for(var a=this._lfScope.getObjs(),b=[],c=0,d=a.length;c<d;c+=1)p.check.isBinding(a[c])&&b.push(a[c]);return b};c.prototype._updateBindingSource=function(){var a,b,c,d=this._getBindings();a=0;for(b=d.length;a<b;a+=1)c=d[a],c.isSourceFixed||(c.source=this._dataContext)};c.prototype._cleanUp=
function(){this._lfScope&&(this._lfScope.destroy(),this._lfScope=null);this._el&&(p.removeNode(this._el),this._el=null);this._target=null};c.prototype.getFieldInfo=function(){return this._options.fieldInfo};c.prototype._getBindingInfo=function(){return this._options.bindingInfo};c.prototype._getDisplayInfo=function(){return this._options.displayInfo};c.prototype._getElementView=function(a,b){var c=this.app._getElView(a);return c?c:this.app._createElementView(a,b)};c.prototype.update=function(){try{this._cleanUp();
var b=this._getBindingInfo();if(b){this._target=this._createTargetElement();this._lfScope=new n.LifeTimeScope;this._target&&this._lfScope.addObj(this._target);var c=this._getBindingOption(b,this._target,this._dataContext,"value");this._parentEl.appendChild(this._el);this._lfScope.addObj(this.app.bind(c))}}catch(d){a.global.reThrow(d,this.handleError(d,this))}};c.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var c=this._getDisplayInfo(),e=a.global.$(this._parentEl);e.removeClass(d.css.content);
e.removeClass(d.css.required);c&&c.displayCss&&e.removeClass(c.displayCss);c&&c.editCss&&e.removeClass(c.editCss);this._cleanUp();this._app=this._options=this._dataContext=this._parentEl=null;b.prototype.destroy.call(this)}};c.prototype.toString=function(){return"BindingContent"};Object.defineProperty(c.prototype,"parentEl",{get:function(){return this._parentEl},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0});
Object.defineProperty(c.prototype,"isEditing",{get:function(){return this._isEditing},set:function(a){this._isEditing!==a&&(this._isEditing=a,this.update())},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"dataContext",{get:function(){return this._dataContext},set:function(a){this._dataContext!==a&&(this._dataContext=a,this._updateBindingSource())},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"app",{get:function(){return this._app},enumerable:!0,configurable:!0});
return c}(a.BaseObject);d.BindingContent=f;var e=function(b){function c(e,f){b.call(this);f=p.extend(!1,{app:null,parentEl:null,options:null,dataContext:null,isEditing:!1},f);this._app=e;this._parentEl=f.parentEl;this._isEditing=f.isEditing;this._dataContext=f.dataContext;this._templateInfo=f.contentOptions.templateInfo;this._template=null;a.global.$(this._parentEl).addClass(d.css.content);this.update()}__extends(c,b);c.prototype.handleError=function(a,c){var d=b.prototype.handleError.call(this,a,
c);return d?d:this._app.handleError(a,c)};c.prototype.templateLoading=function(a){};c.prototype.templateLoaded=function(a){};c.prototype.templateUnLoading=function(a){this._parentEl.removeChild(a.el)};c.prototype._createTemplate=function(){var b=this._templateInfo,c=b.displayID;this._isEditing?b.editID&&(c=b.editID):c||(c=b.editID);if(!c)throw Error(a.ERRS.ERR_TEMPLATE_ID_INVALID);return new h.Template({app:this.app,templateID:c,dataContext:this._dataContext,templEvents:this})};c.prototype.update=
function(){try{this._cleanUp(),this._templateInfo&&(this._template=this._createTemplate(),this._parentEl.appendChild(this._template.el))}catch(b){a.global.reThrow(b,this.handleError(b,this))}};c.prototype._cleanUp=function(){this._template&&(this._template.destroy(),this._template=null)};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,a.global.$(this._parentEl).removeClass(d.css.content),this._cleanUp(),this._app=this._templateInfo=this._dataContext=this._parentEl=null,
b.prototype.destroy.call(this))};c.prototype.toString=function(){return"TemplateContent"};Object.defineProperty(c.prototype,"app",{get:function(){return this._app},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"parentEl",{get:function(){return this._parentEl},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"template",{get:function(){return this._template},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isEditing",{get:function(){return this._isEditing},
set:function(a){this._isEditing!==a&&(this._isEditing=a,this.update())},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"dataContext",{get:function(){return this._dataContext},set:function(a){this._dataContext!==a&&(this._dataContext=a,this._template&&(this._template.dataContext=this._dataContext))},enumerable:!0,configurable:!0});return c}(a.BaseObject);d.TemplateContent=e;var l=function(b){function c(){b.apply(this,arguments)}__extends(c,b);c.prototype._init=function(){this._target=
this._createTargetElement();var a=this._getBindingInfo();a&&(this._updateCss(),this._lfScope=new n.LifeTimeScope,a=this._getBindingOption(a,this._target,this._dataContext,"checked"),a.mode=2,this._lfScope.addObj(this.app.bind(a)))};c.prototype._cleanUp=function(){};c.prototype._createCheckBoxView=function(){var b=a.global.document.createElement("input");b.setAttribute("type","checkbox");return new k.CheckBoxElView(this.app,b,{})};c.prototype._createTargetElement=function(){var a=this._target;a||(a=
this._createCheckBoxView(),this._el=a.el);this._parentEl.appendChild(this._el);return a};c.prototype._updateCss=function(){b.prototype._updateCss.call(this);var a=this._el;this._isEditing&&this._canBeEdited()?a.disabled&&(a.disabled=!1):a.disabled||(a.disabled=!0)};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._lfScope&&(this._lfScope.destroy(),this._lfScope=null),this._target&&(this._target.destroy(),this._target=null),b.prototype.destroy.call(this))};c.prototype.update=
function(){this._cleanUp();this._updateCss()};c.prototype.toString=function(){return"BoolContent"};return c}(f);d.BoolContent=l;var b=function(b){function c(d,e){if("datepicker"!=e.contentOptions.name)throw Error(p.format(a.ERRS.ERR_ASSERTION_FAILED,"contentOptions.name == 'datepicker'"));b.call(this,d,e);this._fn_cleanup=null}__extends(c,b);c.prototype._getBindingOption=function(a,c,d,e){a=b.prototype._getBindingOption.call(this,a,c,d,e);a.converter=this.app.getConverter("dateConverter");return a};
c.prototype._createTargetElement=function(){var b;b=a.global.document;var c={name:null,options:null};this._isEditing&&this._canBeEdited()?(b=b.createElement("input"),b.setAttribute("type","text"),c.options=this._options.options,c.name="datepicker"):b=b.createElement("span");this._updateCss();this._el=b;return this._getElementView(this._el,c)};c.prototype.toString=function(){return"DateContent"};return c}(f);d.DateContent=b;var c=function(b){function c(){b.apply(this,arguments)}__extends(c,b);c.prototype._getBindingOption=
function(c,d,e,f){c=b.prototype._getBindingOption.call(this,c,d,e,f);c.converter=this.app.getConverter("dateTimeConverter");d=this.getFieldInfo();e=a.global.defaults;switch(d.dataType){case 6:c.converterParam=e.dateTimeFormat;break;case 7:c.converterParam=e.dateFormat;break;case 8:c.converterParam=e.timeFormat;break;default:c.converterParam=null}return c};c.prototype.toString=function(){return"DateTimeContent"};return c}(f);d.DateTimeContent=c;var v=function(b){function c(){b.apply(this,arguments)}
__extends(c,b);Object.defineProperty(c.prototype,"_allowedKeys",{get:function(){c.__allowedKeys||(c.__allowedKeys=[0,8,127,37,39,35,36,9,27,13]);return c.__allowedKeys},enumerable:!0,configurable:!0});c.prototype._getBindingOption=function(a,c,d,e){a=b.prototype._getBindingOption.call(this,a,c,d,e);switch(this.getFieldInfo().dataType){case 3:a.converter=this.app.getConverter("integerConverter");break;case 4:a.converter=this.app.getConverter("decimalConverter");break;default:a.converter=this.app.getConverter("floatConverter")}return a};
c.prototype.update=function(){b.prototype.update.call(this);var a=this;a._target instanceof k.TextBoxElView&&a._target.addOnKeyPress(function(b,c){c.isCancel=!a._previewKeyPress(c.keyCode,c.value)})};c.prototype._previewKeyPress=function(b,c){var d=String.fromCharCode(b),e=a.global.defaults;return-1<"~@#$%^&*()+=_".indexOf(d)?!1:-1<this._allowedKeys.indexOf(b)||"-"===d&&0===c.length?!0:d===e.decimalPoint?0===c.length?!1:0>c.indexOf(d):d===e.thousandSep?!0:-1<"1234567890".indexOf(d)};c.prototype.toString=
function(){return"NumberContent"};c.__allowedKeys=null;return c}(f);d.NumberContent=v;var r=function(a){function b(){a.apply(this,arguments)}__extends(b,a);Object.defineProperty(b.prototype,"_allowedKeys",{get:function(){b.__allowedKeys||(b.__allowedKeys=[0,8,127,37,39,35,36,9,27,13]);return b.__allowedKeys},enumerable:!0,configurable:!0});b.prototype.update=function(){a.prototype.update.call(this);var b=this,c=b.getFieldInfo();b._target instanceof k.TextBoxElView&&b._target.addOnKeyPress(function(a,
d){d.isCancel=!b._previewKeyPress(c,d.keyCode,d.value)})};b.prototype._previewKeyPress=function(a,b,c){return-1<this._allowedKeys.indexOf(b)?!0:!(0<a.maxLength&&c.length>=a.maxLength)};b.prototype.toString=function(){return"StringContent"};b.__allowedKeys=null;return b}(f);d.StringContent=r;var B=function(b){function c(d,e){if("multyline"!=e.contentOptions.name)throw Error(p.format(a.ERRS.ERR_ASSERTION_FAILED,"contentOptions.name == 'multyline'"));b.call(this,d,e)}__extends(c,b);Object.defineProperty(c.prototype,
"_allowedKeys",{get:function(){c.__allowedKeys||(c.__allowedKeys=[0,8,127,37,39,35,36,9,27,13]);return c.__allowedKeys},enumerable:!0,configurable:!0});c.prototype._createTargetElement=function(){var b,c={name:null,options:null};this._isEditing&&this._canBeEdited()?(b=a.global.document.createElement("textarea"),c.options=this._options.options,c.name=null):b=a.global.document.createElement("div");this._updateCss();this._el=b;return this._getElementView(this._el,c)};c.prototype.update=function(){b.prototype.update.call(this);
var a=this,c=a.getFieldInfo();a._target instanceof k.TextAreaElView&&a._target.addOnKeyPress(function(b,d){d.isCancel=!a._previewKeyPress(c,d.keyCode,d.value)})};c.prototype._previewKeyPress=function(a,b,c){return-1<this._allowedKeys.indexOf(b)?!0:!(0<a.maxLength&&c.length>=a.maxLength)};c.prototype.toString=function(){return"MultyLineContent"};c.__allowedKeys=null;return c}(f);d.MultyLineContent=B;var z=function(){function d(a,b){this._app=a;this._nextFactory=b}d.prototype.getContentType=function(d){if(d.templateInfo)return e;
if(!d.bindingInfo)throw Error(p.format(a.ERRS.ERR_PARAM_INVALID,"options","bindingInfo"));var g=d.fieldInfo;switch(g.dataType){case 0:g=f;break;case 1:g="multyline"==d.name?B:r;break;case 2:g=l;break;case 3:g=v;break;case 4:case 5:g=v;break;case 6:case 8:g=c;break;case 7:g="datepicker"==d.name?b:c;break;case 9:case 10:g=f;break;default:throw Error(p.format(a.ERRS.ERR_FIELD_DATATYPE,g.dataType));}!g&&this._nextFactory&&(g=this._nextFactory.getContentType(d));if(!g)throw Error(a.ERRS.ERR_BINDING_CONTENT_NOT_FOUND);
return g};d.prototype.createContent=function(a){return new (this.getContentType(a.contentOptions))(this.app,a)};d.prototype.isExternallyCachable=function(a){return!1};Object.defineProperty(d.prototype,"app",{get:function(){return this._app},enumerable:!0,configurable:!0});return d}();d.ContentFactory=z;d.initModule=function(a){a.registerContentFactory(function(b){return new z(a,b)});return d};a.global.onModuleLoaded("baseContent",d)})(r.baseContent||(r.baseContent={}))})(a.MOD||(a.MOD={}))})(RIAPP||
(RIAPP={}));
(function(a){(function(r){(function(d){var m=a.MOD.consts,n=a.MOD.baseElView,k=a.MOD.baseContent;d.css={dataform:"ria-dataform"};var g=a.localizable.VALIDATE,h;a.global.addOnInitialize(function(a,d){h=a.utils});var p=function(g){function f(e){g.call(this);var f=this;e=h.extend(!1,{app:null,el:null},e);this._app=e.app;this._el=e.el;this._$el=a.global.$(this._el);this._objId="frm"+h.getNewID();this._dataContext=null;this._$el.addClass(d.css.dataform);this._isEditing=!1;this._content=[];this._lfTime=
null;this._contentCreated=!1;this._errors=this._parentDataForm=this._supportErrNotify=this._supportEdit=null;if(e=h.getParentDataForm(null,this._el))f._parentDataForm=this._app.getElementView(e),f._parentDataForm.addOnDestroyed(function(a,c){f._isDestroyCalled||f.destroy()},f._objId)}__extends(f,g);Object.defineProperty(f.prototype,"_DATA_CONTENT_SELECTOR",{get:function(){return"*["+m.DATA_ATTR.DATA_CONTENT+"]:not(["+m.DATA_ATTR.DATA_COLUMN+"])"},enumerable:!0,configurable:!0});f.prototype.handleError=
function(a,d){var b=g.prototype.handleError.call(this,a,d);return b?b:this._app.handleError(a,d)};f.prototype._getBindings=function(){if(!this._lfTime)return[];for(var a=this._lfTime.getObjs(),d=[],b=0,c=a.length;b<c;b+=1)h.check.isBinding(a[b])&&d.push(a[b]);return d};f.prototype._getElViews=function(){if(!this._lfTime)return[];for(var a=this._lfTime.getObjs(),d=[],b=0,c=a.length;b<c;b+=1)h.check.isElView(a[b])&&d.push(a[b]);return d};f.prototype._createContent=function(){var d=this._dataContext,
f=this;if(d){var b=a.ArrayHelper.fromList(this._el.querySelectorAll(f._DATA_CONTENT_SELECTOR)),c=this.isEditing,g=["*[",m.DATA_ATTR.DATA_FORM,"]"].join(""),q=a.ArrayHelper.fromList(this._el.querySelectorAll(g));b.forEach(function(b){if(!h.check.isInNestedForm(f._el,q,b)){var g=b.getAttribute(m.DATA_ATTR.DATA_CONTENT),g=k.parseContentAttr(g);if(g.fieldName&&!g.fieldInfo){var p;p=g.fieldName;p=d?d._aspect&&h.check.isFunction(d._aspect.getFieldInfo)?d._aspect.getFieldInfo(p):h.check.isFunction(d.getFieldInfo)?
d.getFieldInfo(p):null:null;g.fieldInfo=p;if(!g.fieldInfo)throw Error(h.format(a.ERRS.ERR_DBSET_INVALID_FIELDNAME,"",g.fieldName));}b=new (f.app._getContentType(g))(f.app,{parentEl:b,contentOptions:g,dataContext:d,isEditing:c});f._content.push(b)}});this._lfTime=f.app._bindElements(this._el,d,!0,this.isInsideTemplate);this._getBindings().forEach(function(a){a.isSourceFixed||(a.source=d)});this._contentCreated=!0}};f.prototype._updateContent=function(){try{var d=this._dataContext,f=this;this._contentCreated?
(this._content.forEach(function(a){a.dataContext=d;a.isEditing=f.isEditing}),this._getBindings().forEach(function(a){a.isSourceFixed||(a.source=d)})):this._createContent()}catch(b){a.global.reThrow(b,this.handleError(b,this))}};f.prototype._onDSErrorsChanged=function(){this._supportErrNotify&&(this.validationErrors=this._supportErrNotify.getAllErrors())};f.prototype._bindDS=function(){var a=this._dataContext,d=this;a&&(a&&(this._supportEdit=h.getEditable(a),this._supportErrNotify=h.getErrorNotification(a)),
a.addOnDestroyed(function(a,c){d.dataContext=null},d._objId),this._supportEdit&&this._supportEdit.addOnPropertyChange("isEditing",function(a,c){d.isEditing=d._supportEdit.isEditing},d._objId),this._supportErrNotify&&this._supportErrNotify.addOnErrorsChanged(function(a,c){d._onDSErrorsChanged()},d._objId))};f.prototype._unbindDS=function(){var a=this._dataContext;this.validationErrors=null;a&&!a.getIsDestroyCalled()&&(a.removeNSHandlers(this._objId),this._supportEdit&&this._supportEdit.removeNSHandlers(this._objId),
this._supportErrNotify&&this._supportErrNotify.removeOnErrorsChanged(this._objId));this._supportErrNotify=this._supportEdit=null};f.prototype._clearContent=function(){this._content.forEach(function(a){a.destroy()});this._content=[];this._lfTime&&(this._lfTime.destroy(),this._lfTime=null);this._contentCreated=!1};f.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;this._clearContent();this._$el.removeClass(d.css.dataform);this._$el=this._el=null;this._unbindDS();var a=this._parentDataForm;
this._parentDataForm=null;a&&!a.getIsDestroyCalled()&&a.removeNSHandlers(this._objId);this._dataContext=null;this._contentCreated=!1;this._app=null;g.prototype.destroy.call(this)}};f.prototype.toString=function(){return"DataForm"};Object.defineProperty(f.prototype,"app",{get:function(){return this._app},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"dataContext",{get:function(){return this._dataContext},
set:function(d){try{if(d!==this._dataContext){if(d&&!h.check.isBaseObj(d))throw Error(a.ERRS.ERR_DATAFRM_DCTX_INVALID);this._unbindDS();this._dataContext=d;this._bindDS();this._updateContent();this.raisePropertyChanged("dataContext");this._dataContext&&(this._supportEdit&&this._isEditing!==this._supportEdit.isEditing&&(this.isEditing=this._supportEdit.isEditing),this._supportErrNotify&&this._onDSErrorsChanged())}}catch(f){a.global.reThrow(f,this.handleError(f,this))}},enumerable:!0,configurable:!0});
Object.defineProperty(f.prototype,"isEditing",{get:function(){return this._isEditing},set:function(d){var f=this._dataContext;if(f){var b=this._isEditing,c;this._supportEdit&&(c=this._supportEdit);if(c||d===b){if(d!==b&&c)try{d?c.beginEdit():c.endEdit()}catch(g){a.global.reThrow(g,this.handleError(g,f))}c&&c.isEditing!==b&&(this._isEditing=c.isEditing,this._updateContent(),this.raisePropertyChanged("isEditing"))}else this._isEditing=d,this._updateContent(),this.raisePropertyChanged("isEditing")}},
enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"validationErrors",{get:function(){return this._errors},set:function(a){a!==this._errors&&(this._errors=a,this.raisePropertyChanged("validationErrors"))},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"isInsideTemplate",{get:function(){return this._isInsideTemplate},set:function(a){this._isInsideTemplate=a},enumerable:!0,configurable:!0});return f}(a.BaseObject);d.DataForm=p;n=function(d){function f(a,f,b){d.call(this,
a,f,b);var c=this;this._options=b;this._form=new p({app:a,el:f});this._form.addOnDestroyed(function(){c._form=null;c.invokePropChanged("form");c.raisePropertyChanged("form")});this._form.addOnPropertyChange("*",function(a,b){switch(b.property){case "validationErrors":c.validationErrors=a.validationErrors;break;case "dataContext":case "isDisabled":c.raisePropertyChanged(b.property)}},this._objId)}__extends(f,d);f.prototype._getErrorTipInfo=function(a){var d=["<b>",g.errorInfo,"</b>","<ul>"];a.forEach(function(a){var c=
a.fieldName,e="";c&&(e=g.errorField+" "+c);a.errors.forEach(function(a){e=e?e+" -> "+a:a});d.push("<li>"+e+"</li>");e=""});d.push("</ul>");return d.join("")};f.prototype._updateErrorUI=function(d,f){if(d){var b=this.$el;if(f&&0<f.length){var c,g=a.global.getImagePath("warning.png");c=a.global.$('<img name="error_info" alt="error_info" class="error-info" />');b.prepend(c);c.get(0).src=g;h.addToolTip(c,this._getErrorTipInfo(f),!0);this._setFieldError(!0)}else b.children('img[name="error_info"]').remove(),
this._setFieldError(!1)}};f.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._form&&!this._form.getIsDestroyCalled()&&this._form.destroy(),this._form=null,d.prototype.destroy.call(this))};f.prototype.toString=function(){return"DataFormElView"};Object.defineProperty(f.prototype,"dataContext",{get:function(){return this._isDestroyCalled?null:this._form.dataContext},set:function(a){this._isDestroyCalled||this.dataContext===a||(this._form.dataContext=a)},enumerable:!0,configurable:!0});
Object.defineProperty(f.prototype,"form",{get:function(){return this._form},enumerable:!0,configurable:!0});return f}(n.BaseElView);d.DataFormElView=n;a.global.registerType("DataFormElView",n);a.global.registerElView(m.ELVIEW_NM.DATAFORM,n);a.global.onModuleLoaded("dataform",d)})(r.dataform||(r.dataform={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(d){var m=a.MOD.baseElView,n=a.MOD.template,k,g=a.global;g.addOnInitialize(function(a,d){k=a.utils});m=function(a){function d(g,f,e){a.call(this,g,f,e);this._animation=this._template=this._templateID=this._prevTemplateID=this._dataContext=null}__extends(d,a);d.prototype.templateLoading=function(a){if(!this._isDestroyCalled){var d=!this._prevTemplateID;this._animation&&(this._animation.isAnimateFirstShow||!this._animation.isAnimateFirstShow&&!d)&&this._animation.beforeShow(a,
d)}};d.prototype.templateLoaded=function(a){if(!this._isDestroyCalled){k.isContained(a.el,this.el)||this.el.appendChild(a.el);var d=!this._prevTemplateID;this._animation&&(this._animation.isAnimateFirstShow||!this._animation.isAnimateFirstShow&&!d)&&this._animation.show(a,d)}};d.prototype.templateUnLoading=function(a){};d.prototype._templateChanging=function(a,d){var e=this;try{if(!d&&this._template){this._animation&&this._template.loadedElem?(this._animation.stop(),this._animation.beforeHide(this._template),
this._animation.hide(this._template).always(function(){e._isDestroyCalled||(e._template.destroy(),e._template=null,e.raisePropertyChanged("template"))})):(e._template.destroy(),e._template=null,e.raisePropertyChanged("template"));return}}catch(l){this.handleError(l,this),g._throwDummy(l)}try{this._template?this._animation&&this._template.loadedElem?(this._animation.stop(),this._animation.beforeHide(this._template),this._animation.hide(this._template).always(function(){e._isDestroyCalled||(e._template.templateID=
d)})):e._template.templateID=d:(this._template=new n.Template({app:this.app,templateID:d,dataContext:this._dataContext,templEvents:this}),e.raisePropertyChanged("template"))}catch(b){this.handleError(b,this),g._throwDummy(b)}};d.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._animation&&(k.check.isBaseObj(this._animation)&&this._animation.destroy(),this._animation=null),this._template&&(this._template.destroy(),this._template=null),this._dataContext=null,a.prototype.destroy.call(this))};
Object.defineProperty(d.prototype,"template",{get:function(){return this._template},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"templateID",{get:function(){return this._templateID},set:function(a){var d=this._templateID;d!==a&&(this._prevTemplateID=this._templateID,this._templateID=a,this._templateChanging(d,a),this.raisePropertyChanged("templateID"))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"dataContext",{get:function(){return this._dataContext},set:function(a){this._dataContext!==
a&&(this._dataContext=a,this._template&&(this._template.dataContext=this._dataContext),this.raisePropertyChanged("dataContext"))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"animation",{get:function(){return this._animation},set:function(a){this._animation!==a&&(this._animation=a,this.raisePropertyChanged("animation"))},enumerable:!0,configurable:!0});return d}(m.BaseElView);d.DynaContentElView=m;g.registerElView("dynacontent",m);g.onModuleLoaded("dynacontent",d)})(r.dynacontent||
(r.dynacontent={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(d){var m=a.MOD.baseElView,n=function(d){function g(){d.call(this);this._dateFormat=null;this._datepickerRegion="";if(!a.global.$.datepicker)throw Error(a.ERRS.ERR_JQUERY_DATEPICKER_NOTFOUND);this.dateFormat="dd.mm.yy"}__extends(g,d);g.prototype.toString=function(){return"Datepicker"};g.prototype.attachTo=function(a,d){d?a.datepicker(d):a.datepicker()};g.prototype.detachFrom=function(d){a.global.utils.destroyJQueryPlugin(d,"datepicker")};g.prototype.parseDate=function(a){return this.datePickerFn.parseDate(this.dateFormat,
a)};g.prototype.formatDate=function(a){return this.datePickerFn.formatDate(this.dateFormat,a)};Object.defineProperty(g.prototype,"dateFormat",{get:function(){return this._dateFormat?this._dateFormat:this.datePickerFn.regional[this._datepickerRegion].dateFormat},set:function(a){this.dateFormat!==a&&(this._dateFormat=a,a=this.datePickerFn.regional[this._datepickerRegion],this._dateFormat&&(a.dateFormat=this._dateFormat,this.datePickerFn.setDefaults(a)),this.raisePropertyChanged("dateFormat"))},enumerable:!0,
configurable:!0});Object.defineProperty(g.prototype,"datepickerRegion",{get:function(){return this._datepickerRegion},set:function(a){a||(a="");var d=this.dateFormat;if(this._datepickerRegion!==a){var g=this.datePickerFn.regional[a];g&&(this._datepickerRegion=a,g.dateFormat=d,this.datePickerFn.setDefaults(g),this.raisePropertyChanged("datepickerRegion"))}},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"datePickerFn",{get:function(){return a.global.$.datepicker},enumerable:!0,configurable:!0});
return g}(a.BaseObject);d.Datepicker=n;m=function(d){function g(){d.apply(this,arguments)}__extends(g,d);g.prototype._init=function(g){d.prototype._init.call(this,g);a.global.defaults.datepicker.attachTo(this.$el,g.datepicker)};g.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,a.global.defaults.datepicker.detachFrom(this.$el),d.prototype.destroy.call(this))};g.prototype.toString=function(){return"DatePickerElView"};return g}(m.TextBoxElView);d.DatePickerElView=m;a.global.registerType("IDatepicker",
new n);a.global.registerElView("datepicker",m);a.global.onModuleLoaded("datepicker",d)})(r.datepicker||(r.datepicker={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(d){var m=function(d){function k(){d.apply(this,arguments)}__extends(k,d);k.prototype._init=function(a){d.prototype._init.call(this,a);this._tabsEventCommand=null;this._tabOpts=a;this._createTabs()};k.prototype._createTabs=function(){var d=this.$el,h=this,p={activate:function(a,f){var e=d.tabs("option","active");h.invokeTabsEvent("select",{index:e,el:d});h.raisePropertyChanged("tabIndex")},load:function(a,f){var e=d.tabs("option","active");h.invokeTabsEvent("load",
{index:e,el:d});h.raisePropertyChanged("tabIndex")}},p=a.global.utils.extend(!1,p,h._tabOpts);d.tabs(p);setTimeout(function(){if(!h._isDestroyCalled){h.invokeTabsEvent("create",{el:d});var a=d.tabs("option","active");h.invokeTabsEvent("select",{index:a,el:d});h.raisePropertyChanged("tabIndex")}},100)};k.prototype._destroyTabs=function(){a.global.utils.destroyJQueryPlugin(this.$el,"tabs")};k.prototype.invokeTabsEvent=function(a,d){var p={eventName:a,args:d};this._tabsEventCommand&&this._tabsEventCommand.execute(this,
p)};k.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._tabsEventCommand=null,this._destroyTabs(),d.prototype.destroy.call(this))};k.prototype.toString=function(){return"TabsElView"};Object.defineProperty(k.prototype,"tabsEventCommand",{get:function(){return this._tabsEventCommand},set:function(a){var d=this._tabsEventCommand;a!==d&&(d&&this._destroyTabs(),(this._tabsEventCommand=a)&&this._createTabs())},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,
"tabIndex",{get:function(){return this.$el.tabs("option","active")},set:function(a){this.$el.tabs("option","active",a)},enumerable:!0,configurable:!0});return k}(r.baseElView.BaseElView);d.TabsElView=m;a.global.registerElView("tabs",m);a.global.onModuleLoaded("tabs",d)})(r.tabs||(r.tabs={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(d){var m=r.collection,n=r.baseElView,k=a.MOD.baseContent,g,h;a.global.addOnInitialize(function(a,b){g=a.utils;h=a.parser});var p=function(d){function b(b){d.call(this);var e=this;b=g.extend(!1,{app:null,el:null,dataSource:null,valuePath:null,textPath:null},b);if(b.dataSource&&!(b.dataSource instanceof m.BaseCollection))throw Error(a.ERRS.ERR_LISTBOX_DATASRC_INVALID);this._$el=a.global.$(b.el);this._options=b;this._objId="lst"+g.getNewID();this._$el.on("change."+
this._objId,function(a){a.stopPropagation();e._isRefreshing||e._onChanged()});this._isRefreshing=this._isDSFilling=!1;this._prevSelected=this._selectedItem=null;this._keyMap={};this._valMap={};this._tempValue=this._savedValue=void 0;b=this._options.dataSource;this._options.dataSource=null;this.dataSource=b}__extends(b,d);b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._unbindDS(),this._$el.off("."+this._objId),this._clear(!0),this._$el=null,this._tempValue=void 0,
this._savedValue=this._prevSelected=this._selectedItem=null,this._options={},d.prototype.destroy.call(this))};b.prototype._onChanged=function(){var a=null,b;0<=this.el.selectedIndex&&(a=this.el.options[this.el.selectedIndex],a=a.value,b=this._keyMap[a]);!b&&this._selectedItem?this.selectedItem=null:b.item!==this._selectedItem&&(this.selectedItem=b.item)};b.prototype._getStringValue=function(a){a=this._getValue(a);return g.check.isNt(a)?"":""+a};b.prototype._getValue=function(a){if(!a)return null;
if(this._options.valuePath)return h.resolvePath(a,this._options.valuePath)};b.prototype._getText=function(b){return b?this._options.textPath?(b=a.global.parser.resolvePath(b,this._options.textPath),g.check.isNt(b)?"":""+b):this._getStringValue(b):""};b.prototype._onDSCollectionChanged=function(a){var b=this,d;switch(a.change_type){case 2:this._isDSFilling||this._refresh();break;case 1:this._isDSFilling||a.items.forEach(function(a){b._addOption(a,a._aspect._isNew)});break;case 0:a.items.forEach(function(a){b._removeOption(a)});
break;case 3:if(d=b._keyMap[a.old_key])delete b._keyMap[a.old_key],b._keyMap[a.new_key]=d,d.op.value=a.new_key}};b.prototype._onDSFill=function(a){a.isBegin?this._isDSFilling=!0:(this._isDSFilling=!1,this._refresh())};b.prototype._onEdit=function(a,b,d){b?this._savedValue=this._getStringValue(a):(b=this._savedValue,this._savedValue=void 0,d||(d=a._aspect._key,(d=this._keyMap[d])?(d.op.text=this._getText(a),a=this._getStringValue(a),b!==a&&(b&&delete this._valMap[b],a&&(this._valMap[a]=d))):b&&delete this._valMap[b]))};
b.prototype._onStatusChanged=function(a,b){3===a._aspect._changeType&&this._removeOption(a)};b.prototype._onCommitChanges=function(a,b,d,e){if(b){if(!d||1!==e)if(d||3!==e)this._savedValue=this._getStringValue(a)}else b=this._savedValue,this._savedValue=void 0,d&&3===e?this._addOption(a,!0):(d=this._getStringValue(a),e=this._keyMap[a._aspect._key],b!==d&&(""!==b&&delete this._valMap[b],e&&""!==d&&(this._valMap[d]=e)),e&&(e.op.text=this._getText(a)))};b.prototype._bindDS=function(){var a=this,b=this.dataSource;
b&&(b.addOnCollChanged(function(d,e){b===d&&a._onDSCollectionChanged(e)},a._objId),b.addOnFill(function(d,e){b===d&&a._onDSFill(e)},a._objId),b.addOnBeginEdit(function(d,e){b===d&&a._onEdit(e.item,!0,void 0)},a._objId),b.addOnEndEdit(function(d,e){b===d&&a._onEdit(e.item,!1,e.isCanceled)},a._objId),b.addOnStatusChanged(function(d,e){b===d&&a._onStatusChanged(e.item,e.oldChangeType)},a._objId),b.addOnCommitChanges(function(d,e){b===d&&a._onCommitChanges(e.item,e.isBegin,e.isRejected,e.changeType)},
a._objId))};b.prototype._unbindDS=function(){var a=this.dataSource;a&&a.removeNSHandlers(this._objId)};b.prototype._addOption=function(b,d){if(this._isDestroyCalled)return null;var e,f="",g,l;b&&(f=b._aspect._key);if(this._keyMap[f])return null;l=this._getText(b);g=this._getStringValue(b);e=a.global.document.createElement("option");e.text=l;e.value=f;l={item:b,op:e};this._keyMap[f]=l;f=this.el;g&&(this._valMap[g]=l);d?2>f.options.length?f.add(e,null):f.add(e,f.options[1]):f.add(e,null);return e};
b.prototype._mapByValue=function(){var a=this;this._valMap={};g.forEachProp(this._keyMap,function(b){b=a._keyMap[b];var d=a._getStringValue(b.item);d&&(a._valMap[d]=b)})};b.prototype._resetText=function(){var a=this;g.forEachProp(this._keyMap,function(b){b=a._keyMap[b];b.op.text=a._getText(b.item)})};b.prototype._removeOption=function(a){if(!this._isDestroyCalled){var b="",d;a&&(b=a._aspect._key,d=this._keyMap[b])&&(this.el.remove(d.op.index),d=this._getStringValue(a),delete this._keyMap[b],d&&delete this._valMap[d],
this._prevSelected===a&&(this._prevSelected=null),this.selectedItem===a&&(this.selectedItem=this._prevSelected))}};b.prototype._clear=function(a){this.el.options.length=0;this._keyMap={};this._valMap={};this._prevSelected=null;a||this._addOption(null,!1);this.selectedItem=null};b.prototype._refresh=function(){var a=this,b=this.dataSource,d=this._selectedItem,e=a._tempValue;this._isRefreshing=!0;try{this.clear(),b&&(b.forEach(function(b){a._addOption(b,!1)}),g.check.isUndefined(e)?a.el.selectedIndex=
a._findItemIndex(d):(d=a.findItemByValue(e),a.selectedItem=d,a._tempValue=d?void 0:e))}finally{a._isRefreshing=!1}a._onChanged()};b.prototype._findItemIndex=function(a){return a?(a=this._keyMap[a._aspect._key])?a.op.index:0:0};b.prototype._setIsEnabled=function(a,b){a.disabled=!b};b.prototype._getIsEnabled=function(a){return!a.disabled};b.prototype.clear=function(){this._clear(!1)};b.prototype.findItemByValue=function(a){return g.check.isNt(a)?null:(a=this._valMap[""+a])?a.item:null};b.prototype.getTextByValue=
function(a){return g.check.isNt(a)?"":(a=this._valMap[""+a])?a.op.text:""};b.prototype.toString=function(){return"ListBox"};Object.defineProperty(b.prototype,"dataSource",{get:function(){return this._options.dataSource},set:function(a){this.dataSource!==a&&(this.dataSource&&(this._tempValue=this.selectedValue,this._unbindDS()),this._options.dataSource=a,this.dataSource&&this._bindDS(),this._refresh(),this.dataSource&&(this._tempValue=void 0),this.raisePropertyChanged("dataSource"),this.raisePropertyChanged("selectedItem"),
this.raisePropertyChanged("selectedValue"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"selectedValue",{get:function(){if(this.dataSource)return this._getValue(this.selectedItem)},set:function(a){if(this.dataSource){if(this.selectedValue!==a){var b=this.findItemByValue(a);this.selectedItem=b;g.check.isUndefined(a)||b?this._tempValue=void 0:this._tempValue=a}}else this._tempValue!==a&&(this._selectedItem=null,this._tempValue=a,this.raisePropertyChanged("selectedItem"),this.raisePropertyChanged("selectedValue"))},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"selectedItem",{get:function(){if(this.dataSource)return this._selectedItem},set:function(a){this._selectedItem!==a&&(this._selectedItem&&(this._prevSelected=this._selectedItem),this._selectedItem=a,this.el.selectedIndex=this._findItemIndex(this._selectedItem),this.raisePropertyChanged("selectedItem"),this.raisePropertyChanged("selectedValue"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"valuePath",{get:function(){return this._options.valuePath},
set:function(a){a!==this.valuePath&&(this._options.valuePath=a,this._mapByValue(),this.raisePropertyChanged("valuePath"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"textPath",{get:function(){return this._options.textPath},set:function(a){a!==this.textPath&&(this._options.textPath=a,this._resetText(),this.raisePropertyChanged("textPath"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isEnabled",{get:function(){return this._getIsEnabled(this.el)},set:function(a){a!==
this.isEnabled&&(this._setIsEnabled(this.el,a),this.raisePropertyChanged("isEnabled"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"el",{get:function(){return this._options.el},enumerable:!0,configurable:!0});return b}(a.BaseObject);d.ListBox=p;var q=function(a){function b(b,d,e){var f=this;f._options=e;var h=g.extend(!1,{app:b,el:d,dataSource:null},this._options);f._listBox=new p(h);f._listBox.addOnDestroyed(function(){f._listBox=null;f.invokePropChanged("listBox");f.raisePropertyChanged("listBox")},
this.uniqueID);f._listBox.addOnPropertyChange("*",function(a,b){f.raisePropertyChanged(b.property)},f.uniqueID);a.call(this,b,d,e)}__extends(b,a);b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._listBox&&!this._listBox.getIsDestroyCalled()&&this._listBox.destroy(),this._listBox=null,a.prototype.destroy.call(this))};b.prototype.toString=function(){return"SelectElView"};Object.defineProperty(b.prototype,"isEnabled",{get:function(){return this._isDestroyCalled?!1:!this.el.disabled},
set:function(a){a=!!a;a!==this.isEnabled&&(this.el.disabled=!a,this.raisePropertyChanged("isEnabled"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"dataSource",{get:function(){return this._isDestroyCalled?void 0:this._listBox.dataSource},set:function(a){this.dataSource!==a&&(this._listBox.dataSource=a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"selectedValue",
{get:function(){return this._isDestroyCalled?void 0:this._listBox.selectedValue},set:function(a){this._isDestroyCalled||this._listBox.selectedValue===a||(this._listBox.selectedValue=a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"selectedItem",{get:function(){return this._isDestroyCalled?void 0:this._listBox.selectedItem},set:function(a){this._isDestroyCalled||(this._listBox.selectedItem=a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"listBox",{get:function(){return this._listBox},
enumerable:!0,configurable:!0});return b}(n.BaseElView);d.SelectElView=q;var f=function(d){function b(b,e){if("lookup"!=e.contentOptions.name)throw Error(g.format(a.ERRS.ERR_ASSERTION_FAILED,"contentOptions.name == 'lookup'"));this._selectView=this._spanView=null;this._isListBoxCachedExternally=!1;this._value=this._listBinding=this._valBinding=null;d.call(this,b,e)}__extends(b,d);b.prototype._init=function(){this._options.initContentFn&&this._options.initContentFn(this)};b.prototype._getEventNames=
function(){var a=d.prototype._getEventNames.call(this);return["object_created","object_needed"].concat(a)};b.prototype.addOnObjectCreated=function(a,b){this.addHandler("object_created",a,b)};b.prototype.removeOnObjectCreated=function(a){this.removeHandler("object_created",a)};b.prototype.addOnObjectNeeded=function(a,b){this.addHandler("object_needed",a,b)};b.prototype.removeOnObjectNeeded=function(a){this.removeHandler("object_needed",a)};b.prototype._getSelectView=function(){if(this._selectView)return this._selectView;
var b=this._options.options,d={objectKey:"selectElView",object:null};this.raiseEvent("object_needed",d);d.object&&(this._isListBoxCachedExternally=!0,this._selectView=d.object);if(this._selectView)return this._selectView;var d=h.resolvePath(this.app,b.dataSource),b={valuePath:b.valuePath,textPath:b.textPath},e=a.global.document.createElement("select");e.setAttribute("size","1");b=this._createSelectElView(e,b);b.dataSource=d;d={objectKey:"selectElView",object:b,isCachedExternally:!1};this.raiseEvent("object_created",
d);this._isListBoxCachedExternally=d.isCachedExternally;return this._selectView=b};b.prototype._createSelectElView=function(a,b){var d;return(d=this.app._getElView(a))?d:d=new q(this.app,a,b)};b.prototype._updateTextValue=function(){this._getSpanView().value=this._getLookupText()};b.prototype._getLookupText=function(){return this._getSelectView().listBox.getTextByValue(this.value)};b.prototype._getSpanView=function(){if(this._spanView)return this._spanView;var b=a.global.document.createElement("span"),
d=this._getDisplayInfo(),b=new n.SpanElView(this.app,b,{});d&&d.displayCss&&b.$el.addClass(d.displayCss);return this._spanView=b};b.prototype.update=function(){this._cleanUp();this._createTargetElement();this._parentEl.appendChild(this._el)};b.prototype._createTargetElement=function(){var a;this._isEditing&&this._canBeEdited()?(a=this._getSelectView(),this._listBinding=this._bindToList(a)):(a=this._getSpanView(),this._valBinding=this._bindToValue());this._el=a.el;this._updateCss();return a};b.prototype._cleanUp=
function(){this._el&&(g.removeNode(this._el),this._el=null);this._listBinding&&(this._listBinding.destroy(),this._listBinding=null);this._valBinding&&(this._valBinding.destroy(),this._valBinding=null);this._selectView&&this._isListBoxCachedExternally&&(this._selectView=null)};b.prototype._updateBindingSource=function(){this._valBinding&&(this._valBinding.source=this._dataContext);this._listBinding&&(this._listBinding.source=this._dataContext)};b.prototype._bindToValue=function(){return this._options.fieldName?
this.app.bind({target:this,source:this._dataContext,targetPath:"value",sourcePath:this._options.fieldName,mode:1,converter:null,converterParam:null,isSourceFixed:!1}):null};b.prototype._bindToList=function(a){return this._options.fieldName?this.app.bind({target:a,source:this._dataContext,targetPath:"selectedValue",sourcePath:this._options.fieldName,mode:2,converter:null,converterParam:null,isSourceFixed:!1}):null};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._cleanUp(),
this._selectView&&!this._isListBoxCachedExternally&&this._selectView.destroy(),this._selectView=null,this._spanView&&this._spanView.destroy(),this._spanView=null,d.prototype.destroy.call(this))};b.prototype.toString=function(){return"LookupContent"};Object.defineProperty(b.prototype,"value",{get:function(){return this._value},set:function(a){this._value!==a&&(this._value=a,this._updateTextValue(),this.raisePropertyChanged("value"))},enumerable:!0,configurable:!0});return b}(k.BindingContent);d.LookupContent=
f;var e=function(){function d(a,c){this._app=a;this._nextFactory=c}d.prototype.getContentType=function(b){if("lookup"==b.name)return f;if(this._nextFactory)return this._nextFactory.getContentType(b);throw Error(a.ERRS.ERR_BINDING_CONTENT_NOT_FOUND);};d.prototype.createContent=function(a){return new (this.getContentType(a))(this.app,a)};d.prototype.isExternallyCachable=function(a){return f===a?!0:this._nextFactory.isExternallyCachable(a)};Object.defineProperty(d.prototype,"app",{get:function(){return this._app},
enumerable:!0,configurable:!0});return d}();d.ContentFactory=e;d.initModule=function(a){a.registerContentFactory(function(b){return new e(a,b)});return d};a.global.registerElView("select",q);a.global.onModuleLoaded("listbox",d)})(r.listbox||(r.listbox={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(d){var m=a.MOD.template,n;a.global.addOnInitialize(function(a,d){n=a.utils});(function(a){a[a.Default=0]="Default";a[a.StayOpen=1]="StayOpen"})(d.DIALOG_ACTION||(d.DIALOG_ACTION={}));var k=function(d){function h(a,h){d.call(this);var f=this;h=n.extend(!1,{dataContext:null,templateID:null,width:500,height:350,title:"data edit dialog",submitOnOK:!1,canRefresh:!1,canCancel:!0,fn_OnClose:null,fn_OnOK:null,fn_OnShow:null,fn_OnCancel:null,fn_OnTemplateCreated:null,fn_OnTemplateDestroy:null},
h);this._objId="dlg"+n.getNewID();this._app=a;this._dataContext=h.dataContext;this._templateID=h.templateID;this._submitOnOK=h.submitOnOK;this._canRefresh=h.canRefresh;this._canCancel=h.canCancel;this._fn_OnClose=h.fn_OnClose;this._fn_OnOK=h.fn_OnOK;this._fn_OnShow=h.fn_OnShow;this._fn_OnCancel=h.fn_OnCancel;this._fn_OnTemplateCreated=h.fn_OnTemplateCreated;this._fn_OnTemplateDestroy=h.fn_OnTemplateDestroy;this._currentSelectable=this._result=this._$template=this._template=this._isEditable=null;this._fn_submitOnOK=
function(){var a=n.getSubmittable(f._dataContext);return a&&a._isCanSubmit?a.submitChanges():n.createDeferred().resolve().promise()};this._updateIsEditable();this._options={width:h.width,height:h.height,title:h.title,autoOpen:!1,modal:!0,close:function(a,d){f._onClose()},buttons:f._getButtons()};this._dialogCreated=!1;this._createDialog()}__extends(h,d);h.prototype.handleError=function(a,h){var f=d.prototype.handleError.call(this,a,h);return f?f:this._app.handleError(a,h)};h.prototype.addOnClose=
function(a,d){this.addHandler("close",a,d)};h.prototype.removeOnClose=function(a){this.removeHandler("close",a)};h.prototype.addOnRefresh=function(a,d){this.addHandler("refresh",a,d)};h.prototype.removeOnRefresh=function(a){this.removeHandler("refresh",a)};h.prototype._updateIsEditable=function(){this._isEditable=n.getEditable(this._dataContext)};h.prototype._createDialog=function(){if(!this._dialogCreated)try{this._template=this._createTemplate(),this._$template=a.global.$(this._template.el),a.global.document.body.appendChild(this._template.el),
this._$template.dialog(this._options),this._dialogCreated=!0}catch(d){a.global.reThrow(d,this.handleError(d,this))}};h.prototype._getEventNames=function(){var a=d.prototype._getEventNames.call(this);return["close","refresh"].concat(a)};h.prototype.templateLoading=function(a){};h.prototype.templateLoaded=function(a){this._isDestroyCalled||this._fn_OnTemplateCreated&&this._fn_OnTemplateCreated(a)};h.prototype.templateUnLoading=function(a){this._fn_OnTemplateDestroy&&this._fn_OnTemplateDestroy(a)};h.prototype._createTemplate=
function(){return new m.Template({app:this.app,templateID:this._templateID,dataContext:null,templEvents:this})};h.prototype._destroyTemplate=function(){this._template&&this._template.destroy()};h.prototype._getButtons=function(){var d=this,g=[{id:d._objId+"Refresh",text:a.localizable.TEXT.txtRefresh,"class":"btn btn-info",click:function(){d._onRefresh()}},{id:d._objId+"Ok",text:a.localizable.TEXT.txtOk,"class":"btn btn-info",click:function(){d._onOk()}},{id:d._objId+"Cancel",text:a.localizable.TEXT.txtCancel,
"class":"btn btn-info",click:function(){d._onCancel()}}];this.canRefresh||g.shift();this.canCancel||g.pop();return g};h.prototype._getOkButton=function(){return $("#"+this._objId+"Ok")};h.prototype._getCancelButton=function(){return $("#"+this._objId+"Cancel")};h.prototype._getRefreshButton=function(){return $("#"+this._objId+"Refresh")};h.prototype._getAllButtons=function(){return[this._getOkButton(),this._getCancelButton(),this._getRefreshButton()]};h.prototype._disableButtons=function(a){this._getAllButtons().forEach(function(d){d.prop("disabled",
!!a)})};h.prototype._onOk=function(){var d=this,g;g=0;this._fn_OnOK&&(g=this._fn_OnOK(this));if(1!=g)if(this._dataContext){if(g=this._isEditable?this._isEditable.endEdit():!0)if(this._submitOnOK){this._disableButtons(!0);var f=this.title;this.title=a.localizable.TEXT.txtSubmitting;g=this._fn_submitOnOK();g.always(function(){d._disableButtons(!1);d.title=f});g.done(function(){d._result="ok";d.hide()});g.fail(function(){d._isEditable&&!d._isEditable.beginEdit()&&(d._result="cancel",d.hide())})}else d._result=
"ok",d.hide()}else d.hide()};h.prototype._onCancel=function(){var a=0;this._fn_OnCancel&&(a=this._fn_OnCancel(this));1!=a&&(this._isEditable&&this._isEditable.cancelEdit(),this._result="cancel",this.hide())};h.prototype._onRefresh=function(){var a={isHandled:!1};this.raiseEvent("refresh",a);a.isHandled||(a=this._dataContext)&&(n.check.isFunction(a.refresh)?a.refresh():a._aspect&&n.check.isFunction(a._aspect.refresh)&&a._aspect.refresh())};h.prototype._onClose=function(){try{if("ok"!=this._result&&
this._dataContext&&(this._isEditable&&this._isEditable.cancelEdit(),this._submitOnOK)){var d=n.getSubmittable(this._dataContext);d&&d.rejectChanges()}this._fn_OnClose&&this._fn_OnClose(this);this.raiseEvent("close",{})}finally{this._template.dataContext=null}var g=this._currentSelectable;this._currentSelectable=null;setTimeout(function(){a.global.currentSelectable=g;g=null},50)};h.prototype._onShow=function(){this._currentSelectable=a.global.currentSelectable;this._fn_OnShow&&this._fn_OnShow(this)};
h.prototype.show=function(){this._result=null;this._$template.dialog("option","buttons",this._getButtons());this._template.dataContext=this._dataContext;this._onShow();this._$template.dialog("open")};h.prototype.hide=function(){this._$template&&this._$template.dialog("close")};h.prototype.getOption=function(a){return this._$template?this._$template.dialog("option",a):void 0};h.prototype.setOption=function(a,d){this._$template.dialog("option",a,d)};h.prototype.destroy=function(){this._isDestroyed||
(this._isDestroyCalled=!0,this.hide(),this._destroyTemplate(),this._template=this._$template=null,this._dialogCreated=!1,this._app=this._isEditable=this._fn_submitOnOK=this._dataContext=null,d.prototype.destroy.call(this))};Object.defineProperty(h.prototype,"app",{get:function(){return this._app},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"dataContext",{get:function(){return this._dataContext},set:function(a){a!==this._dataContext&&(this._dataContext=a,this._updateIsEditable(),
this.raisePropertyChanged("dataContext"))},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"result",{get:function(){return this._result},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"template",{get:function(){return this._template},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"isSubmitOnOK",{get:function(){return this._submitOnOK},set:function(a){this._submitOnOK!==a&&(this._submitOnOK=a,this.raisePropertyChanged("isSubmitOnOK"))},enumerable:!0,
configurable:!0});Object.defineProperty(h.prototype,"width",{get:function(){return this.getOption("width")},set:function(a){var d=this.getOption("width");a!==d&&(this.setOption("width",a),this.raisePropertyChanged("width"))},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"height",{get:function(){return this.getOption("height")},set:function(a){var d=this.getOption("height");a!==d&&(this.setOption("height",a),this.raisePropertyChanged("height"))},enumerable:!0,configurable:!0});
Object.defineProperty(h.prototype,"title",{get:function(){return this.getOption("title")},set:function(a){var d=this.getOption("title");a!==d&&(this.setOption("title",a),this.raisePropertyChanged("title"))},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"canRefresh",{get:function(){return this._canRefresh},set:function(a){a!==this._canRefresh&&(this._canRefresh=a,this.raisePropertyChanged("canRefresh"))},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"canCancel",
{get:function(){return this._canCancel},set:function(a){a!==this._canCancel&&(this._canCancel=a,this.raisePropertyChanged("canCancel"))},enumerable:!0,configurable:!0});return h}(a.BaseObject);d.DataEditDialog=k;a.global.onModuleLoaded("datadialog",d)})(r.datadialog||(r.datadialog={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(d){function m(){q.forEachProp(b,function(a){a=b[a];a.getIsDestroyCalled()||a._columnWidthChecker()})}var n=a.MOD.consts,k=a.MOD.binding,g=a.MOD.baseContent,h=a.MOD.collection,p=a.MOD.template,q,f=a.global;f.addOnInitialize(function(a,b){q=a.utils});d.css={container:"ria-table-container",dataTable:"ria-data-table",columnInfo:"ria-col-info",column:"ria-ex-column",cellDiv:"cell-div",headerDiv:"ria-table-header",wrapDiv:"ria-table-wrap",dataColumn:"data-column",rowCollapsed:"row-collapsed",
rowExpanded:"row-expanded",rowExpander:"row-expander",columnSelected:"selected",rowSelected:"selected",rowActions:"row-actions",rowDetails:"row-details",rowSelector:"row-selector",rowHighlight:"row-highlight",rowDeleted:"row-deleted",rowError:"row-error",nobr:"ria-nobr",colSortable:"sortable",colSortAsc:"sort-asc",colSortDesc:"sort-desc"};(function(a){a[a.OK=0]="OK";a[a.EDIT=1]="EDIT";a[a.CANCEL=2]="CANCEL";a[a.DELETE=3]="DELETE"})(d.ROW_ACTION||(d.ROW_ACTION={}));var e,l=0,b={},c=function(a){function b(){a.apply(this,
arguments)}__extends(b,a);b.prototype._canBeEdited=function(){return!0};b.prototype.toString=function(){return"RowSelectContent"};return b}(g.BoolContent);d.RowSelectContent=c;var v=function(a){function b(c){a.call(this);c=q.extend(!1,{row:null,td:null,column:null},c);this._row=c.row;this._el=c.td;this._column=c.column;this._num=c.num;this._div=f.document.createElement("div");c=f.$(this._div);this._clickTimeOut=null;c.addClass(d.css.cellDiv).attr(n.DATA_ATTR.DATA_EVENT_SCOPE,this._column.uniqueID);
c.data("cell",this);this._column.options.width&&(this._el.style.width=this._column.options.width);this._init();this.column.options.rowCellCss&&c.addClass(this.column.options.rowCellCss);this._el.appendChild(this._div);this._row.el.appendChild(this._el)}__extends(b,a);b.prototype._init=function(){};b.prototype._onCellClicked=function(a){this.grid.currentRow=a||this._row};b.prototype._onDblClicked=function(a){this.grid.currentRow=a||this._row;this.grid._onCellDblClicked(this)};b.prototype.handleError=
function(b,c){var d=a.prototype.handleError.call(this,b,c);return d?d:this.row.handleError(b,c)};b.prototype.click=function(){this._onCellClicked(this._row)};b.prototype.scrollIntoView=function(a){this._div.scrollIntoView(!!a)};b.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;this._clickTimeOut&&(clearTimeout(this._clickTimeOut),this._clickTimeOut=null);var b=f.$(this._div);b.removeData();b.remove();this._column=this._el=this._row=this._div=null;a.prototype.destroy.call(this)}};
b.prototype.toString=function(){return"BaseCell"};Object.defineProperty(b.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"row",{get:function(){return this._row},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"column",{get:function(){return this._column},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"grid",{get:function(){return this._row.grid},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"item",{get:function(){return this._row.item},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"uniqueID",{get:function(){return this._row.uniqueID+"_"+this._num},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"num",{get:function(){return this._num},enumerable:!0,configurable:!0});return b}(a.BaseObject);d.BaseCell=v;var A=function(b){function c(a){this._stateCss=this._content=null;b.call(this,a)}__extends(c,b);c.prototype._init=function(){var b=this.column.options.content;
if(!b.fieldInfo&&b.fieldName&&(b.fieldInfo=this.item._aspect.getFieldInfo(b.fieldName),!b.fieldInfo))throw Error(q.format(a.ERRS.ERR_DBSET_INVALID_FIELDNAME,"",b.fieldName));var c=this.grid.app;b.initContentFn=null;try{var d=c._getContentType(b);c.contentFactory.isExternallyCachable(d)&&(b.initContentFn=this.column._getInitContentFn());this._content=new d(c,{parentEl:this._div,contentOptions:b,dataContext:this.item,isEditing:this.item._aspect.isEditing})}finally{delete b.initContentFn}};c.prototype.click=
function(){var a=this,b=this._row;this._clickTimeOut?(clearTimeout(this._clickTimeOut),this._clickTimeOut=null,this._onDblClicked(b)):this._clickTimeOut=setTimeout(function(){a._clickTimeOut=null;a._onCellClicked(b)},350)};c.prototype._beginEdit=function(){this._content.isEditing||(this._content.isEditing=!0)};c.prototype._endEdit=function(a){this._content.isEditing&&(this._content.isEditing=!1)};c.prototype._setState=function(a){var b;this._stateCss!==a&&(b=f.$(this._div),this._stateCss&&b.removeClass(this._stateCss),
(this._stateCss=a)&&b.addClass(this._stateCss))};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._content&&(this._content.destroy(),this._content=null),b.prototype.destroy.call(this))};c.prototype.toString=function(){return"DataCell"};Object.defineProperty(c.prototype,"column",{get:function(){return this._column},enumerable:!0,configurable:!0});return c}(v);d.DataCell=A;var B=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype._init=function(){var a=
f.$(this.el);a.addClass(d.css.rowCollapsed);a.addClass(d.css.rowExpander)};b.prototype._onCellClicked=function(b){if(b=b||this._row)a.prototype._onCellClicked.call(this,b),b.isExpanded=!b.isExpanded};b.prototype.toggleImage=function(){var a=f.$(this.el);this._row.isExpanded?(a.removeClass(d.css.rowCollapsed),a.addClass(d.css.rowExpanded)):(a.removeClass(d.css.rowExpanded),a.addClass(d.css.rowCollapsed))};b.prototype.toString=function(){return"ExpanderCell"};return b}(v);d.ExpanderCell=B;var z=function(b){function c(a){this._isEditing=
!1;b.call(this,a)}__extends(c,b);c.prototype._init=function(){var a=f.$(this.el),b=f.$(this._div);a.addClass([d.css.rowActions,d.css.cellDiv,d.css.nobr].join(" "));b.on("mouseenter","img",function(a){a.stopPropagation();$(this).css("opacity",.5)});b.on("mouseout","img",function(a){a.stopPropagation();$(this).css("opacity",1)});this._createButtons(!1)};c.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var a=f.$(this._div),c=a.find("img");a.off();c.each(function(a,b){f.$(b).removeData()});
b.prototype.destroy.call(this)}};c.prototype._createButtons=function(b){if(this._el){var c=this,d=f.$,s=f.$(this._div),e={img_ok:"txtOk",img_cancel:"txtCancel",img_edit:"txtEdit",img_delete:"txtDelete"};s.empty();var x=c._column.options;b?(this._isEditing=!0,b=f.$('<img name="img_ok" alt="ok"/>&nbsp;<img name="img_cancel" alt="cancel"/>')):(this._isEditing=!1,b=d('<img name="img_edit" alt="edit"/>&nbsp;<img name="img_delete" alt="delete"/>'),c.isCanEdit||(b=b.not('img[name="img_edit"]')),c.isCanDelete||
(b=b.not('img[name="img_delete"]')));(function(b){b.each(function(b,d){var s=f.$(d);d.style.cursor="pointer";d.src=x[d.name];s.data("cell",c);q.addToolTip(s,a.localizable.TEXT[e[d.name]]);s.attr(n.DATA_ATTR.DATA_EVENT_SCOPE,c._column.uniqueID)})})(b.filter("img"));s.append(b)}};c.prototype.update=function(){this._row&&this._isEditing!=this._row.isEditing&&this._createButtons(this._row.isEditing)};c.prototype.toString=function(){return"ActionsCell"};Object.defineProperty(c.prototype,"isCanEdit",{get:function(){return this.grid.isCanEdit},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isCanDelete",{get:function(){return this.grid.isCanDelete},enumerable:!0,configurable:!0});return c}(v);d.ActionsCell=z;var C=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype._init=function(){f.$(this.el).addClass(d.css.rowSelector);this._content=new c(this.grid.app,{parentEl:this._div,contentOptions:{fieldName:"isSelected",bindingInfo:{target:null,source:null,targetPath:null,sourcePath:"isSelected",mode:k.BINDING_MODE[2],
converter:null,converterParam:null},displayInfo:null},dataContext:this.row,isEditing:!0})};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._content&&(this._content.destroy(),this._content=null),a.prototype.destroy.call(this))};b.prototype.toString=function(){return"RowSelectorCell"};return b}(v);d.RowSelectorCell=C;var w=function(a){function b(c){a.call(this);this._row=c.row;this._el=c.td;this._init(c)}__extends(b,a);b.prototype._init=function(a){if(a=a.details_id)this._el.colSpan=
this.grid.columns.length,this._row.el.appendChild(this._el),this._template=new p.Template({app:this.grid.app,templateID:a,templEvents:this}),this._el.appendChild(this._template.el)};b.prototype.templateLoading=function(a){};b.prototype.templateLoaded=function(a){};b.prototype.templateUnLoading=function(a){this._el.removeChild(a.el);this._template=null};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._template&&(this._template.destroy(),this._template=null),this._el=
this._row=null,a.prototype.destroy.call(this))};b.prototype.toString=function(){return"DetailsCell"};Object.defineProperty(b.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"row",{get:function(){return this._row},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"grid",{get:function(){return this._row.grid},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"item",{get:function(){return this._template.dataContext},
set:function(a){this._template.dataContext=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"template",{get:function(){return this._template},enumerable:!0,configurable:!0});return b}(a.BaseObject);d.DetailsCell=w;var y=function(a){function b(c,d){var s=this;a.call(this);this._grid=c;this._el=d.tr;this._item=d.item;this._cells=null;this._objId="r"+q.getNewID();this._rowSelectorCell=this._actionsCell=this._expanderCell=null;this._isSelected=this._isDeleted=this._isCurrent=!1;this._createCells();
this.isDeleted=this._item._aspect._isDeleted;var e=function(){var a=s._grid._onRowStateChanged(s,s._item[s._grid.options.rowStateField]);s._setState(a)};this.isHasStateField&&(this._item.addOnPropertyChange(this._grid.options.rowStateField,function(a,b){e()},this._objId),e())}__extends(b,a);b.prototype.handleError=function(b,c){var d=a.prototype.handleError.call(this,b,c);return d?d:this.grid.handleError(b,c)};b.prototype._createCells=function(){var a=this,b=0;a._cells=Array(this.columns.length);
this.columns.forEach(function(c){a._cells[b]=a._createCell(c,b);b+=1})};b.prototype._createCell=function(a,b){var c=f.document.createElement("td");c=a instanceof s?this._expanderCell=new B({row:this,td:c,column:a,num:b}):a instanceof F?this._actionsCell=new z({row:this,td:c,column:a,num:b}):a instanceof x?this._rowSelectorCell=new C({row:this,td:c,column:a,num:b}):new A({row:this,td:c,column:a,num:b});return c};b.prototype._setState=function(a){for(var b=0,c=this._cells.length;b<c;b++){var d=this._cells[b];
d instanceof A&&d._setState(a)}};b.prototype._onBeginEdit=function(){this._cells.forEach(function(a){a instanceof A&&a._beginEdit()});this._actionsCell&&this._actionsCell.update()};b.prototype._onEndEdit=function(a){this._cells.forEach(function(b){b instanceof A&&b._endEdit(a)});this._actionsCell&&this._actionsCell.update()};b.prototype.beginEdit=function(){return this._item._aspect.beginEdit()};b.prototype.endEdit=function(){return this._item._aspect.endEdit()};b.prototype.cancelEdit=function(){return this._item._aspect.cancelEdit()};
b.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var b=this._grid;b&&(this.isExpanded&&b.collapseDetails(),this._cells.forEach(function(a){a.destroy()}),this._cells=null,b._isClearing||(b._removeRow(this),this._el&&f.$(this._el).remove()));this._item&&this._item.removeNSHandlers(this._objId);this._grid=this._el=this._expanderCell=this._item=null;a.prototype.destroy.call(this)}};b.prototype.deleteRow=function(){this._item._aspect.deleteItem()};b.prototype.updateErrorState=
function(){var a=this._item._aspect.getIsHasErrors(),b=f.$(this._el);a?b.addClass(d.css.rowError):b.removeClass(d.css.rowError)};b.prototype.scrollIntoView=function(a){this._cells&&0<this._cells.length&&this._cells[0].scrollIntoView(a)};b.prototype.toString=function(){return"Row"};Object.defineProperty(b.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"grid",{get:function(){return this._grid},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"item",{get:function(){return this._item},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"cells",{get:function(){return this._cells},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"columns",{get:function(){return this._grid.columns},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"itemKey",{get:function(){return this._item?this._item._aspect._key:
null},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isCurrent",{get:function(){return this._isCurrent},set:function(a){if(a!==this._isCurrent){var b=f.$(this._el);(this._isCurrent=a)?b.addClass(d.css.rowHighlight):b.removeClass(d.css.rowHighlight);this.raisePropertyChanged("isCurrent")}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isSelected",{get:function(){return this._isSelected},set:function(a){this._isSelected!=a&&(this._isSelected=a,this.raisePropertyChanged("isSelected"),
this.grid._onRowSelectionChanged(this))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isExpanded",{get:function(){return this.grid._isRowExpanded(this)},set:function(a){a!==this.isExpanded&&(!a&&this.isExpanded?this.grid._expandDetails(this,!1):a&&this.grid._expandDetails(this,!0))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"expanderCell",{get:function(){return this._expanderCell},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"actionsCell",
{get:function(){return this._actionsCell},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isDeleted",{get:function(){return this._el?this._isDeleted:!0},set:function(a){this._el&&this._isDeleted!==a&&((this._isDeleted=a)?(this.isExpanded=!1,f.$(this._el).addClass(d.css.rowDeleted)):f.$(this._el).removeClass(d.css.rowDeleted))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isEditing",{get:function(){return!!this._item&&this._item._aspect.isEditing},enumerable:!0,
configurable:!0});Object.defineProperty(b.prototype,"isHasStateField",{get:function(){return!!this._grid.options.rowStateField},enumerable:!0,configurable:!0});return b}(a.BaseObject);d.Row=y;var D=function(a){function b(){a.call(this);this._$el=null}__extends(b,a);b.prototype.beforeShow=function(a){this.stop();this._$el=f.$(a);this._$el.hide()};b.prototype.show=function(a){this._$el.slideDown("fast",a)};b.prototype.beforeHide=function(a){this.stop();this._$el=f.$(a)};b.prototype.hide=function(a){this._$el.slideUp("fast",
a)};b.prototype.stop=function(){this._$el&&(this._$el.finish(),this._$el=null)};b.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;try{this.stop()}finally{a.prototype.destroy.call(this)}}};return b}(a.BaseObject),E=function(a){function b(c){a.call(this);var s=this;this._grid=c.grid;this._el=c.tr;this._parentRow=this._cell=this._item=null;this._isFirstShow=!0;this._objId="drow"+q.getNewID();this._createCell(c.details_id);this._$el=f.$(this._el);this._$el.addClass(d.css.rowDetails);
this._grid.addOnRowExpanded(function(a,b){!b.isExpanded&&b.old_expandedRow&&s._setParentRow(null)},this._objId)}__extends(b,a);b.prototype._createCell=function(a){var b=f.document.createElement("td");this._cell=new w({row:this,td:b,details_id:a})};b.prototype._setParentRow=function(a){var b=this;this._item=null;this._cell.item=null;q.removeNode(this._el);!a||a.getIsDestroyCalled()?this._parentRow=null:(this._parentRow=a,this._item=a.item,this._cell.item=this._item,this._isFirstShow&&this._initShow(),
q.insertAfter(a.el,this._el),this._show(function(){var a=b._parentRow;a&&!a.getIsDestroyCalled()&&b.grid.options.isUseScrollIntoDetails&&a.scrollIntoView(!0)}))};b.prototype._initShow=function(){this._grid.animation.beforeShow(this._cell.template.el)};b.prototype._show=function(a){var b=this._grid.animation;this._isFirstShow=!1;b.beforeShow(this._cell.template.el);b.show(a)};b.prototype._hide=function(a){var b=this._grid.animation;b.beforeHide(this._cell.template.el);b.hide(a)};b.prototype.destroy=
function(){this._isDestroyed||(this._isDestroyCalled=!0,this._grid.removeNSHandlers(this._objId),this._cell&&(this._cell.destroy(),this._cell=null),this._$el.remove(),this._grid=this._el=this._item=this._$el=null,a.prototype.destroy.call(this))};b.prototype.toString=function(){return"DetailsRow"};Object.defineProperty(b.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"$el",{get:function(){return this._$el},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"grid",{get:function(){return this._grid},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"item",{get:function(){return this._item},set:function(a){this._item!==a&&(this._item=a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"itemKey",{get:function(){return this._item?this._item._key:null},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"parentRow",{get:function(){return this._parentRow},set:function(a){var b=this;a!==this._parentRow&&(b._parentRow?b._hide(function(){b._setParentRow(a)}):b._setParentRow(a))},enumerable:!0,configurable:!0});return b}(a.BaseObject);d.DetailsRow=E;v=function(a){function b(c,s){a.call(this);var e=this;this._grid=c;this._el=s.th;this._options=s.colinfo;this._isSelected=!1;
this._objId="col"+q.getNewID();var x=f.document.createElement("div");this._$extcol=f.$(x);this._$extcol.addClass(d.css.column);this._grid._appendToHeader(x);var g=f.document.createElement("div");this._$div=f.$(g);this._$div.addClass(d.css.cellDiv).click(function(a){a.stopPropagation();f.currentSelectable=c;c._setCurrentColumn(e);e._onColumnClicked()});x.appendChild(g);this.grid._$tableEl.on("click",["div[",n.DATA_ATTR.DATA_EVENT_SCOPE,'="',this.uniqueID,'"]'].join(""),function(a){a.stopPropagation();
if(a=f.$(this).data("cell"))f.currentSelectable=c,c._setCurrentColumn(e),a.click()});this._options.width&&(this._el.style.width=this._options.width);this._init();this._options.colCellCss&&e._$div.addClass(this._options.colCellCss)}__extends(b,a);b.prototype._init=function(){this.title&&this._$div.html(this.title)};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._grid._$tableEl.off("click",["div[",n.DATA_ATTR.DATA_EVENT_SCOPE,'="',this.uniqueID,'"]'].join("")),this._$extcol.remove(),
this._grid=this._el=this._$div=this._$extcol=null,a.prototype.destroy.call(this))};b.prototype.scrollIntoView=function(a){this._$div&&this._$div.get(0).scrollIntoView(!!a)};b.prototype._onColumnClicked=function(){};b.prototype.toString=function(){return"BaseColumn"};Object.defineProperty(b.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"el",{get:function(){return this._el},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"$div",{get:function(){return this._$div},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"$extcol",{get:function(){return this._$extcol},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"grid",{get:function(){return this._grid},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"title",{get:function(){return this._options.title},enumerable:!0,
configurable:!0});Object.defineProperty(b.prototype,"isSelected",{get:function(){return this._isSelected},set:function(a){this._isSelected!==a&&((this._isSelected=a)?this._$div.addClass(d.css.columnSelected):this._$div.removeClass(d.css.columnSelected))},enumerable:!0,configurable:!0});return b}(a.BaseObject);d.BaseColumn=v;var u=function(a){function b(c,s){a.call(this,c,s);this._objCache={};this.$div.addClass(d.css.dataColumn)}__extends(b,a);b.prototype._init=function(){a.prototype._init.call(this);
this._sortOrder=null;this.isSortable&&this.$div.addClass(d.css.colSortable)};b.prototype._onColumnClicked=function(){if(this.isSortable&&this.sortMemberName){var a=this._sortOrder;this.grid._resetColumnsSort();this.sortOrder=0==a?1:0;this.grid.sortByColumn(this)}};b.prototype._cacheObject=function(a,b){this._objCache[a]=b};b.prototype._getCachedObject=function(a){return this._objCache[a]};b.prototype._getInitContentFn=function(){var a=this;return function(b){b.addOnObjectCreated(function(b,c){a._cacheObject(c.objectKey,
c.object);c.isCachedExternally=!!a._getCachedObject(c.objectKey)});b.addOnObjectNeeded(function(b,c){c.object=a._getCachedObject(c.objectKey)})}};b.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var b=this;q.forEachProp(b._objCache,function(a){b._objCache[a].destroy()});b._objCache=null;a.prototype.destroy.call(this)}};b.prototype.toString=function(){return"DataColumn"};Object.defineProperty(b.prototype,"isSortable",{get:function(){return!!this.options.sortable},enumerable:!0,
configurable:!0});Object.defineProperty(b.prototype,"sortMemberName",{get:function(){return this.options.sortMemberName},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"sortOrder",{get:function(){return this._sortOrder},set:function(a){this.$div.removeClass([d.css.colSortable,d.css.colSortAsc,d.css.colSortDesc].join(" "));switch(a){case 0:this.$div.addClass(d.css.colSortAsc);break;case 1:this.$div.addClass(d.css.colSortDesc);break;default:this.isSortable&&this.$div.addClass(d.css.colSortable)}this._sortOrder=
a;this.raisePropertyChanged("sortOrder")},enumerable:!0,configurable:!0});return b}(v);d.DataColumn=u;var s=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype._init=function(){a.prototype._init.call(this);this.$div.addClass(d.css.rowExpander)};b.prototype.toString=function(){return"ExpanderColumn"};return b}(v);d.ExpanderColumn=s;var x=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype._init=function(){a.prototype._init.call(this);var b=this;this._val=
!1;this.$div.addClass(d.css.rowSelector);var c=f.$('<input type="checkbox"/>');this.$div.append(c);this._$chk=c;c.click(function(a){a.stopPropagation();b._onCheckBoxClicked(this.checked)});c.on("change",function(a){a.stopPropagation();b.checked=this.checked})};b.prototype._onCheckBoxClicked=function(a){this.grid.selectRows(a)};b.prototype.toString=function(){return"RowSelectorColumn"};Object.defineProperty(b.prototype,"checked",{get:function(){return this._val},set:function(a){var b=this._$chk;null!==
a&&(a=!!a);a!==this._val&&(this._val=a,b&&b.prop("checked",!!this._val),this.raisePropertyChanged("checked"))},enumerable:!0,configurable:!0});b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._$chk.off(),this._$chk.remove(),this._$chk=null,a.prototype.destroy.call(this))};return b}(v);d.RowSelectorColumn=x;var F=function(a){function b(){a.apply(this,arguments)}__extends(b,a);b.prototype._init=function(){a.prototype._init.call(this);var b=this,c=this.options;this.$div.addClass(d.css.rowActions);
c.img_ok=f.getImagePath(c.img_ok||"ok.png");c.img_cancel=f.getImagePath(c.img_cancel||"cancel.png");c.img_edit=f.getImagePath(c.img_edit||"edit.png");c.img_delete=f.getImagePath(c.img_delete||"delete.png");this.grid._$tableEl.on("click","img["+n.DATA_ATTR.DATA_EVENT_SCOPE+'="'+this.uniqueID+'"]',function(a){a.stopPropagation();var c=f.$(this);a=this.name;c=c.data("cell");switch(a){case "img_ok":b._onOk(c);break;case "img_cancel":b._onCancel(c);break;case "img_edit":b._onEdit(c);break;case "img_delete":b._onDelete(c)}});
this.grid.addOnRowAction(function(a,c){switch(c.action){case 0:b._onOk(c.row.actionsCell);break;case 1:b._onEdit(c.row.actionsCell);break;case 2:b._onCancel(c.row.actionsCell);break;case 3:b._onDelete(c.row.actionsCell)}},this.uniqueID)};b.prototype._onOk=function(a){a.row&&(a.row.endEdit(),a.update())};b.prototype._onCancel=function(a){a.row&&(a.row.cancelEdit(),a.update())};b.prototype._onDelete=function(a){a.row&&a.row.deleteRow()};b.prototype._onEdit=function(a){a.row&&(a.row.beginEdit(),a.update(),
this.grid.showEditDialog())};b.prototype.toString=function(){return"ActionsColumn"};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this.grid._$tableEl.off("click","img["+n.DATA_ATTR.DATA_EVENT_SCOPE+'="'+this.uniqueID+'"]'),this.grid.removeNSHandlers(this.uniqueID),a.prototype.destroy.call(this))};return b}(v);d.ActionsColumn=F;var t=function(c){function t(s){c.call(this);s=q.extend(!1,{app:null,el:null,dataSource:null,animation:null,isUseScrollInto:!0,isUseScrollIntoDetails:!0,
containerCss:null,wrapCss:null,headerCss:null,rowStateField:null,isCanEdit:null,isCanDelete:null,isHandleAddNew:!1},s);if(s.dataSource&&!(s.dataSource instanceof h.BaseCollection))throw Error(a.ERRS.ERR_GRID_DATASRC_INVALID);this._options=s;this._columnWidthChecker=function(){};s=f.$(this._options.el);this._tableEl=this._options.el;this._$tableEl=s;s.addClass(d.css.dataTable);this._name=s.attr(n.DATA_ATTR.DATA_NAME);this._objId="grd"+q.getNewID();this._rowMap={};this._rows=[];this._columns=[];this._isDSFilling=
this._isClearing=!1;this._editingRow=this._currentColumn=this._rowSelectorCol=this._actionsCol=this._expanderCol=this._details=this._expandedRow=this._currentRow=null;this._isSorting=!1;this._$contaner=this._$wrapDiv=this._$headerDiv=this._dialog=null;this._wrapTable();this._createColumns();this._bindDS();f._trackSelectable(this);b[this.uniqueID]=this;l+=1;1==l&&(e=setInterval(m,250))}__extends(t,c);t.prototype._getEventNames=function(){var a=c.prototype._getEventNames.call(this);return"row_expanded row_selected page_changed row_state_changed cell_dblclicked row_action".split(" ").concat(a)};
t.prototype.addOnRowExpanded=function(a,b){this.addHandler("row_expanded",a,b)};t.prototype.removeOnRowExpanded=function(a){this.removeHandler("row_expanded",a)};t.prototype.addOnRowSelected=function(a,b){this.addHandler("row_selected",a,b)};t.prototype.removeOnRowSelected=function(a){this.removeHandler("row_selected",a)};t.prototype.addOnPageChanged=function(a,b){this.addHandler("page_changed",a,b)};t.prototype.removeOnPageChanged=function(a){this.removeHandler("page_changed",a)};t.prototype.addOnRowStateChanged=
function(a,b){this.addHandler("row_state_changed",a,b)};t.prototype.removeOnRowStateChanged=function(a){this.removeHandler("row_state_changed",a)};t.prototype.addOnCellDblClicked=function(a,b){this.addHandler("cell_dblclicked",a,b)};t.prototype.removeOnCellDblClicked=function(a){this.removeHandler("cell_dblclicked",a)};t.prototype.addOnRowAction=function(a,b){this.addHandler("row_action",a,b)};t.prototype.removeOnRowAction=function(a){this.removeHandler("row_action",a)};t.prototype._isRowExpanded=
function(a){return this._expandedRow===a};t.prototype._appendToHeader=function(a){this._$headerDiv.append(a)};t.prototype._setCurrentColumn=function(a){this._currentColumn&&(this._currentColumn.isSelected=!1);if(this._currentColumn=a)this._currentColumn.isSelected=!0};t.prototype._onRowStateChanged=function(a,b){var c={row:a,val:b,css:null};this.raiseEvent("row_state_changed",c);return c.css};t.prototype._onCellDblClicked=function(a){this.raiseEvent("cell_dblclicked",{cell:a})};t.prototype._onRowSelectionChanged=
function(a){this.raiseEvent("row_selected",{row:a})};t.prototype._resetColumnsSort=function(){this.columns.forEach(function(a){a instanceof u&&(a.sortOrder=null)})};t.prototype._getLastRow=function(){if(0===this._rows.length)return null;for(var a=this._rows.length-1,b=this._rows[a];b.isDeleted&&0<a;)--a,b=this._rows[a];return b.isDeleted?null:b};t.prototype._removeRow=function(a){this._expandedRow===a&&this.collapseDetails();if(0!==this._rows.length){var b=a.itemKey,c=q.removeFromArray(this._rows,
a);try{-1<c&&(a._isDestroyCalled||a.destroy())}finally{this._rowMap[b]&&delete this._rowMap[b]}}};t.prototype._onKeyDown=function(a,b){var c=this.dataSource;if(c)switch(a){case 38:b.preventDefault();c.movePrev(!0)&&this.isUseScrollInto&&this._scrollToCurrent(!1);break;case 40:b.preventDefault();c.moveNext(!0)&&this.isUseScrollInto&&this._scrollToCurrent(!1);break;case 34:0<c.pageIndex&&--c.pageIndex;break;case 33:c.pageIndex+=1;break;case 13:this._currentRow&&this._actionsCol&&b.preventDefault();
break;case 27:this._currentRow&&this._actionsCol&&this._currentRow.isEditing&&b.preventDefault();break;case 32:this._rowSelectorCol&&this._currentRow&&!this._currentRow.isEditing&&b.preventDefault()}};t.prototype._onKeyUp=function(a,b){if(this.dataSource)switch(a){case 13:this._currentRow&&this._actionsCol&&(this._currentRow.isEditing?this.raiseEvent("row_action",{row:this._currentRow,action:0}):this.raiseEvent("row_action",{row:this._currentRow,action:1}),b.preventDefault());break;case 27:this._currentRow&&
this._actionsCol&&this._currentRow.isEditing&&(this.raiseEvent("row_action",{row:this._currentRow,action:2}),b.preventDefault());break;case 32:this._rowSelectorCol&&this._currentRow&&!this._currentRow.isEditing&&(b.preventDefault(),this._currentRow.isSelected=!this._currentRow.isSelected)}};t.prototype._expandDetails=function(a,b){if(this._options.details){this._details||(this._details=this._createDetails());var c=this._expandedRow;c===a&&c&&b||(this._expandedRow=null,this._details.parentRow=null,
b?(this._expandedRow=a,this._details.parentRow=a,this._expandedRow.expanderCell.toggleImage()):(this._expandedRow=null,this._details.parentRow=null,c&&c.expanderCell.toggleImage()),c!==a&&c&&c.expanderCell.toggleImage(),this.raiseEvent("row_expanded",{old_expandedRow:c,expandedRow:a,isExpanded:b}))}};t.prototype._parseColumnAttr=function(a,b){var c={type:"data",title:null,sortable:!1,sortMemberName:null,content:null},d=f.parser.parseOptions(a),c=0<d.length?q.extend(!1,c,d[0]):c;b&&(c.content=g.parseContentAttr(b),
!c.sortMemberName&&c.content.fieldName&&(c.sortMemberName=c.content.fieldName));return c};t.prototype._findUndeleted=function(a,b){if(!a)return null;if(!a.isDeleted)return a;var c=this.rows.indexOf(a),d=this.rows.length;if(b)for(c+=1,c<d&&(a=this.rows[c]);c<d&&a.isDeleted;)c+=1,c<d&&(a=this.rows[c]);else for(--c,0<=c&&(a=this.rows[c]);0<=c&&a.isDeleted;)--c,0<=c&&(a=this.rows[c]);a.isDeleted&&(a=null);return a};t.prototype._updateCurrent=function(a,b){this.currentRow=a;b&&a&&!a.isDeleted&&this._scrollToCurrent(!0)};
t.prototype._scrollToCurrent=function(a){var b=this.currentRow;b&&b.scrollIntoView(a)};t.prototype.handleError=function(a,b){var d=c.prototype.handleError.call(this,a,b);return d?d:f.handleError(a,b)};t.prototype._onDSCurrentChanged=function(){var a=this.dataSource,b;a&&(b=a.currentItem);b?this._updateCurrent(this._rowMap[b._aspect._key],!1):this._updateCurrent(null,!1)};t.prototype._onDSCollectionChanged=function(b){var c=this,d;d=b.items;switch(b.change_type){case 2:this._isDSFilling||this._refreshGrid();
break;case 1:this._isDSFilling||c._appendItems(b.items);break;case 0:d.forEach(function(a){(a=c._rowMap[a._aspect._key])&&c._removeRow(a)});break;case 3:if(d=c._rowMap[b.old_key])delete c._rowMap[b.old_key],c._rowMap[b.new_key]=d;break;default:throw Error(q.format(a.ERRS.ERR_COLLECTION_CHANGETYPE_INVALID,b.change_type));}};t.prototype._onDSFill=function(a){var b=this;a.isBegin?(b._isDSFilling=!0,b._isSorting||a.isPageChanged||b._resetColumnsSort()):(b._isDSFilling=!1,a.resetUI?b._refreshGrid():b._appendItems(a.newItems),
a.isPageChanged&&setTimeout(function(){b._isDestroyCalled||b._onPageChanged()},0),setTimeout(function(){b._isDestroyCalled||b._updateColsDim()},0))};t.prototype._onPageChanged=function(){this._rowSelectorCol&&(this._rowSelectorCol.checked=!1);this._scrollToCurrent(!1);this.raiseEvent("page_changed",{})};t.prototype._onItemEdit=function(a,b,c){if(a=this._rowMap[a._aspect._key])b?(a._onBeginEdit(),this._editingRow=a):(a._onEndEdit(c),this._editingRow=null),this.raisePropertyChanged("editingRow")};t.prototype._onItemAdded=
function(a){var b=this._rowMap[a.item._aspect._key];b&&(this._updateCurrent(b,!0),this._options.isHandleAddNew&&!a.isAddNewHandled&&(a.isAddNewHandled=this.showEditDialog()))};t.prototype._onItemStatusChanged=function(a,b){var c=a._aspect._changeType,d=this.dataSource,s=this._rowMap[a._aspect._key];s&&(3===c?(s.isDeleted=!0,(c=this._findUndeleted(s,!0))||(c=this._findUndeleted(s,!1)),c&&(d.currentItem=c.item)):3===b&&3!==c&&(s.isDeleted=!1))};t.prototype._onDSErrorsChanged=function(a){(a=this._rowMap[a._aspect._key])&&
a.updateErrorState()};t.prototype._bindDS=function(){var a=this,b=this.dataSource;b&&(b.addOnCollChanged(function(b,c){a._onDSCollectionChanged(c)},a._objId),b.addOnFill(function(b,c){a._onDSFill(c)},a._objId),b.addOnPropertyChange("currentItem",function(b,c){a._onDSCurrentChanged()},a._objId),b.addOnBeginEdit(function(b,c){a._onItemEdit(c.item,!0,void 0)},a._objId),b.addOnEndEdit(function(b,c){a._onItemEdit(c.item,!1,c.isCanceled)},a._objId),b.addOnErrorsChanged(function(b,c){a._onDSErrorsChanged(c.item)},
a._objId),b.addOnStatusChanged(function(c,d){b===c&&a._onItemStatusChanged(d.item,d.oldChangeType)},a._objId),b.addOnItemAdded(function(c,d){b===c&&a._onItemAdded(d)},a._objId),this._refreshGrid(),this._updateColsDim(),this._onDSCurrentChanged())};t.prototype._unbindDS=function(){var a=this.dataSource;a&&a.removeNSHandlers(this._objId)};t.prototype._clearGrid=function(){if(0!==this._rows.length){this._isClearing=!0;try{this.collapseDetails();var a=this._tBodyEl,b=f.document.createElement("tbody");
this._tableEl.replaceChild(b,a);var c=this._rows;this._rows=[];this._rowMap={};c.forEach(function(a){a.destroy()})}finally{this._isClearing=!1}this._currentRow=null}};t.prototype._updateColsDim=function(){var a=0,b=this._$headerDiv;this._columns.forEach(function(b){a+=b.el.offsetWidth});b.width(a);this._columns.forEach(function(a){a.$extcol.width(a.el.offsetWidth)})};t.prototype._wrapTable=function(){var a=this._$tableEl,b,c,s,e=this;a.wrap(f.$("<div></div>").addClass(d.css.wrapDiv));c=a.parent();
c.wrap(f.$("<div></div>").addClass(d.css.container));s=c.parent();b=f.$("<div></div>").addClass(d.css.headerDiv).insertBefore(c);f.$(this._tHeadRow).addClass(d.css.columnInfo);this._$wrapDiv=c;this._$headerDiv=b;this._$contaner=s;this._options.containerCss&&s.addClass(this._options.containerCss);this._options.wrapCss&&c.addClass(this._options.wrapCss);this._options.headerCss&&b.addClass(this._options.headerCss);var x=a.width();e._columnWidthChecker=function(){var b=a.width();x!==b&&(x=b,e._updateColsDim())}};
t.prototype._unWrapTable=function(){var a=this._$tableEl;this._$headerDiv&&(this._columnWidthChecker=function(){},this._$headerDiv.remove(),this._$headerDiv=null,a.unwrap(),this._$wrapDiv=null,a.unwrap(),this._$contaner=null)};t.prototype._createColumns=function(){for(var a=this,b=this._tHeadCells,c=b.length,d=[],s,e,x=0;x<c;x+=1)s=b[x],e=this._parseColumnAttr(s.getAttribute(n.DATA_ATTR.DATA_COLUMN),s.getAttribute(n.DATA_ATTR.DATA_CONTENT)),d.push({th:s,colinfo:e});d.forEach(function(b){(b=a._createColumn(b))&&
a._columns.push(b)})};t.prototype._createColumn=function(b){var c;switch(b.colinfo.type){case "row_expander":this._expanderCol||(this._expanderCol=c=new s(this,b));break;case "row_actions":this._actionsCol||(this._actionsCol=c=new F(this,b));break;case "row_selector":this._rowSelectorCol||(this._rowSelectorCol=c=new x(this,b));break;case "data":c=new u(this,b);break;default:throw Error(q.format(a.ERRS.ERR_GRID_COLTYPE_INVALID,b.colinfo.type));}return c};t.prototype._appendItems=function(a){if(!this._isDestroyCalled)for(var b,
c=this._tBodyEl,d=0,s=a.length;d<s;d+=1)b=a[d],this._rowMap[b._key]||this._createRowForItem(c,b)};t.prototype._refreshGrid=function(){var a=this,b=this.dataSource;a._clearGrid();if(b){var c=f.document.createDocumentFragment(),d=this._tBodyEl,s=f.document.createElement("tbody");b.items.forEach(function(b,d){a._createRowForItem(c,b,d)});s.appendChild(c);a._tableEl.replaceChild(s,d)}};t.prototype._createRowForItem=function(a,b,c){c=f.document.createElement("tr");c=new y(this,{tr:c,item:b});this._rowMap[b._aspect._key]=
c;this._rows.push(c);a.appendChild(c.el);return c};t.prototype._createDetails=function(){var a=this._options.details.templateID,b=f.document.createElement("tr");return new E({grid:this,tr:b,details_id:a})};t.prototype.sortByColumn=function(a){var b=this,c=this.dataSource,d=a.sortMemberName.split(";");b._isSorting=!0;c.sort(d,a.sortOrder).always(function(){b._isSorting=!1})};t.prototype.selectRows=function(a){this._rows.forEach(function(b){b.isDeleted||(b.isSelected=a)})};t.prototype.findRowByItem=
function(a){return(a=this._rowMap[a._aspect._key])?a:null};t.prototype.collapseDetails=function(){if(this._details){var a=this._expandedRow;a&&(this._expandedRow=null,this.raiseEvent("row_expanded",{old_expandedRow:a,expandedRow:null,isExpanded:!1}))}};t.prototype.getSelectedRows=function(){var a=[];this._rows.forEach(function(b){b.isDeleted||b.isSelected&&a.push(b)});return a};t.prototype.showEditDialog=function(){if(!this._options.editor||!this._options.editor.templateID||!this._editingRow)return!1;
var a,b=this._editingRow.item;b._aspect.isEditing||b._aspect.beginEdit();this._dialog?this._dialog.dataContext=b:(a=q.extend(!1,{dataContext:b},this._options.editor),this._dialog=new r.datadialog.DataEditDialog(this.app,a));this._dialog.canRefresh=!!this.dataSource.permissions.canRefreshRow&&!b._aspect._isNew;this._dialog.show();return!0};t.prototype.scrollToCurrent=function(a){this._scrollToCurrent(a)};t.prototype.addNew=function(){var a=this.dataSource;try{a.addNew(),this.showEditDialog()}catch(b){f.reThrow(b,
this.handleError(b,this))}};t.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,delete b[this.uniqueID],--l,0==l&&clearInterval(e),f._untrackSelectable(this),this._details&&(this._details.destroy(),this._details=null),this._options.animation&&(this._options.animation.stop(),this._options.animation=null),this._dialog&&(this._dialog.destroy(),this._dialog=null),this.dataSource=null,this._unWrapTable(),this._$tableEl.removeClass(d.css.dataTable),f.$(this._tHeadRow).removeClass(d.css.columnInfo),
this._$tableEl=this._tableEl=null,this._options.app=null,this._options={},c.prototype.destroy.call(this))};Object.defineProperty(t.prototype,"app",{get:function(){return this._options.app},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"$container",{get:function(){return this._$contaner},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_tBodyEl",{get:function(){return this._tableEl.tBodies[0]},
enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_tHeadEl",{get:function(){return this._tableEl.tHead},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_tFootEl",{get:function(){return this._tableEl.tFoot},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_tHeadRow",{get:function(){if(!this._tHeadEl)return null;var a=this._tHeadEl.rows;return 0===a.length?null:a[0]},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_tHeadCells",
{get:function(){var b=this._tHeadRow;return b?a.ArrayHelper.fromCollection(b.cells):[]},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"containerEl",{get:function(){return this._$contaner.get(0)},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,
"dataSource",{get:function(){return this._options.dataSource},set:function(a){a!==this.dataSource&&(this.dataSource&&this._unbindDS(),this._clearGrid(),this._options.dataSource=a,this.dataSource&&this._bindDS(),this.raisePropertyChanged("dataSource"))},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"rows",{get:function(){return this._rows},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"columns",{get:function(){return this._columns},enumerable:!0,configurable:!0});
Object.defineProperty(t.prototype,"currentRow",{get:function(){return this._currentRow},set:function(a){var b=this.dataSource,c=this._currentRow,d=!1;b&&(c!==a&&(this._currentRow=a,c&&(c.isCurrent=!1),a&&(a.isCurrent=!0),d=!0),a?a.item!==b.currentItem&&(b.currentItem=a.item):b.currentItem=null,d&&this.raisePropertyChanged("currentRow"))},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"editingRow",{get:function(){return this._editingRow},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,
"isCanEdit",{get:function(){if(null!==this._options.isCanEdit)return this._options.isCanEdit;var a=this.dataSource;return!!a&&a.permissions.canEditRow},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"isCanDelete",{get:function(){if(null!==this._options.isCanDelete)return this._options.isCanDelete;var a=this.dataSource;return!!a&&a.permissions.canDeleteRow},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"isCanAddNew",{get:function(){var a=this.dataSource;return!!a&&
a.permissions.canAddRow},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"isUseScrollInto",{get:function(){return this._options.isUseScrollInto},set:function(a){this._options.isUseScrollInto=a},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"animation",{get:function(){this.options.animation||(this.options.animation=new D);return this.options.animation},enumerable:!0,configurable:!0});return t}(a.BaseObject);d.DataGrid=t;v=function(a){function b(){a.apply(this,
arguments)}__extends(b,a);b.prototype.toString=function(){return"GridElView"};b.prototype._init=function(b){a.prototype._init.call(this,b);this._gridEventCommand=this._grid=null;this._options=b;this._createGrid()};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._grid&&!this._grid.getIsDestroyCalled()&&this._grid.destroy(),this._gridEventCommand=this._grid=null,a.prototype.destroy.call(this))};b.prototype._createGrid=function(){var a=q.extend(!1,{app:this._app,el:this._el,
dataSource:null,animation:null},this._options);this._grid=new t(a);this._bindGridEvents()};b.prototype._bindGridEvents=function(){if(this._grid){var a=this;this._grid.addOnRowExpanded(function(b,c){a.invokeGridEvent("row_expanded",c)},this.uniqueID);this._grid.addOnRowSelected(function(b,c){a.invokeGridEvent("row_selected",c)},this.uniqueID);this._grid.addOnPageChanged(function(b,c){a.invokeGridEvent("page_changed",c)},this.uniqueID);this._grid.addOnCellDblClicked(function(b,c){a.invokeGridEvent("cell_dblclicked",
c)},this.uniqueID);this._grid.addOnRowStateChanged(function(b,c){a.invokeGridEvent("row_state_changed",c)},this.uniqueID);this._grid.addOnDestroyed(function(b,c){a._grid=null;a.invokePropChanged("grid");a.raisePropertyChanged("grid")},this.uniqueID)}};b.prototype.invokeGridEvent=function(a,b){var c={eventName:a,args:b};this._gridEventCommand&&this._gridEventCommand.execute(this,c)};Object.defineProperty(b.prototype,"dataSource",{get:function(){return this._isDestroyCalled?void 0:this.grid.dataSource},
set:function(a){this._isDestroyCalled||this.dataSource===a||(this.grid.dataSource=a,this.raisePropertyChanged("dataSource"))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"grid",{get:function(){return this._grid},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"gridEventCommand",{get:function(){return this._gridEventCommand},set:function(a){a!==this._gridEventCommand&&(this._gridEventCommand&&this.invokeGridEvent("command_disconnected",{}),(this._gridEventCommand=
a)&&this.invokeGridEvent("command_connected",{}))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"animation",{get:function(){return this._isDestroyCalled?void 0:this._grid.options.animation},set:function(a){this._isDestroyCalled||this.animation===a||(this._grid.options.animation=a,this.raisePropertyChanged("animation"))},enumerable:!0,configurable:!0});return b}(r.baseElView.BaseElView);d.GridElView=v;f.registerElView("table",v);f.registerElView("datagrid",v);f.onModuleLoaded("datagrid",
d)})(r.datagrid||(r.datagrid={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(d){var m=a.MOD.collection,n;a.global.addOnInitialize(function(a,d){n=a.utils});d.css={pager:"ria-data-pager",info:"pager-info",currentPage:"pager-current-page",otherPage:"pager-other-page"};var k=a.localizable.PAGER,g=function(g){function h(f){g.call(this);f=n.extend(!1,{app:null,el:null,dataSource:null,showTip:!0,showInfo:!1,showNumbers:!0,showFirstAndLast:!0,showPreviousAndNext:!1,useSlider:!0,hideOnSinglePage:!0,sliderSize:25},f);if(f.dataSource&&!(f.dataSource instanceof
m.BaseCollection))throw Error(a.ERRS.ERR_PAGER_DATASRC_INVALID);this._options=f;this._$el=a.global.$(f.el);this._objId="pgr"+n.getNewID();this._rowCount=this._rowsPerPage=0;this._currentPage=1;this._$el.addClass(d.css.pager);this._options.dataSource&&this._bindDS()}__extends(h,g);h.prototype._createElement=function(d){return a.global.$(a.global.document.createElement(d))};h.prototype._render=function(){var a=this._$el,e,g;this._clearContent();if(!(0>=this.rowsPerPage)&&(e=this.rowCount,0!=e&&(e=this.currentPage,
0!=e)))if(g=this.pageCount,this.hideOnSinglePage&&1==g)a.hide();else{a.show();if(this.showInfo){var b=this._createElement("span"),c=n.format(k.pageInfo,e,g);b.addClass(d.css.info).text(c).appendTo(a)}this.showFirstAndLast&&1!=e&&a.append(this._createFirst());this.showPreviousAndNext&&1!=e&&a.append(this._createPrevious());if(this.showNumbers){var b=1,c=g,h=this.sliderSize;this.useSlider&&0<h&&(b=Math.floor((h-1)/2),c=e+b+(h-1)%2,b=e-b,1>b&&(c+=1-b,b=1),c>g&&(b-=c-g,1>b&&(b=1),c=g));for(;b<=c;b++)b===
e?a.append(this._createCurrent()):a.append(this._createOther(b))}this.showPreviousAndNext&&e!=g&&a.append(this._createNext());this.showFirstAndLast&&e!=g&&a.append(this._createLast())}};h.prototype._setDSPageIndex=function(a){this.dataSource.pageIndex=a-1};h.prototype._onPageSizeChanged=function(a){this.rowsPerPage=a.pageSize};h.prototype._onPageIndexChanged=function(a){this.currentPage=a.pageIndex+1};h.prototype._onTotalCountChanged=function(a){this.rowCount=a.totalCount};h.prototype.destroy=function(){this._isDestroyed||
(this._isDestroyCalled=!0,this._unbindDS(),this._clearContent(),this._$el.removeClass(d.css.pager),this._$el=null,this._options={},g.prototype.destroy.call(this))};h.prototype._bindDS=function(){var a=this,d=this.dataSource;d&&(d.addOnFill(function(d,b){b.isBegin||b.isPageChanged||(a._unbindDS(),setTimeout(function(){a._bindDS()},0))},a._objId),d.addOnPropertyChange("pageIndex",function(g,b){a._onPageIndexChanged(d)},a._objId),d.addOnPropertyChange("pageSize",function(g,b){a._onPageSizeChanged(d)},
a._objId),d.addOnPropertyChange("totalCount",function(g,b){a._onTotalCountChanged(d)},a._objId),this._currentPage=d.pageIndex+1,this._rowsPerPage=d.pageSize,this._rowCount=d.totalCount,this._render())};h.prototype._unbindDS=function(){var a=this.dataSource;a&&a.removeNSHandlers(this._objId)};h.prototype._clearContent=function(){this._$el.empty()};h.prototype._createLink=function(a,d,g){var b=this._createElement("a"),c=this;b.text(""+d);b.attr("href","javascript:void(0)");g&&n.addToolTip(b,g);b.click(function(b){b.preventDefault();
c._setDSPageIndex(a);c.currentPage=a});return b};h.prototype._createFirst=function(){var a=this._createElement("span"),e;this.showTip&&(e=k.firstPageTip);e=this._createLink(1,k.firstText,e);a.addClass(d.css.otherPage).append(e);return a};h.prototype._createPrevious=function(){var a=this._createElement("span"),e=this.currentPage-1,g;this.showTip&&(g=n.format(k.prevPageTip,e));e=this._createLink(e,k.previousText,g);a.addClass(d.css.otherPage).append(e);return a};h.prototype._createCurrent=function(){var a=
this._createElement("span"),e=this.currentPage;a.text(""+e);this.showTip&&n.addToolTip(a,this._buildTip(e));a.addClass(d.css.currentPage);return a};h.prototype._createOther=function(a){var e=this._createElement("span"),g;this.showTip&&(g=this._buildTip(a));a=this._createLink(a,""+a,g);e.addClass(d.css.otherPage);e.append(a);return e};h.prototype._createNext=function(){var a=this._createElement("span"),e=this.currentPage+1,g;this.showTip&&(g=n.format(k.nextPageTip,e));e=this._createLink(e,k.nextText,
g);a.addClass(d.css.otherPage).append(e);return a};h.prototype._createLast=function(){var a=this._createElement("span"),e;this.showTip&&(e=k.lastPageTip);e=this._createLink(this.pageCount,k.lastText,e);a.addClass(d.css.otherPage).append(e);return a};h.prototype._buildTip=function(a){var d=this.rowsPerPage,g=this.rowCount,b=(a-1)*d+1,d=a==this.pageCount?g:a*d,c="";return c=a==this.currentPage?n.format(k.showingTip,b,d,g):n.format(k.showTip,b,d,g)};h.prototype.toString=function(){return"Pager"};Object.defineProperty(h.prototype,
"app",{get:function(){return this._options.app},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"el",{get:function(){return this._options.el},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"dataSource",{get:function(){return this._options.dataSource},set:function(a){a!==this.dataSource&&(this.dataSource&&this._unbindDS(),this._options.dataSource=a,this.dataSource&&this._bindDS(),this.raisePropertyChanged("dataSource"))},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,
"pageCount",{get:function(){var a=this.rowCount,d=this.rowsPerPage;return 0===a||0===d?0:0===a%d?a/d:a=Math.floor(a/d)+1},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"rowCount",{get:function(){return this._rowCount},set:function(a){this._rowCount!=a&&(this._rowCount=a,this._render(),this.raisePropertyChanged("rowCount"))},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"rowsPerPage",{get:function(){return this._rowsPerPage},set:function(a){this._rowsPerPage!=
a&&(this._rowsPerPage=a,this._render())},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"currentPage",{get:function(){return this._currentPage},set:function(a){this._currentPage!=a&&(this._currentPage=a,this._render(),this.raisePropertyChanged("currentPage"))},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"useSlider",{get:function(){return this._options.useSlider},set:function(a){this.useSlider!==a&&(this._options.useSlider=a,this._render())},enumerable:!0,configurable:!0});
Object.defineProperty(h.prototype,"sliderSize",{get:function(){return this._options.sliderSize},set:function(a){this.sliderSize!==a&&(this._options.sliderSize=a,this._render())},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"hideOnSinglePage",{get:function(){return this._options.hideOnSinglePage},set:function(a){this.hideOnSinglePage!==a&&(this._options.hideOnSinglePage=a,this._render())},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"showTip",{get:function(){return this._options.showTip},
set:function(a){this.showTip!==a&&(this._options.showTip=a,this._render())},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"showInfo",{get:function(){return this._options.showInfo},set:function(a){this._options.showInfo!==a&&(this._options.showInfo=a,this._render())},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"showFirstAndLast",{get:function(){return this._options.showFirstAndLast},set:function(a){this.showFirstAndLast!==a&&(this._options.showFirstAndLast=
a,this._render())},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"showPreviousAndNext",{get:function(){return this._options.showPreviousAndNext},set:function(a){this.showPreviousAndNext!==a&&(this._options.showPreviousAndNext=a,this._render())},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"showNumbers",{get:function(){return this._options.showNumbers},set:function(a){this.showNumbers!==a&&(this._options.showNumbers=a,this._render())},enumerable:!0,configurable:!0});
return h}(a.BaseObject);d.Pager=g;var h=function(a){function d(f,e,l){var b=this;this._pager=null;this._options=l;var c=n.extend(!1,{app:f,el:e,dataSource:null},this._options);this._pager=new g(c);this._pager.addOnDestroyed(function(){b._pager=null;b.invokePropChanged("pager");b.raisePropertyChanged("pager")});a.call(this,f,e,l)}__extends(d,a);d.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._pager&&!this._pager.getIsDestroyCalled()&&this._pager.destroy(),this._pager=
null,a.prototype.destroy.call(this))};d.prototype.toString=function(){return"PagerElView"};Object.defineProperty(d.prototype,"dataSource",{get:function(){return this._isDestroyCalled?void 0:this._pager.dataSource},set:function(a){this._isDestroyCalled||this.dataSource===a||(this._pager.dataSource=a,this.raisePropertyChanged("dataSource"))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"pager",{get:function(){return this._pager},enumerable:!0,configurable:!0});return d}(r.baseElView.BaseElView);
d.PagerElView=h;a.global.registerElView("pager",h);a.global.onModuleLoaded("pager",d)})(r.pager||(r.pager={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){(function(d){var m=a.MOD.consts,n=a.MOD.collection,k,g=a.global;g.addOnInitialize(function(a,d){k=a.utils});d.css={stackpanel:"ria-stackpanel",item:"stackpanel-item",currentItem:"current-item"};var h=function(h){function f(e){h.call(this);var f=this;e=k.extend(!1,{app:null,el:null,dataSource:null,orientation:"horizontal",templateID:null},e);if(e.dataSource&&!(e.dataSource instanceof n.BaseCollection))throw Error(a.ERRS.ERR_STACKPNL_DATASRC_INVALID);if(!e.templateID)throw Error(a.ERRS.ERR_STACKPNL_TEMPLATE_INVALID);
this._options=e;this._$el=g.$(e.el);this._objId="pnl"+g.utils.getNewID();this._isDSFilling=!1;this._currentItem=null;this._$el.addClass(d.css.stackpanel);this._itemMap={};this._$el.on("click",["div[",m.DATA_ATTR.DATA_EVENT_SCOPE,'="',this.uniqueID,'"]'].join(""),function(a){a.stopPropagation();a=g.$(this).data("data");f._onItemClicked(a.div,a.item)});e.dataSource&&this._bindDS();g._trackSelectable(this)}__extends(f,h);f.prototype._getEventNames=function(){var a=h.prototype._getEventNames.call(this);
return["item_clicked"].concat(a)};f.prototype.templateLoading=function(a){};f.prototype.templateLoaded=function(a){};f.prototype.templateUnLoading=function(a){};f.prototype.addOnItemClicked=function(a,d){this.addHandler("item_clicked",a,d)};f.prototype.removeOnItemClicked=function(a){this.removeHandler("item_clicked",a)};f.prototype._onKeyDown=function(a,d){var b=this.dataSource;if(b)if("horizontal"==this.orientation)switch(a){case 37:d.preventDefault();b.movePrev(!0)&&this.scrollIntoView(b.currentItem);
break;case 39:d.preventDefault(),b.moveNext(!0)&&this.scrollIntoView(b.currentItem)}else switch(a){case 38:d.preventDefault();b.movePrev(!0)&&this.scrollIntoView(b.currentItem);break;case 40:d.preventDefault(),b.moveNext(!0)&&this.scrollIntoView(b.currentItem)}};f.prototype._onKeyUp=function(a,d){};f.prototype._updateCurrent=function(a,f){var b=this._currentItem;b!==a&&(this._currentItem=a,b&&(b=this._itemMap[b._aspect._key])&&g.$(b.div).removeClass(d.css.currentItem),a&&(b=this._itemMap[a._aspect._key])&&
(g.$(b.div).addClass(d.css.currentItem),f&&b.div.scrollIntoView(!1)),this.raisePropertyChanged("currentItem"))};f.prototype._onDSCurrentChanged=function(){var a=this.dataSource.currentItem;a?this._updateCurrent(a,!0):this._updateCurrent(null,!1)};f.prototype._onDSCollectionChanged=function(d){var f=this,b=d.items;switch(d.change_type){case 2:this._isDSFilling||this._refresh();break;case 1:this._isDSFilling||f._appendItems(b);break;case 0:b.forEach(function(a){f._removeItem(a)});break;case 3:if(b=
f._itemMap[d.old_key])delete f._itemMap[d.old_key],f._itemMap[d.new_key]=b;break;default:throw Error(g.utils.format(a.ERRS.ERR_COLLECTION_CHANGETYPE_INVALID,d.change_type));}};f.prototype._onDSFill=function(a){a.isBegin?this._isDSFilling=!0:(this._isDSFilling=!1,a.resetUI?this._refresh():this._appendItems(a.newItems))};f.prototype._onItemStatusChanged=function(a,d){var b=a._aspect._changeType,c=this._itemMap[a._aspect._key];c&&(3===b?g.$(c.div).hide():3===d&&3!==b&&g.$(c.div).show())};f.prototype._createTemplate=
function(a){return new r.template.Template({app:this.app,templateID:this.templateID,dataContext:a,templEvents:this})};f.prototype._appendItems=function(a){if(!this._isDestroyCalled){var d=this;a.forEach(function(a){d._itemMap[a._aspect._key]||d._appendItem(a)})}};f.prototype._appendItem=function(a){if(a._aspect._key){var f=this._createElement("div"),b=f.get(0);f.addClass(d.css.item);"horizontal"==this.orientation&&f.css("display","inline-block");f.attr(m.DATA_ATTR.DATA_EVENT_SCOPE,this.uniqueID);
this._$el.append(f);b={div:b,template:null,item:a};f.data("data",b);this._itemMap[a._aspect._key]=b;b.template=this._createTemplate(a);b.div.appendChild(b.template.el)}};f.prototype._bindDS=function(){var a=this,d=this.dataSource;d&&(d.addOnCollChanged(function(b,c){d===b&&a._onDSCollectionChanged(c)},a._objId),d.addOnFill(function(b,c){d===b&&a._onDSFill(c)},a._objId),d.addOnPropertyChange("currentItem",function(b,c){d===b&&a._onDSCurrentChanged()},a._objId),d.addOnStatusChanged(function(b,c){d===
b&&a._onItemStatusChanged(c.item,c.oldChangeType)},a._objId),this._refresh())};f.prototype._unbindDS=function(){var a=this.dataSource;a&&a.removeNSHandlers(this._objId)};f.prototype._createElement=function(a){return g.$(g.document.createElement(a))};f.prototype._onItemClicked=function(a,d){this._updateCurrent(d,!1);this.dataSource.currentItem=d;this.raiseEvent("item_clicked",{item:d})};f.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,g._untrackSelectable(this),this._unbindDS(),
this._clearContent(),this._$el.removeClass(d.css.stackpanel),this._currentItem=this._$el=null,this._itemMap={},this._options={},h.prototype.destroy.call(this))};f.prototype._clearContent=function(){var a=this;a._$el.empty();g.utils.forEachProp(a._itemMap,function(d){a._removeItemByKey(d)})};f.prototype._removeItemByKey=function(a){var d=this._itemMap[a];d&&(delete this._itemMap[a],d.template.destroy(),d.template=null,g.$(d.div).removeData("data"),g.$(d.div).remove())};f.prototype._removeItem=function(a){this._removeItemByKey(a._aspect._key)};
f.prototype._refresh=function(){var a=this.dataSource,d=this;this._clearContent();a&&a.forEach(function(a){d._appendItem(a)})};f.prototype.scrollIntoView=function(a){a&&(a=this._itemMap[a._aspect._key])&&a.div.scrollIntoView(!1)};f.prototype.getDivElementByItem=function(a){return(a=this._itemMap[a._aspect._key])?a.div:null};f.prototype.toString=function(){return"StackPanel"};Object.defineProperty(f.prototype,"app",{get:function(){return this._options.app},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,
"el",{get:function(){return this._options.el},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"containerEl",{get:function(){return this._options.el},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"orientation",{get:function(){return this._options.orientation},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"templateID",{get:function(){return this._options.templateID},
enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"dataSource",{get:function(){return this._options.dataSource},set:function(a){a!==this.dataSource&&(this.dataSource&&this._unbindDS(),this._options.dataSource=a,this.dataSource&&this._bindDS(),this.raisePropertyChanged("dataSource"))},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"currentItem",{get:function(){return this._currentItem},enumerable:!0,configurable:!0});return f}(a.BaseObject);d.StackPanel=h;var p=function(a){function d(e,
f,b){var c=this;this._panel=null;this._options=b;var g=k.extend(!1,{app:e,el:f,dataSource:null},this._options);this._panel=new h(g);this._panel.addOnDestroyed(function(){c._panel=null;c.invokePropChanged("panel");c.raisePropertyChanged("panel")});a.call(this,e,f,b)}__extends(d,a);d.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._panel&&!this._panel.getIsDestroyCalled()&&this._panel.destroy(),this._panel=null,a.prototype.destroy.call(this))};d.prototype.toString=function(){return"StackPanelElView"};
Object.defineProperty(d.prototype,"dataSource",{get:function(){return this._isDestroyCalled?void 0:this._panel.dataSource},set:function(a){this._isDestroyCalled||this.dataSource===a||(this._panel.dataSource=a,this.raisePropertyChanged("dataSource"))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"panel",{get:function(){return this._panel},enumerable:!0,configurable:!0});return d}(r.baseElView.BaseElView);d.StackPanelElView=p;g.registerElView("stackpanel",p);g.onModuleLoaded("stackpanel",
d)})(r.stackpanel||(r.stackpanel={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){(function(r){var d;(function(m){function n(d,e){if(d)switch(d.name){case "AccessDeniedException":throw new c(a.ERRS.ERR_ACCESS_DENIED,e);case "ConcurrencyException":throw new v(a.ERRS.ERR_CONCURRENCY,e);case "ValidationException":throw new A(l.format(a.ERRS.ERR_VALIDATION,d.message),e);case "DomainServiceException":throw new b(l.format(a.ERRS.ERR_SVC_ERROR,d.message),e);default:throw new b(l.format(a.ERRS.ERR_UNEXPECTED_SVC_ERROR,d.message),e);}}function k(a,b){function c(a,b,d){if(b.nested&&
0<b.nested.length){var e,f,g=b.nested.length;for(f=0;f<g;f+=1)e=b.nested[f],e.nested&&0<e.nested.length?c(a+"."+e.fieldName,e,d):d(a+"."+e.fieldName,e)}else d(a,b)}c(a.fieldName,a,b)}var g=a.MOD.utils,h=a.MOD.collection,p=/^<head:(\d{1,6})>/,q=a.MOD.errors.ValidationError,f=g.valueUtils,e=a.baseUtils,l;a.global.addOnInitialize(function(a,b){l=a.utils});(function(a){a[a.None=0]="None";a[a.Changed=1]="Changed";a[a.Setted=2]="Setted";a[a.Refreshed=4]="Refreshed"})(m.FLAGS||(m.FLAGS={}));(function(a){a[a.NONE=
0]="NONE";a[a.RefreshCurrent=1]="RefreshCurrent";a[a.MergeIntoCurrent=2]="MergeIntoCurrent";a[a.CommitChanges=3]="CommitChanges"})(m.REFRESH_MODE||(m.REFRESH_MODE={}));(function(a){a[a.NoAction=0]="NoAction";a[a.Cascade=1]="Cascade";a[a.SetNulls=2]="SetNulls"})(m.DELETE_ACTION||(m.DELETE_ACTION={}));(function(a){a[a.SUBMIT=0]="SUBMIT";a[a.LOAD=1]="LOAD";a[a.INVOKE=2]="INVOKE";a[a.REFRESH=3]="REFRESH";a[a.INIT=4]="INIT"})(m.DATA_OPER||(m.DATA_OPER={}));var b=function(a){function b(c,d){var e;c&&(e=
c.message);e||(e=""+c);a.call(this,e);this.origError=c;this._operationName=d}__extends(b,a);Object.defineProperty(b.prototype,"operationName",{get:function(){return this._operationName},enumerable:!0,configurable:!0});return b}(r.errors.BaseError);m.DataOperationError=b;var c=function(a){function b(){a.apply(this,arguments)}__extends(b,a);return b}(b);m.AccessDeniedError=c;var v=function(a){function b(){a.apply(this,arguments)}__extends(b,a);return b}(b);m.ConcurrencyError=v;var A=function(a){function b(){a.apply(this,
arguments)}__extends(b,a);return b}(b);m.SvcValidationError=A;var B=function(a){function b(c,d,f){var g=c.message||""+c;this.origError=c;this._allSubmitted=d||[];this._notValidated=f||[];if(0<this._notValidated.length){var u=[g+":"];this._notValidated.forEach(function(a){u.push(e.format("item key:{0} errors:{1}",a._aspect._key,a._aspect.getErrorString()))});g=u.join("\r\n")}a.call(this,g,0)}__extends(b,a);Object.defineProperty(b.prototype,"allSubmitted",{get:function(){return this._allSubmitted},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"notValidated",{get:function(){return this._notValidated},enumerable:!0,configurable:!0});return b}(b);m.SubmitError=B;var z=function(b){function c(a){b.call(this);this._query=a;this._cache=[];this._totalCount=0;this._itemsByKey={}}__extends(c,b);c.prototype.getCachedPage=function(b){var c=this._cache.filter(function(a){return a.pageIndex===b});if(0==c.length)return null;if(1!=c.length)throw Error(e.format(a.ERRS.ERR_ASSERTION_FAILED,
"res.length == 1"));return c[0]};c.prototype.reindexCache=function(){var a=this,b;this._itemsByKey={};for(var c=0;c<this._cache.length;c+=1)b=this._cache[c],b.items.forEach(function(b){a._itemsByKey[b._aspect._key]=b})};c.prototype.getPrevCachedPageIndex=function(a){for(var b=-1,c,d=0;d<this._cache.length;d+=1)c=this._cache[d].pageIndex,c>b&&c<a&&(b=c);return b};c.prototype.getNextRange=function(a){var b=Math.floor((this.loadPageCount-1)/2),c=a+b+(this.loadPageCount-1)%2,b=a-b;a=this.getPrevCachedPageIndex(a);
0>b&&(c+=0-b,b=0);b<=a&&(c+=a-b+1,b+=a-b+1);this._pageCount>this.loadPageCount&&c>this._pageCount-1&&(b-=c-(this._pageCount-1),0>b&&(b=0),c=this._pageCount-1);b<=a&&(c+=a-b+1,b+=a-b+1);a=c-b+1;a<this.loadPageCount&&(c+=this.loadPageCount-a,a=c-b+1);return{start:b,end:c,cnt:a}};c.prototype.fillCache=function(a,b){var c,d=this._itemsByKey,e,f,g=b.length,u,h=this.pageSize;for(e=0;e<this.loadPageCount;e+=1)for(f=a+e,u=this.getCachedPage(f),u||(u={items:[],pageIndex:f},this._cache.push(u)),f=0;f<h;f+=
1)if(c=e*h+f,c<g)c=b[c],d[c._aspect._key]||(u.items.push(c),d[c._aspect._key]=c,c._aspect._isCached=!0);else return};c.prototype.clear=function(){var a,b,c,d,e=this._query.dbSet;for(a=0;a<this._cache.length;a+=1)for(c=this._cache[a].items,b=0;b<c.length;b+=1)(d=c[b])&&null!==d._aspect._key&&(d._aspect._isCached=!1,e.getItemByKey(d._aspect._key)||d._aspect.destroy());this._cache=[];this._itemsByKey={}};c.prototype.clearCacheForPage=function(a){var b=this.getCachedPage(a);a=this._query.dbSet;if(b){var c,
d,e=this._cache.indexOf(b);c=b.items;for(b=0;b<c.length;b+=1)(d=c[b])&&null!==d._aspect._key&&(delete this._itemsByKey[d._aspect._key],d._aspect._isCached=!1,a.getItemByKey(d._aspect._key)||d._aspect.destroy());this._cache.splice(e,1)}};c.prototype.hasPage=function(a){for(var b=0;b<this._cache.length;b+=1)if(this._cache[b].pageIndex===a)return!0;return!1};c.prototype.getItemByKey=function(a){return this._itemsByKey[a]};c.prototype.getPageByItem=function(a){a=this._itemsByKey[a._aspect._key];if(!a)return-1;
for(var b=0;b<this._cache.length;b+=1)if(-1<this._cache[b].items.indexOf(a))return this._cache[b].pageIndex;return-1};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this.clear(),b.prototype.destroy.call(this))};c.prototype.toString=function(){return"DataCache"};Object.defineProperty(c.prototype,"_pageCount",{get:function(){var a=this.totalCount,b=this.pageSize;return 0===a||0===b?0:a=0===a%b?a/b:Math.floor(a/b)+1},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"pageSize",{get:function(){return this._query.pageSize},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"loadPageCount",{get:function(){return this._query.loadPageCount},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"totalCount",{get:function(){return this._totalCount},set:function(a){l.check.isNt(a)&&(a=0);a!==this._totalCount&&(this._totalCount=a,this.raisePropertyChanged("totalCount"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"cacheSize",
{get:function(){return this._cache.length},enumerable:!0,configurable:!0});return c}(a.BaseObject);m.DataCache=z;var C=function(b){function c(a,d){b.call(this);this._dbSet=a;this.__queryInfo=d;this._filterInfo={filterItems:[]};this._sortInfo={sortItems:[]};this._isClearPrevData=this._isIncludeTotalCount=!0;this._pageSize=a.pageSize;this._pageIndex=a.pageIndex;this._params={};this._loadPageCount=1;this._isClearCacheOnEveryLoad=!0;this._dataCache=null;this._cacheInvalidated=!1}__extends(c,b);c.prototype.getFieldInfo=
function(a){return this._dbSet.getFieldInfo(a)};c.prototype.getFieldNames=function(){return this._dbSet.getFieldNames()};c.prototype._addSort=function(a,b){var c=0;l.check.isNt(b)||(c=b);this._sortInfo.sortItems.push({fieldName:a,sortOrder:c});this._cacheInvalidated=!0};c.prototype._addFilterItem=function(b,c,d){var e=0,g=this.getFieldInfo(b);if(!g)throw Error(l.format(a.ERRS.ERR_DBSET_INVALID_FIELDNAME,this.dbSetName,b));var h=this._serverTimezone,u=g.dateConversion,k=[],k=l.check.isArray(d)?d:[d],
k=a.ArrayHelper.clone(k).map(function(a){return f.stringifyValue(a,u,g.dataType,h)});switch(c){case 0:case 9:case 2:case 3:case 4:case 5:case 7:case 6:case 8:e=c;break;case 1:e=c;if(2!=d.length)throw Error(a.ERRS.ERR_QUERY_BETWEEN);break;default:throw Error(l.format(a.ERRS.ERR_QUERY_OPERATOR_INVALID,c));}this._filterInfo.filterItems.push({fieldName:b,kind:e,values:k});this._cacheInvalidated=!0};c.prototype.where=function(a,b,c){this._addFilterItem(a,b,c);return this};c.prototype.and=function(a,b,
c){this._addFilterItem(a,b,c);return this};c.prototype.orderBy=function(a,b){this._addSort(a,b);return this};c.prototype.thenBy=function(a,b){this._addSort(a,b);return this};c.prototype.clearSort=function(){this._sortInfo.sortItems=[];this._cacheInvalidated=!0;return this};c.prototype.clearFilter=function(){this._filterInfo.filterItems=[];this._cacheInvalidated=!0;return this};c.prototype.clearParams=function(){this._params={};this._cacheInvalidated=!0;return this};c.prototype._clearCache=function(){this._dataCache&&
(this._dataCache.destroy(),this._dataCache=null);this._resetCacheInvalidated()};c.prototype._getCache=function(){this._dataCache||(this._dataCache=new z(this));return this._dataCache};c.prototype._reindexCache=function(){this._dataCache&&this._dataCache.reindexCache()};c.prototype._isPageCached=function(a){return this._dataCache?this._dataCache.hasPage(a):!1};c.prototype._resetCacheInvalidated=function(){this._cacheInvalidated=!1};c.prototype.load=function(){return this.dbSet.dbContext.load(this)};
c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._clearCache(),b.prototype.destroy.call(this))};c.prototype.toString=function(){return"DataQuery"};Object.defineProperty(c.prototype,"_queryInfo",{get:function(){return this.__queryInfo},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_serverTimezone",{get:function(){return this._dbSet.dbContext.serverTimezone},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"entityType",{get:function(){return this._dbSet.entityType},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"dbSet",{get:function(){return this._dbSet},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"dbSetName",{get:function(){return this._dbSet.dbSetName},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"queryName",{get:function(){return this.__queryInfo.methodName},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"filterInfo",{get:function(){return this._filterInfo},enumerable:!0,configurable:!0});
Object.defineProperty(c.prototype,"sortInfo",{get:function(){return this._sortInfo},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isIncludeTotalCount",{get:function(){return this._isIncludeTotalCount},set:function(a){this._isIncludeTotalCount=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isClearPrevData",{get:function(){return this._isClearPrevData},set:function(a){this._isClearPrevData=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"pageSize",{get:function(){return this._pageSize},set:function(a){this._pageSize!=a&&(this._pageSize=a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"pageIndex",{get:function(){return this._pageIndex},set:function(a){this._pageIndex!=a&&(this._pageIndex=a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"params",{get:function(){return this._params},set:function(a){this._params!==a&&(this._params=a,this._cacheInvalidated=!0)},enumerable:!0,configurable:!0});
Object.defineProperty(c.prototype,"isPagingEnabled",{get:function(){return this._dbSet.isPagingEnabled},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"loadPageCount",{get:function(){return this._loadPageCount},set:function(a){1>a&&(a=1);this._loadPageCount!=a&&(this._loadPageCount=a,1===a&&this._clearCache(),this.raisePropertyChanged("loadPageCount"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isClearCacheOnEveryLoad",{get:function(){return this._isClearCacheOnEveryLoad},
set:function(a){this._isClearCacheOnEveryLoad!=a&&(this._isClearCacheOnEveryLoad=a,this.raisePropertyChanged("isClearCacheOnEveryLoad"))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isCacheValid",{get:function(){return!!this._dataCache&&!this._cacheInvalidated},enumerable:!0,configurable:!0});return c}(a.BaseObject);m.TDataQuery=C;var w=function(a){function b(){a.apply(this,arguments)}__extends(b,a);return b}(C);m.DataQuery=w;w=function(b){function c(a,d,f){this.__dbSet=a;b.call(this);
var g=this;this.__changeType=0;this.__isCached=this.__isRefreshing=!1;this._saveChangeType=this._origVals=this._srvRowKey=null;a=this._dbSet.getFieldInfos();for(var l,u=0,k=a.length;u<k;u+=1)l=a[u],5!=l.fieldType?g._vals[l.fieldName]=null:h.fn_traverseField(l,function(a,b){5==b.fieldType?e.setValue(g._vals,a,{},!1):e.setValue(g._vals,a,null,!1)});this._initRowInfo(d,f)}__extends(c,b);c.prototype._initRowInfo=function(a,b){a&&(this._key=this._srvRowKey=a.k,this._processValues("",a.v,b))};c.prototype._processValues=
function(b,c,d){var g=this,h=g._serverTimezone;c.forEach(function(c,x){var l=d[x],u=b+l.n,k=g._dbSet.getFieldInfo(u);if(!k)throw Error(e.format(a.ERRS.ERR_DBSET_INVALID_FIELDNAME,g._dbSetName,u));5==k.fieldType?g._processValues(u+".",c,l.p):(l=f.parseValue(c,k.dataType,k.dateConversion,h),b?e.setValue(g._vals,u,l,!1):g._vals[u]=l)})};c.prototype._onFieldChanged=function(a,b){var c=this;this._isDestroyCalled||(c.getItem().raisePropertyChanged(a),b.dependents&&0<b.dependents.length&&b.dependents.forEach(function(a){c.getItem().raisePropertyChanged(a)}))};
c.prototype._getValueChange=function(a,b,c){var d=this._dbSet,f,g,h;if(1==b.fieldType||3==b.fieldType||2==b.fieldType||6==b.fieldType)return null;if(5==b.fieldType)for(f={fieldName:b.fieldName,val:null,orig:null,flags:0,nested:[]},g=b.nested.length,d=0;d<g;d+=1)(h=this._getValueChange(a+"."+b.nested[d].fieldName,b.nested[d],c))&&f.nested.push(h);else f=d._getStrValue(e.getValue(this._vals,a),b),a=null===this._origVals?f:d._getStrValue(e.getValue(this._origVals,a),b),f=a!==f?{fieldName:b.fieldName,
val:f,orig:a,flags:3,nested:null}:0<b.isPrimaryKey||4==b.fieldType||b.isNeedOriginal?{fieldName:b.fieldName,val:f,orig:a,flags:2,nested:null}:{fieldName:b.fieldName,val:null,orig:null,flags:0,nested:null};return c?5==b.fieldType?0<f.nested.length?f:null:1===(f.flags&1)?f:null:f};c.prototype._getValueChanges=function(a){var b=this;return this._dbSet.getFieldInfos().map(function(c){return b._getValueChange(c.fieldName,c,a)}).filter(function(a){return!!a})};c.prototype._fldChanging=function(a,b,c,d){this._origVals||
(this._origVals=l.cloneObj(this._vals));return!0};c.prototype._fldChanged=function(a,b,c,d){if(1!=b.fieldType&&6!=b.fieldType)switch(this._changeType){case 0:this._changeType=2}this._onFieldChanged(a,b);return!0};c.prototype._skipValidate=function(a,b){var c=this._dbSet._getChildToParentNames(a.fieldName),d=!1;if(c&&null===b)for(var e=0,f=c.length;e<f&&!(d=!!this._getFieldVal(c[e]));e+=1);return d};c.prototype._beginEdit=function(){if(!b.prototype._beginEdit.call(this))return!1;this._saveChangeType=
this._changeType;return!0};c.prototype._endEdit=function(){if(!b.prototype._endEdit.call(this))return!1;this._saveChangeType=null;return!0};c.prototype._getCalcFieldVal=function(a){return this._isDestroyCalled?null:this._dbSet._getCalcFieldVal(a,this.getItem())};c.prototype._getNavFieldVal=function(a){return this._isDestroyCalled?null:this._dbSet._getNavFieldVal(a,this.getItem())};c.prototype._setNavFieldVal=function(a,b){this._dbSet._setNavFieldVal(a,this.getItem(),b)};c.prototype._updateKeys=function(a){this._key=
this._srvRowKey=a};c.prototype._checkCanRefresh=function(){if(null===this._key||1===this._changeType)throw Error(a.ERRS.ERR_OPER_REFRESH_INVALID);};c.prototype._refreshValue=function(b,c,d){var g=this._dbSet.getFieldInfo(c);if(!g)throw Error(e.format(a.ERRS.ERR_DBSET_INVALID_FIELDNAME,this._dbSetName,c));var h,l,u=g.dataType;b=f.parseValue(b,u,g.dateConversion,this._serverTimezone);h=e.getValue(this._vals,c);switch(d){case 3:f.compareVals(b,h,u)||(e.setValue(this._vals,c,b,!1),this._onFieldChanged(c,
g));break;case 1:this._origVals&&e.setValue(this._origVals,c,b,!1);this._saveVals&&e.setValue(this._saveVals,c,b,!1);f.compareVals(b,h,u)||(e.setValue(this._vals,c,b,!1),this._onFieldChanged(c,g));break;case 2:this._origVals&&(l=e.getValue(this._origVals,c),e.setValue(this._origVals,c,b,!1));void 0!==l&&!f.compareVals(l,h,u)||f.compareVals(b,h,u)||(e.setValue(this._vals,c,b,!1),this._onFieldChanged(c,g));break;default:throw Error(e.format(a.ERRS.ERR_PARAM_INVALID,"refreshMode",d));}};c.prototype._refreshValues=
function(a,b){var c=this,d=this._changeType;this._isDestroyed||(b||(b=1),a.values.forEach(function(a){k(a,function(a,d){4===(d.flags&4)&&c._refreshValue(d.val,a,b)})}),2===d&&0===this._getValueChanges(!0).length&&(this._origVals=null,this._changeType=0))};c.prototype._getRowInfo=function(){return{values:this._getValueChanges(!1),changeType:this._changeType,serverKey:this._srvKey,clientKey:this._key,error:null}};c.prototype._clearFieldVal=function(a){e.setValue(this._vals,a,null,!1)};c.prototype._getFieldVal=
function(a){return this._isDestroyCalled?null:e.getValue(this._vals,a)};c.prototype._setFieldVal=function(b,c){var d,f=this._dbSetName,g=this._dbSet,h=a.ERRS,l=this._getFieldVal(b),u=c,k=this.getFieldInfo(b),m=!1;if(!k)throw Error(e.format(h.ERR_DBSET_INVALID_FIELDNAME,f,b));this._isEditing||this._isUpdating||this.beginEdit();try{if(u=this._checkVal(k,u),l!=u&&this._fldChanging(b,k,l,u)&&(e.setValue(this._vals,b,u,!1),this._fldChanged(b,k,l,u),m=!0),g._removeError(this.getItem(),b),d=this._validateField(b))throw new q([d],
this);}catch(n){throw d=n instanceof q?n:new q([{fieldName:b,errors:[n.message]}],this),g._addError(this.getItem(),b,d.errors[0].errors),d;}return m};c.prototype._onAttaching=function(){b.prototype._onAttaching.call(this);this.__changeType=1};c.prototype._onAttach=function(){b.prototype._onAttach.call(this);if(null===this._key)throw Error(a.ERRS.ERR_ITEM_IS_DETACHED);this._dbSet._addToChanged(this.getItem())};c.prototype.deleteItem=function(){return this.deleteOnSubmit()};c.prototype.deleteOnSubmit=
function(){var a=this._changeType,b=this._dbSet;if(!b._onItemDeleting(this.getItem())||null===this._key)return!1;if(1===a)return b.removeItem(this.getItem()),!0;this._changeType=3;return!0};c.prototype.acceptChanges=function(a){var b=this._changeType,c=this._dbSet;null!==this._key&&0!==b&&(c._onCommitChanges(this.getItem(),!0,!1,b),3===b?c.removeItem(this.getItem()):(this._origVals=null,this._saveVals&&(this._saveVals=l.cloneObj(this._vals)),this._changeType=0,c._removeAllErrors(this.getItem()),a&&
this._refreshValues(a,3),c._onCommitChanges(this.getItem(),!1,!1,b)))};c.prototype.rejectChanges=function(){var a=this,b=a._changeType,c=a._dbSet;if(a._key&&0!==b)if(c._onCommitChanges(a.getItem(),!0,!0,b),1===b)c.removeItem(this.getItem());else{var d=a._getValueChanges(!0);a._origVals&&(a._vals=l.cloneObj(a._origVals),a._origVals=null,a._saveVals&&(a._saveVals=l.cloneObj(a._vals)));a._changeType=0;c._removeAllErrors(this.getItem());d.forEach(function(b){k(b,function(b,d){a._onFieldChanged(b,c.getFieldInfo(b))})});
c._onCommitChanges(this.getItem(),!1,!0,b)}};c.prototype.submitChanges=function(){var a=this.getDbContext(),b=l.uuid();a.addOnSubmitError(function(a,b){b.error instanceof d.SubmitError&&0<b.error.notValidated.length&&(b.isHandled=!0)},b);var c=a.submitChanges();c.always(function(){a.removeOnSubmitError(b)});return c};c.prototype.refresh=function(){return this.getDbContext()._refreshItem(this.getItem())};c.prototype.cancelEdit=function(){if(!this._isEditing)return!1;var a=this,b=this._getValueChanges(!0),
c=this._isNew,d=this._dbSet;this._isEditing=!1;this._vals=this._saveVals;this._saveVals=null;this._changeType=this._saveChangeType;this._saveChangeType=null;d._removeAllErrors(this.getItem());b.forEach(function(b){a.raisePropertyChanged(b.fieldName)});c&&this._notEdited&&d.removeItem(this.getItem());d._onEditing(this.getItem(),!1,!0);this.raisePropertyChanged("isEditing");return!0};c.prototype.getDbContext=function(){return this.__dbSet.dbContext};c.prototype.getDbSet=function(){return this.__dbSet};
c.prototype.getItem=function(){return this._item};c.prototype.toString=function(){return"EntityAspect"};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._saveChangeType=this._origVals=this._srvRowKey=this.__dbSet=null,this.__isCached=this.__isRefreshing=!1,this._item&&!this._item.getIsDestroyCalled()&&this._item.destroy(),this._item=null,b.prototype.destroy.call(this))};Object.defineProperty(c.prototype,"_isCanSubmit",{get:function(){return!0},enumerable:!0,configurable:!0});
Object.defineProperty(c.prototype,"_changeType",{get:function(){return this.__changeType},set:function(a){if(this.__changeType!==a){var b=this.__changeType;this.__changeType=a;0!==a?this._dbSet._addToChanged(this.getItem()):this._dbSet._removeFromChanged(this._key);this._dbSet._onItemStatusChanged(this.getItem(),b)}},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_isNew",{get:function(){return 1===this.__changeType},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"_isDeleted",{get:function(){return 3===this.__changeType},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_entityType",{get:function(){return this.__dbSet.entityType},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_srvKey",{get:function(){return this._srvRowKey},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_dbSetName",{get:function(){return this.__dbSet.dbSetName},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_serverTimezone",
{get:function(){return this.getDbContext().serverTimezone},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_collection",{get:function(){return this.__dbSet},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_dbSet",{get:function(){return this.__dbSet},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_isRefreshing",{get:function(){return this.__isRefreshing},set:function(a){this.__isRefreshing!==a&&(this.__isRefreshing=a,this.raisePropertyChanged("_isRefreshing"))},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_isCached",{get:function(){return this.__isCached},set:function(a){this.__isCached=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isHasChanges",{get:function(){return 0!==this.__changeType},enumerable:!0,configurable:!0});return c}(h.ItemAspect);m.EntityAspect=w;w=function(b){function c(a,d,f){b.call(this);var g=this,l=a.dbSetInfo,k=l.fieldInfos;this._dbContext=a.dbContext;this._options.dbSetName=l.dbSetName;
this._options.enablePaging=l.enablePaging;this._options.pageSize=l.pageSize;this._query=null;this._aspectType=d;this._entityType=f;this._isSubmitOnDelete=!1;this._navfldMap={};this._calcfldMap={};this._fieldInfos=k;this._trackAssoc={};this._trackAssocMap={};this._childAssocMap={};this._parentAssocMap={};this._changeCount=0;this._changeCache={};this._ignorePageChanged=!1;k.forEach(function(a){g._fieldMap[a.fieldName]=a;h.fn_traverseField(a,function(a,b){b.dependents=[];b.fullName=a})});k.forEach(function(b){h.fn_traverseField(b,
function(b,c){3==c.fieldType?g._navfldMap[c.fieldName]=g._doNavigationField(a,c):2==c.fieldType&&e.setValue(g._calcfldMap,b,g._doCalculatedField(a,c),!0)})});g._mapAssocFields();Object.freeze(this._perms)}__extends(c,b);c.prototype.handleError=function(a,b){return this.dbContext.handleError(a,b)};c.prototype._mapAssocFields=function(){for(var a=this._trackAssoc,b,c=Object.keys(a),d,e=this._trackAssocMap,f=0,g=c.length;f<g;f+=1){b=a[c[f]];for(var h=0,k=b.fieldRels.length;h<k;h+=1)d=b.fieldRels[h],
l.check.isArray(e[d.childField])?e[d.childField].push(b.childToParentName):e[d.childField]=[b.childToParentName]}};c.prototype._doNavigationField=function(b,c){var d=this,f=!0,g={getFunc:function(){throw Error("Function is not implemented");},setFunc:function(a){throw Error("Function is not implemented");}},h=b.childAssoc.filter(function(a){return a.childToParentName==c.fieldName});0===h.length&&(h=b.parentAssoc.filter(function(a){return a.parentToChildrenName==c.fieldName}),f=!1);if(1!=h.length)throw Error(e.format(a.ERRS.ERR_PARAM_INVALID_TYPE,
"assocs","Array"));var l=h[0].name;c.isReadOnly=!0;f?(c.isReadOnly=!1,d._childAssocMap[h[0].childToParentName]=h[0],h[0].fieldRels.forEach(function(a){a=d.getFieldInfo(a.childField);!c.isReadOnly&&a.isReadOnly&&(c.isReadOnly=!0)}),g.getFunc=function(){return d.dbContext.getAssociation(l).getParentItem(this)},c.isReadOnly||(d._trackAssoc[l]=h[0],g.setFunc=function(b){var s,f,g=d.dbContext.getAssociation(l);if(b&&!(b instanceof g.parentDS.entityType))throw Error(e.format(a.ERRS.ERR_PARAM_INVALID_TYPE,
"value",g.parentDS.dbSetName));if(b&&b._aspect&&b._aspect.getIsNew())this._aspect._setFieldVal(c.fieldName,b._aspect._key);else if(b)for(s=0,f=g.childFldInfos.length;s<f;s+=1)this[g.childFldInfos[s].fieldName]=b[g.parentFldInfos[s].fieldName];else for(this._aspect._getFieldVal(c.fieldName)&&this._aspect._setFieldVal(c.fieldName,null),s=0,f=g.childFldInfos.length;s<f;s+=1)this[g.childFldInfos[s].fieldName]=null})):(d._parentAssocMap[h[0].parentToChildrenName]=h[0],g.getFunc=function(){return d.dbContext.getAssociation(l).getChildItems(this)});
return g};c.prototype._doCalculatedField=function(b,c){function d(b){b.dependentOn&&b.dependentOn.split(",").forEach(function(c){var d=e.getFieldInfo(c);if(!d)throw Error(l.format(a.ERRS.ERR_CALC_FIELD_DEFINE,c));if(b===d)throw Error(l.format(a.ERRS.ERR_CALC_FIELD_SELF_DEPEND,c));0>d.dependents.indexOf(b.fullName)&&d.dependents.push(b.fullName)})}var e=this;c.isReadOnly=!0;c.dependentOn&&d(c);return{getFunc:function(){throw Error(l.format("Calculated field:'{0}' is not initialized",c.fieldName));
}}};c.prototype._refreshValues=function(b,c,d,f,g){var h=this;d.forEach(function(d,l){var F=f[l],k=b+F.n,u=h.getFieldInfo(k);if(!u)throw Error(e.format(a.ERRS.ERR_DBSET_INVALID_FIELDNAME,h.dbSetName,k));5==u.fieldType?h._refreshValues(k+".",c,d,F.p,g):c._aspect._refreshValue(d,k,g)})};c.prototype._setCurrentItem=function(c){if(c&&!(c instanceof this._entityType))throw Error(e.format(a.ERRS.ERR_PARAM_INVALID_TYPE,"currentItem",this._options.dbSetName));b.prototype._setCurrentItem.call(this,c)};c.prototype._getNewKey=
function(a){a="clkey_"+this._newKey;this._newKey+=1;return a};c.prototype._createNew=function(){var a=(new this._aspectType(this,null,null)).getItem();a._aspect._key=this._getNewKey(a);return a};c.prototype._clearChangeCache=function(){var a=this._changeCount;this._changeCache={};this._changeCount=0;a!==this._changeCount&&this.raisePropertyChanged("hasChanges")};c.prototype._onPageChanging=function(){var a=b.prototype._onPageChanging.call(this);if(!a)return a;this.hasChanges&&this.rejectChanges();
return a};c.prototype._onPageChanged=function(){this.cancelEdit();b.prototype._onPageChanged.call(this);this._ignorePageChanged||(this.query.pageIndex=this.pageIndex,this.dbContext._load(this.query,!0))};c.prototype._onPageSizeChanged=function(){b.prototype._onPageSizeChanged.call(this);this._query&&(this._query.pageSize=this.pageSize)};c.prototype._destroyItems=function(){this._items.forEach(function(a){a._aspect._isCached?a._aspect.removeNSHandlers(null):a._aspect.destroy()})};c.prototype._defineCalculatedField=
function(b,c){var d=e.getValue(this._calcfldMap,b);if(!d)throw Error(e.format(a.ERRS.ERR_PARAM_INVALID,"calculated fieldName",b));d.getFunc=c};c.prototype._getCalcFieldVal=function(a,b){return e.getValue(this._calcfldMap,a).getFunc.call(b)};c.prototype._getNavFieldVal=function(a,b){return e.getValue(this._navfldMap,a).getFunc.call(b)};c.prototype._setNavFieldVal=function(a,b,c){e.getValue(this._navfldMap,a).setFunc.call(b,c)};c.prototype._beforeLoad=function(a,b){a&&b!==a&&(this._query=a,this.pageIndex=
0);b&&b!==a&&b.destroy();if(a.pageSize!==this.pageSize){this._ignorePageChanged=!0;try{this.pageIndex=0,this.pageSize=a.pageSize}finally{this._ignorePageChanged=!1}}if(a.pageIndex!==this.pageIndex){this._ignorePageChanged=!0;try{this.pageIndex=a.pageIndex}finally{this._ignorePageChanged=!1}}a.isCacheValid||a._clearCache()};c.prototype._updatePermissions=function(a){this._perms=a};c.prototype._getChildToParentNames=function(a){return this._trackAssocMap[a]};c.prototype._getStrValue=function(a,b){return f.stringifyValue(a,
b.dateConversion,b.dataType,this.dbContext.serverTimezone)};c.prototype._fillFromService=function(b){b=l.extend(!1,{res:{names:[],rows:[],pageIndex:null,pageCount:null,dbSetName:this.dbSetName,totalCount:null},isPageChanged:!1,fn_beforeFillEnd:null},b);var c=this,d=b.res,e=d.names,f=d.rows||[],g=this._aspectType,h=[],k=[],u=[],m=[],n=this.isPagingEnabled,p=this.query,q=!0,r;this._onFillStart({isBegin:!0,rowCount:f.length,time:new Date,isPageChanged:b.isPageChanged});try{p&&(q=p.isClearPrevData,p.isClearCacheOnEveryLoad&&
p._clearCache(),q&&this.clear(),p._reindexCache(),1<p.loadPageCount&&n&&(r=p._getCache(),p.isIncludeTotalCount&&!l.check.isNt(d.totalCount)&&(r.totalCount=d.totalCount)));u=f.map(function(b){var d=b.k;if(!d)throw Error(a.ERRS.ERR_KEY_IS_EMPTY);var s=c._itemsByKey[d];s?c._refreshValues("",s,b.v,e,1):(r&&(s=r.getItemByKey(d)),s?c._refreshValues("",s,b.v,e,1):(b=new g(c,b,e),s=b.getItem()));return s});if(p&&(p.isIncludeTotalCount&&!l.check.isNt(d.totalCount)&&(this.totalCount=d.totalCount),1<p.loadPageCount&&
n)){r.fillCache(d.pageIndex,u);var v=r.getCachedPage(p.pageIndex),u=v?v.items:[]}u.forEach(function(a){var b=c._itemsByKey[a._aspect._key];b?m.push(b):(c._items.push(a),k.push(c._items.length-1),c._itemsByKey[a._aspect._key]=a,h.push(a),m.push(a))});0<h.length&&(this._onItemsChanged({change_type:1,items:h,pos:k}),this.raisePropertyChanged("count"));b.fn_beforeFillEnd&&b.fn_beforeFillEnd()}finally{this._onFillEnd({isBegin:!1,rowCount:m.length,time:new Date,resetUI:q,fetchedItems:m,newItems:h,isPageChanged:b.isPageChanged})}this.moveFirst();
return{fetchedItems:m,newItems:h,isPageChanged:b.isPageChanged,outOfBandData:b.res.extraInfo}};c.prototype._fillFromCache=function(b){b=l.extend(!1,{isPageChanged:!1,fn_beforeFillEnd:null},b);var c=this,d=[],e=[],f=this.query;if(!f)throw Error(l.format(a.ERRS.ERR_ASSERTION_FAILED,"query is not null"));f=(f=f._getCache().getCachedPage(f.pageIndex))?f.items:[];this._onFillStart({isBegin:!0,rowCount:f.length,time:new Date,isPageChanged:b.isPageChanged});try{this.clear(),this._items=f,f.forEach(function(a,
b){c._itemsByKey[a._aspect._key]=a;d.push(b);e.push(a)}),b.fn_beforeFillEnd&&b.fn_beforeFillEnd(),0<e.length&&(this._onItemsChanged({change_type:1,items:e,pos:d}),this.raisePropertyChanged("count"))}finally{this._onFillEnd({isBegin:!1,rowCount:e.length,time:new Date,resetUI:!0,fetchedItems:e,newItems:e,isPageChanged:b.isPageChanged})}this.moveFirst();return{fetchedItems:e,newItems:e,isPageChanged:b.isPageChanged,outOfBandData:null}};c.prototype._commitChanges=function(b){var c=this;b.forEach(function(b){var d=
b.clientKey,s=c._itemsByKey[d];if(!s)throw Error(e.format(a.ERRS.ERR_KEY_IS_NOTFOUND,d));var f=s._aspect._changeType;s._aspect.acceptChanges(b);1===f&&(delete c._itemsByKey[d],s._aspect._updateKeys(b.serverKey),c._itemsByKey[s._aspect._key]=s,c._onItemsChanged({change_type:3,items:[s],old_key:d,new_key:s._aspect._key}))})};c.prototype._setItemInvalid=function(a){var b=this._itemsByKey[a.clientKey],c={};a.invalid.forEach(function(a){a.fieldName||(a.fieldName="*");c[a.fieldName]?c[a.fieldName].push(a.message):
c[a.fieldName]=[a.message]});var d=[];l.forEachProp(c,function(a){d.push({fieldName:a,errors:c[a]})});this._addErrors(b,d);return b};c.prototype._getChanges=function(){var a=[],b=this._changeCache;l.forEachProp(b,function(c){a.push(b[c]._aspect._getRowInfo())});return a};c.prototype._getTrackAssocInfo=function(){var a=this,b=[],c=this._changeCache,d=Object.keys(a._trackAssoc);l.forEachProp(c,function(e){var f=c[e];d.forEach(function(c){var d=f._aspect._getFieldVal(a._trackAssoc[c].childToParentName),
e=f._aspect._key;d&&e&&b.push({assocName:c,parentKey:d,childKey:e})})});return b};c.prototype._addToChanged=function(a){null===a._aspect._key||this._changeCache[a._aspect._key]||(this._changeCache[a._aspect._key]=a,this._changeCount+=1,1===this._changeCount&&this.raisePropertyChanged("hasChanges"))};c.prototype._removeFromChanged=function(a){null!==a&&this._changeCache[a]&&(delete this._changeCache[a],--this._changeCount,0===this._changeCount&&this.raisePropertyChanged("hasChanges"))};c.prototype._onItemStatusChanged=
function(a,c){b.prototype._onItemStatusChanged.call(this,a,c);a._aspect._isDeleted&&this.isSubmitOnDelete&&this.dbContext.submitChanges()};c.prototype._onRemoved=function(a,c){this._removeFromChanged(a._aspect._key);b.prototype._onRemoved.call(this,a,c)};c.prototype.getFieldInfo=function(b){var c,d=b.split(".");c=this._fieldMap[d[0]];if(1==d.length)return c;if(5==c.fieldType){for(b=1;b<d.length;b+=1)c=h.fn_getPropertyByName(d[b],c.nested);return c}if(3==c.fieldType&&(c=this._childAssocMap[c.fieldName]))return b=
this.dbContext.getDbSet(c.parentDbSetName),b.getFieldInfo(d.slice(1).join("."));throw Error(e.format(a.ERRS.ERR_DBSET_INVALID_FIELDNAME,this.dbSetName,b));};c.prototype.sort=function(a,c){var d=this.query;if(d){d.clearSort();for(var e=0;e<a.length;e+=1)0==e?d.orderBy(a[e],c):d.thenBy(a[e],c);d.isClearPrevData=!0;d.pageIndex=0;return this.dbContext.load(d)}return b.prototype.sort.call(this,a,c)};c.prototype.fillItems=function(a){a={res:l.extend(!1,{names:[],rows:[],pageIndex:this.query?this.query.pageIndex:
null,pageCount:null,dbSetName:this.dbSetName,totalCount:null,rowCount:a.rows.length,extraInfo:null,error:null,included:[]},a),isPageChanged:!1,fn_beforeFillEnd:null};this._fillFromService(a)};c.prototype.acceptChanges=function(){var a=this._changeCache;l.forEachProp(a,function(b){a[b]._aspect.acceptChanges(null)});this._changeCount=0};c.prototype.rejectChanges=function(){var a=this._changeCache;l.forEachProp(a,function(b){a[b]._aspect.rejectChanges()})};c.prototype.deleteOnSubmit=function(a){a._aspect.deleteOnSubmit()};
c.prototype.clear=function(){this._clearChangeCache();b.prototype.clear.call(this)};c.prototype.createQuery=function(b){var c=this.dbContext._getQueryInfo(b);if(!c)throw Error(e.format(a.ERRS.ERR_QUERY_NAME_NOTFOUND,b));return new C(this,c)};c.prototype.clearCache=function(){var a=this._query;a&&a._clearCache()};c.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;var a=this._query;this._query=null;a&&a.destroy();this._navfldMap={};this._calcfldMap={};b.prototype.destroy.call(this)}};
c.prototype.toString=function(){return this._options.dbSetName};Object.defineProperty(c.prototype,"items",{get:function(){return this._items},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"dbContext",{get:function(){return this._dbContext},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"dbSetName",{get:function(){return this._options.dbSetName},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"entityType",{get:function(){return this._entityType},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"query",{get:function(){return this._query},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"hasChanges",{get:function(){return 0<this._changeCount},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"cacheSize",{get:function(){var a=this._query;return a&&a.isCacheValid?(a=a._getCache(),a.cacheSize):0},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isSubmitOnDelete",{get:function(){return this._isSubmitOnDelete},
set:function(a){this._isSubmitOnDelete!==a&&(this._isSubmitOnDelete=!!a,this.raisePropertyChanged("isSubmitOnDelete"))},enumerable:!0,configurable:!0});return c}(h.BaseCollection);m.DbSet=w;w=function(b){function c(a){b.call(this);this._dbContext=a;this._arrDbSets=[];this._dbSets={};this._dbSetNames=[]}__extends(c,b);c.prototype._dbSetCreated=function(a){var b=this;this._arrDbSets.push(a);a.addOnPropertyChange("hasChanges",function(a,c){b._dbContext._onDbSetHasChangesChanged(a)},null)};c.prototype._createDbSet=
function(a,b){var c=this,d=this._dbContext;c._dbSets[a]=function(){var e=new b(d);c._dbSets[a]=function(){return e};c._dbSetCreated(e);return e}};Object.defineProperty(c.prototype,"dbSetNames",{get:function(){return this._dbSetNames},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"arrDbSets",{get:function(){return this._arrDbSets},enumerable:!0,configurable:!0});c.prototype.getDbSet=function(b){var c=this._dbSets[b];if(!c)throw Error(e.format(a.ERRS.ERR_DBSET_NAME_INVALID,b));return c()};
c.prototype.destroy=function(){this._arrDbSets.forEach(function(a){a.destroy()});this._arrDbSets=[];this._dbContext=this._dbSets=null;b.prototype.destroy.call(this)};return c}(a.BaseObject);m.DbSets=w;w=function(c){function d(){c.call(this);this._isInitialized=!1;this._dbSets=null;this._svcMethods={};this._assoc={};this._arrAssoc=[];this._queryInf={};this._serviceUrl=null;this._isBusy=0;this._hasChanges=this._isSubmiting=!1;this._pendingSubmit=null;this._serverTimezone=l.get_timeZoneOffset();this._waitQueue=
new g.WaitQueue(this)}__extends(d,c);d.prototype._getEventNames=function(){var a=c.prototype._getEventNames.call(this);return["submit_error"].concat(a)};d.prototype._onGetCalcField=function(a){this.raiseEvent("define_calc",a)};d.prototype._initDbSets=function(){if(this._isInitialized)throw Error(a.ERRS.ERR_DOMAIN_CONTEXT_INITIALIZED);};d.prototype._initAssociations=function(a){var b=this;a.forEach(function(a){b._initAssociation(a)})};d.prototype._initMethods=function(a){var b=this;a.forEach(function(a){a.isQuery?
b._queryInf[a.methodName]=a:b._initMethod(a)})};d.prototype._updatePermissions=function(a){var b=this;this._serverTimezone=a.serverTimezone;a.permissions.forEach(function(a){b.getDbSet(a.dbSetName)._updatePermissions(a)})};d.prototype._initAssociation=function(a){var b=this,c={dbContext:b,parentName:a.parentDbSetName,childName:a.childDbSetName,onDeleteAction:a.onDeleteAction,parentKeyFields:a.fieldRels.map(function(a){return a.parentField}),childKeyFields:a.fieldRels.map(function(a){return a.childField}),
parentToChildrenName:a.parentToChildrenName,childToParentName:a.childToParentName,name:a.name},d="get"+a.name;this._assoc[d]=function(){var a=new y(c);b._arrAssoc.push(a);b._assoc[d]=function(){return a};return a}};d.prototype._initMethod=function(b){var c=this;this._svcMethods[b.methodName]=function(d){var e=l.createDeferred(),f=function(a){a.error?e.reject():e.resolve(a.result)};try{var g=c._getMethodParams(b,d);c._invokeMethod(b,g,f)}catch(h){a.global._checkIsDummy(h)||(c.handleError(h,c),f({result:null,
error:h}))}return e.promise()}};d.prototype._getMethodParams=function(b,c){var d={methodName:b.methodName,paramInfo:{parameters:[]}},e,g=b.parameters,h=g.length,k,m;c||(c={});for(e=0;e<h;e+=1){k=g[e];m=c[k.name];if(!k.isNullable&&!k.isArray&&1!=k.dataType&&10!=k.dataType&&l.check.isNt(m))throw Error(l.format(a.ERRS.ERR_SVC_METH_PARAM_INVALID,k.name,m,b.methodName));if(l.check.isFunction(m))throw Error(l.format(a.ERRS.ERR_SVC_METH_PARAM_INVALID,k.name,m,b.methodName));!k.isArray||l.check.isNt(m)||
l.check.isArray(m)||(m=[m]);if(10==k.dataType&&l.check.isArray(m))m=JSON.stringify(m);else if(l.check.isArray(m)){for(var n=Array(m.length),u=0;u<m.length;u+=1)n[u]=f.stringifyValue(m[u],k.dateConversion,k.dataType,this._serverTimezone);m=JSON.stringify(n)}else m=f.stringifyValue(m,k.dateConversion,k.dataType,this._serverTimezone);d.paramInfo.parameters.push({name:k.name,value:m})}return d};d.prototype._invokeMethod=function(b,c,d){var e=this,f,g,h=function(b){try{if(!b)throw Error(l.format(a.ERRS.ERR_UNEXPECTED_SVC_ERROR,
"operation result is undefined"));n(b.error,2);d({result:b.result,error:null})}catch(c){a.global._checkIsDummy(c)||(e._onDataOperError(c,2),d({result:null,error:c}))}};this.isBusy=!0;try{f=JSON.stringify(c),g=this._getUrl("invoke"),l.performAjaxCall(g,f,!0,function(a){h(JSON.parse(a));e.isBusy=!1},function(a){h({result:null,error:a});e.isBusy=!1},null)}catch(k){a.global._checkIsDummy(k)&&a.global._throwDummy(k),this.isBusy=!1,this._onDataOperError(k,2),d({result:null,error:k}),a.global._throwDummy(k)}};
d.prototype._loadFromCache=function(b,c){var d=b.dbSet,e;try{e=d._fillFromCache({isPageChanged:c,fn_beforeFillEnd:null})}catch(f){a.global._checkIsDummy(f)&&a.global._throwDummy(f),this._onDataOperError(f,1),a.global._throwDummy(f)}return e};d.prototype._loadIncluded=function(a){var b=this;a.included&&0<a.included.length&&a.included.forEach(function(a){b.getDbSet(a.dbSetName).fillItems(a)})};d.prototype._onLoaded=function(b,c){var d=this,f,g,h;try{if(!b)throw Error(e.format(a.ERRS.ERR_UNEXPECTED_SVC_ERROR,
"null result"));f=b.dbSetName;g=d.getDbSet(f);if(!g)throw Error(e.format(a.ERRS.ERR_DBSET_NAME_INVALID,f));n(b.error,1);h=g._fillFromService({res:b,isPageChanged:c,fn_beforeFillEnd:function(){d._loadIncluded(b)}})}catch(l){a.global._checkIsDummy(l)&&a.global._throwDummy(l),this._onDataOperError(l,1),a.global._throwDummy(l)}return h};d.prototype._dataSaved=function(b){var c=this,d=[],f=[];try{try{n(b.error,0)}catch(g){throw b.dbSets.forEach(function(b){var s=c._dbSets.getDbSet(b.dbSetName);b.rows.forEach(function(b){var c=
s.getItemByKey(b.clientKey);if(!c)throw Error(e.format(a.ERRS.ERR_KEY_IS_NOTFOUND,b.clientKey));d.push(c);b.invalid&&(s._setItemInvalid(b),f.push(c))})}),new B(g,d,f);}b.dbSets.forEach(function(a){c._dbSets.getDbSet(a.dbSetName)._commitChanges(a.rows)})}catch(h){a.global._checkIsDummy(h)&&a.global._throwDummy(h),this._onSubmitError(h),a.global._throwDummy(h)}};d.prototype._getChanges=function(){var a={dbSets:[],error:null,trackAssocs:[]};this._dbSets.arrDbSets.forEach(function(b){b.endEdit();var c=
b._getChanges();if(0!==c.length){var d=b._getTrackAssocInfo();a.dbSets.push({dbSetName:b.dbSetName,rows:c});a.trackAssocs=a.trackAssocs.concat(d)}});return a};d.prototype._getUrl=function(a){var b=this.service_url;l.str.endsWith(b,"/")||(b+="/");return b+=[a,""].join("/")};d.prototype.handleError=function(b,d){var e=c.prototype.handleError.call(this,b,d);return e?e:a.global.handleError(b,d)};d.prototype._onDataOperError=function(c,d){if(a.global._checkIsDummy(c))return!0;var e;e=c instanceof b?c:
new b(c,d);return this.handleError(e,this)};d.prototype._onSubmitError=function(a){var b={error:a,isHandled:!1};this.raiseEvent("submit_error",b);b.isHandled||(this.rejectChanges(),this._onDataOperError(a,0))};d.prototype.waitForNotBusy=function(a,b){this._waitQueue.enQueue({prop:"isBusy",groupName:null,predicate:function(a){return!a},action:a,actionArgs:b})};d.prototype.waitForNotSubmiting=function(a,b,c){this._waitQueue.enQueue({prop:"isSubmiting",predicate:function(a){return!a},action:a,actionArgs:b,
groupName:c,lastWins:!!c})};d.prototype.waitForInitialized=function(a,b){this._waitQueue.enQueue({prop:"isInitialized",groupName:"dbContext",predicate:function(a){return!!a},action:a,actionArgs:b})};d.prototype.initialize=function(b){if(!this._isInitialized){var c=this;b=l.extend(!1,{serviceUrl:null,permissions:null},b);var d,e;try{if(!l.check.isString(b.serviceUrl))throw Error(l.format(a.ERRS.ERR_PARAM_INVALID,"serviceUrl",b.serviceUrl));this._serviceUrl=b.serviceUrl;this._initDbSets();if(b.permissions){c._updatePermissions(b.permissions);
c._isInitialized=!0;c.raisePropertyChanged("isInitialized");return}d=this._getUrl("permissions");e=4}catch(f){this.handleError(f,this),a.global._throwDummy(f)}try{this.isBusy=!0,l.performAjaxGet(d).done(function(b){try{c._updatePermissions(JSON.parse(b)),c.isBusy=!1,c._isInitialized=!0,c.raisePropertyChanged("isInitialized")}catch(d){c.isBusy=!1,c._onDataOperError(d,e),a.global._throwDummy(d)}}).fail(function(a){c.isBusy=!1;c._onDataOperError(a,e)})}catch(g){this.isBusy=!1,this._onDataOperError(g,
e),a.global._throwDummy(g)}}};d.prototype.addOnSubmitError=function(a,b){this.addHandler("submit_error",a,b)};d.prototype.removeOnSubmitError=function(a){this.removeHandler("submit_error",a)};d.prototype._onItemRefreshed=function(b,c){try{if(n(b.error,3),b.rowInfo)c._aspect._refreshValues(b.rowInfo,2);else throw c._aspect._dbSet.removeItem(c),c._aspect.destroy(),Error(a.ERRS.ERR_ITEM_DELETED_BY_ANOTHER_USER);}catch(d){a.global._checkIsDummy(d)&&a.global._throwDummy(d),this._onDataOperError(d,3),a.global._throwDummy(d)}};
d.prototype._refreshItem=function(a){var b=l.createDeferred(),c=function(c){c?b.resolve(a):b.reject()},d=this._getUrl("refresh"),e=a._aspect._dbSet,f=this;this.waitForNotSubmiting(function(){e.waitForNotLoading(function(){var b,g=function(){f.isBusy=!1;e.isLoading=!1;a._aspect._isRefreshing=!1},h=function(a){g();f._onDataOperError(a,3)};a._aspect._isRefreshing=!0;f.isBusy=!0;e.isLoading=!0;try{var k={dbSetName:a._aspect._dbSetName,rowInfo:a._aspect._getRowInfo(),error:null};a._aspect._checkCanRefresh();
b=JSON.stringify(k);l.performAjaxCall(d,b,!0,function(b){try{var d=JSON.parse(b);f._onItemRefreshed(d,a);g();c(!0)}catch(e){h(e),c(!1)}},function(a){g();f._onDataOperError(a,3);c(!1)},null)}catch(x){h(x),c(!1)}},[],!0,null)},[],null);return b.promise()};d.prototype._getQueryInfo=function(a){return this._queryInf[a]};d.prototype._onDbSetHasChangesChanged=function(a){var b=this._hasChanges;this._hasChanges=!1;if(a.hasChanges)this._hasChanges=!0;else for(var c=0,d=this._dbSets.arrDbSets.length;c<d;c+=
1)if(a=this._dbSets.arrDbSets[c],a.hasChanges){this._hasChanges=!0;break}this._hasChanges!==b&&this.raisePropertyChanged("hasChanges")};d.prototype._load=function(b,c){if(!b)throw Error(a.ERRS.ERR_DB_LOAD_NO_QUERY);var d=this,e=l.createDeferred(),f=b.loadPageCount,g=b.pageIndex,h=b.isPagingEnabled,k=b.dbSetName,m=this.getDbSet(k);this.waitForNotSubmiting(function(){m.waitForNotLoading(function(){var n=m.query,u=d._getUrl("query"),q,r,v=function(){m.isLoading=!1;d.isBusy=!1},w=function(a){v();e.resolve(a)},
E=function(a){v();d._onDataOperError(a,1);e.reject()},D,y,A=1;m.isLoading=!0;d.isBusy=!0;try{b.pageIndex=g;m._beforeLoad(b,n);if(1<f&&h){if(b._isPageCached(g)){D=d._loadFromCache(b,c);w(D);return}y=b._getCache().getNextRange(g);g=y.start;A=y.cnt}q={dbSetName:k,pageIndex:g,pageSize:b.pageSize,pageCount:A,isIncludeTotalCount:b.isIncludeTotalCount,filterInfo:b.filterInfo,sortInfo:b.sortInfo,paramInfo:d._getMethodParams(b._queryInfo,b.params).paramInfo,queryName:b.queryName};r=JSON.stringify(q);l.performAjaxCall(u,
r,!0,function(b){var e=[],f,g;try{(f=b.match(p))?(g=parseInt(f[1]),e.push(b.substr(f[0].length,g)),e.push(b.substr(f[0].length+g))):e.push(b);var s=e.map(function(a){return JSON.parse(a)}),e=null;setTimeout(function(){var b,e=s[0],f=!!e.included&&0<e.included.length;try{if(1<s.length&&(b=s[1])&&0<b.length&&(f&&e.included.forEach(function(c){c.rows=b.splice(0,c.rowCount);if(c.rowCount!=c.rows.length)throw Error(l.format(a.ERRS.ERR_ASSERTION_FAILED,"subset.rowCount == subset.rows.length"));}),e.rows=
b,e.rowCount!=e.rows.length))throw Error(l.format(a.ERRS.ERR_ASSERTION_FAILED,"getDataResult.rowCount == getDataResult.rows.length"));D=d._onLoaded(e,c);w(D)}catch(g){E(g)}},0)}catch(h){E(h)}},function(a){v();d._onDataOperError(a,1);e.reject()},null)}catch(B){E(B)}},[],!0,c?"paging":null)},[],c?"paging":null);return e.promise()};d.prototype.getDbSet=function(a){return this._dbSets.getDbSet(a)};d.prototype.getAssociation=function(b){var c=this._assoc["get"+b];if(!c)throw Error(e.format(a.ERRS.ERR_ASSOC_NAME_INVALID,
b));return c()};d.prototype.submitChanges=function(){if(this._pendingSubmit)return this._pendingSubmit.deferred.promise();var a=this,b={deferred:l.createDeferred()},c=function(a){a?b.deferred.resolve():b.deferred.reject()};this._pendingSubmit=b;this.waitForNotBusy(function(){var b,d,e,f=function(){a.isBusy=!1;a.isSubmiting=!1},g=function(b){f();a._onDataOperError(b,0);c(!1)};try{if(a.isBusy=!0,a.isSubmiting=!0,a._pendingSubmit=null,b=a._getUrl("save"),e=a._getChanges(),0===e.dbSets.length){f();c(!0);
return}}catch(h){g(h);return}try{d=JSON.stringify(e),l.performAjaxCall(b,d,!0,function(b){try{a._dataSaved(JSON.parse(b)),f(),c(!0)}catch(d){g(d)}},function(b){f();a._onSubmitError(b);c(!1)},null)}catch(k){g(k)}},[]);return b.deferred.promise()};d.prototype.load=function(a){return this._load(a,!1)};d.prototype.acceptChanges=function(){this._dbSets.arrDbSets.forEach(function(a){a.acceptChanges()})};d.prototype.rejectChanges=function(){this._dbSets.arrDbSets.forEach(function(a){a.rejectChanges()})};
d.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._waitQueue.destroy(),this._waitQueue=null,this._arrAssoc.forEach(function(a){a.destroy()}),this._arrAssoc=[],this._assoc={},this._dbSets.destroy(),this._dbSets=null,this._svcMethods={},this._queryInf={},this._serviceUrl=null,this._isInitialized=!1,this._isBusy=0,this._hasChanges=this._isSubmiting=!1,c.prototype.destroy.call(this))};Object.defineProperty(d.prototype,"service_url",{get:function(){return this._serviceUrl},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isInitialized",{get:function(){return this._isInitialized},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isBusy",{get:function(){return 0<this._isBusy},set:function(a){var b=0<this._isBusy;a?this._isBusy+=1:(--this._isBusy,0>this._isBusy&&(this._isBusy=0));0<this._isBusy!=b&&this.raisePropertyChanged("isBusy")},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isSubmiting",{get:function(){return this._isSubmiting},
set:function(a){this._isSubmiting!==a&&(this._isSubmiting=a,this.raisePropertyChanged("isSubmiting"))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"serverTimezone",{get:function(){return this._serverTimezone},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"dbSets",{get:function(){return this._dbSets},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"serviceMethods",{get:function(){return this._svcMethods},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"hasChanges",{get:function(){return this._hasChanges},enumerable:!0,configurable:!0});return d}(a.BaseObject);m.DbContext=w;var y=function(b){function c(a){b.call(this);var d=this;this._objId="ass"+l.getNewID();a=l.extend(!1,{dbContext:null,parentName:"",childName:"",parentKeyFields:[],childKeyFields:[],parentToChildrenName:null,childToParentName:null,name:this._objId,onDeleteAction:0},a);this._name=a.name;this._dbContext=a.dbContext;this._onDeleteAction=a.onDeleteAction;this._parentDS=a.dbContext.getDbSet(a.parentName);
this._childDS=a.dbContext.getDbSet(a.childName);this._parentFldInfos=a.parentKeyFields.map(function(a){return d._parentDS.getFieldInfo(a)});this._childFldInfos=a.childKeyFields.map(function(a){return d._childDS.getFieldInfo(a)});this._parentToChildrenName=a.parentToChildrenName;this._childToParentName=a.childToParentName;this._parentMap={};this._childMap={};this._isChildFilling=this._isParentFilling=!1;this._bindParentDS();a=this._mapParentItems(this._parentDS.items);this._bindChildDS();var e=this._mapChildren(this._childDS.items);
this._changedTimeout=this._saveChildFKey=this._saveParentFKey=null;this._changed={};d._notifyParentChanged(a);d._notifyChildrenChanged(e)}__extends(c,b);c.prototype.handleError=function(c,d){var e=b.prototype.handleError.call(this,c,d);return e?e:a.global.handleError(c,d)};c.prototype._bindParentDS=function(){var a=this,b=this._parentDS;b&&(b.addHandler("coll_changed",function(c,d){b===c&&a._onParentCollChanged(d)},a._objId,!0),b.addHandler("fill",function(c,d){b===c&&a._onParentFill(d)},a._objId,
!0),b.addHandler("begin_edit",function(c,d){b===c&&a._onParentEdit(d.item,!0,void 0)},a._objId,!0),b.addHandler("end_edit",function(c,d){b===c&&a._onParentEdit(d.item,!1,d.isCanceled)},a._objId,!0),b.addHandler("item_deleting",function(a,b){},a._objId,!0),b.addHandler("status_changed",function(c,d){b===c&&a._onParentStatusChanged(d.item,d.oldChangeType)},a._objId,!0),b.addHandler("commit_changes",function(c,d){b===c&&a._onParentCommitChanges(d.item,d.isBegin,d.isRejected,d.changeType)},a._objId,!0))};
c.prototype._bindChildDS=function(){var a=this,b=this._childDS;b&&(b.addHandler("coll_changed",function(c,d){b===c&&a._onChildCollChanged(d)},a._objId,!0),b.addHandler("fill",function(c,d){b===c&&a._onChildFill(d)},a._objId,!0),b.addHandler("begin_edit",function(c,d){b===c&&a._onChildEdit(d.item,!0,void 0)},a._objId,!0),b.addHandler("end_edit",function(c,d){b===c&&a._onChildEdit(d.item,!1,d.isCanceled)},a._objId,!0),b.addHandler("status_changed",function(c,d){b===c&&a._onChildStatusChanged(d.item,
d.oldChangeType)},a._objId,!0),b.addHandler("commit_changes",function(c,d){b===c&&a._onChildCommitChanges(d.item,d.isBegin,d.isRejected,d.changeType)},a._objId,!0))};c.prototype._onParentCollChanged=function(b){var c=this,d;d=b.items;var f=[],g={};switch(b.change_type){case 2:c._isParentFilling||(f=c.refreshParentMap());break;case 1:this._isParentFilling||(f=c._mapParentItems(d));break;case 0:d.forEach(function(a){(a=c._unMapParentItem(a))&&(g[a]=null)});f=Object.keys(g);break;case 3:b.old_key&&(d=
this._parentMap[b.old_key])&&(delete this._parentMap[b.old_key],f=this._mapParentItems([d]));break;default:throw Error(e.format(a.ERRS.ERR_COLLECTION_CHANGETYPE_INVALID,b.change_type));}c._notifyParentChanged(f)};c.prototype._onParentFill=function(a){a.isBegin?this._isParentFilling=!0:(this._isParentFilling=!1,a=a.resetUI?this.refreshParentMap():this._mapParentItems(a.newItems),this._notifyParentChanged(a))};c.prototype._onParentEdit=function(a,b,c){b?this._storeParentFKey(a):c?this._saveParentFKey=
null:this._checkParentFKey(a)};c.prototype._onParentCommitChanges=function(a,b,c,d){b?c&&1===d?(a=this._unMapParentItem(a))&&this._notifyParentChanged([a]):c||3!==d?this._storeParentFKey(a):(a=this._unMapParentItem(a))&&this._notifyParentChanged([a]):this._checkParentFKey(a)};c.prototype._storeParentFKey=function(a){a=this.getParentFKey(a);null!==a&&this._parentMap[a]&&(this._saveParentFKey=a)};c.prototype._checkParentFKey=function(a){var b,c=this._saveParentFKey;this._saveParentFKey=null;b=this.getParentFKey(a);
b!==c&&(c&&(delete this._parentMap[c],this._notifyChildrenChanged([c]),this._notifyParentChanged([c])),b&&(this._mapParentItems([a]),this._notifyChildrenChanged([b]),this._notifyParentChanged([b])))};c.prototype._onParentStatusChanged=function(a,b){var c=this,d,e;if(3===a._aspect._changeType){e=c.getChildItems(a);d=this._unMapParentItem(a);switch(c.onDeleteAction){case 1:e.forEach(function(a){a._aspect.deleteItem()});break;case 2:e.forEach(function(a){var b=a._aspect.isEditing;b||a._aspect.beginEdit();
try{c._childFldInfos.forEach(function(b){a[b.fieldName]=null}),b||a._aspect.endEdit()}finally{b||a._aspect.cancelEdit()}})}d&&c._notifyParentChanged([d])}};c.prototype._onChildCollChanged=function(b){var c=this,d=b.items,f=[],g={};switch(b.change_type){case 2:c._isChildFilling||(f=c.refreshChildMap());break;case 1:this._isChildFilling||(f=c._mapChildren(d));break;case 0:d.forEach(function(a){(a=c._unMapChildItem(a))&&(g[a]=null)});f=Object.keys(g);break;case 3:if(b.old_key&&(b=d[0])){if(f=b._aspect._getFieldVal(this._childToParentName))delete this._childMap[f],
b._aspect._clearFieldVal(this._childToParentName);f=this._mapChildren([b])}break;default:throw Error(e.format(a.ERRS.ERR_COLLECTION_CHANGETYPE_INVALID,b.change_type));}c._notifyChildrenChanged(f)};c.prototype._notifyChildrenChanged=function(a){this._notifyChanged([],a)};c.prototype._notifyParentChanged=function(a){this._notifyChanged(a,[])};c.prototype._notifyChanged=function(a,b){var c=this;if(0<a.length||0<b.length)a.forEach(function(a){var b=c._changed[a];c._changed[a]=b?b|1:1}),b.forEach(function(a){var b=
c._changed[a];c._changed[a]=b?b|2:2}),this._changedTimeout||(this._changedTimeout=setTimeout(function(){if(!c._isDestroyCalled){c._changedTimeout=null;var a=c._changed;c._changed={};Object.keys(a).forEach(function(b){var d=a[b];1==(d&1)&&c._onParentChanged(b);2==(d&2)&&c._onChildrenChanged(b)})}},50))};c.prototype._onChildFill=function(a){a.isBegin?this._isChildFilling=!0:(this._isChildFilling=!1,a=a.resetUI?this.refreshChildMap():this._mapChildren(a.newItems),this._notifyChildrenChanged(a))};c.prototype._onChildEdit=
function(a,b,c){b?this._storeChildFKey(a):c?this._saveChildFKey=null:this._checkChildFKey(a)};c.prototype._onChildCommitChanges=function(a,b,c,d){b?c&&1===d?(a=this._unMapChildItem(a))&&this._notifyChildrenChanged([a]):c||3!==d?this._storeChildFKey(a):(a=this._unMapChildItem(a))&&this._notifyChildrenChanged([a]):this._checkChildFKey(a)};c.prototype._storeChildFKey=function(a){var b=this.getChildFKey(a),c;b&&(c=this._childMap[b])&&-1<c.indexOf(a)&&(this._saveChildFKey=b)};c.prototype._checkChildFKey=
function(a){var b=this._saveChildFKey,c,d;this._saveChildFKey=null;c=this.getChildFKey(a);c!==b&&(b&&(d=this._childMap[b],l.removeFromArray(d,a),0==d.length&&delete this._childMap[b],this._notifyParentChanged([b]),this._notifyChildrenChanged([b])),c&&(this._mapChildren([a]),this._notifyParentChanged([c]),this._notifyChildrenChanged([c])))};c.prototype._onChildStatusChanged=function(a,b){var c=a._aspect._changeType,d=this.getChildFKey(a);d&&3===c&&(d=this._unMapChildItem(a))&&this._notifyChildrenChanged([d])};
c.prototype._getItemKey=function(a,b,c){for(var d=[],e,f=0,g=a.length;f<g;f+=1){e=c[a[f].fieldName];e=b._getStrValue(e,a[f]);if(null===e)return null;d.push(e)}return d.join(";")};c.prototype._resetChildMap=function(){var a=Object.keys(this._childMap);this._childMap={};this._notifyChildrenChanged(a)};c.prototype._resetParentMap=function(){var a=Object.keys(this._parentMap);this._parentMap={};this._notifyParentChanged(a)};c.prototype._unMapChildItem=function(a){var b,c,d=null;if(b=this.getChildFKey(a))if(c=
this._childMap[b])a=l.removeFromArray(c,a),-1<a&&(0==c.length&&delete this._childMap[b],d=b);return d};c.prototype._unMapParentItem=function(a){var b=null;(a=this.getParentFKey(a))&&this._parentMap[a]&&(delete this._parentMap[a],b=a);return b};c.prototype._mapParentItems=function(a){for(var b,c,d,e={},f=0,g=a.length;f<g;f+=1)if(b=a[f],c=b._aspect._changeType,3!==c&&(c=this.getParentFKey(b)))d=this._parentMap[c],d!==b&&(this._parentMap[c]=b,e[c]=null);return Object.keys(e)};c.prototype._onChildrenChanged=
function(a){a&&this._parentToChildrenName&&(a=this._parentMap[a])&&a.raisePropertyChanged(this._parentToChildrenName)};c.prototype._onParentChanged=function(a){var b=this;a&&this._childToParentName&&(a=this._childMap[a])&&a.forEach(function(a){a.raisePropertyChanged(b._childToParentName)})};c.prototype._mapChildren=function(a){for(var b,c,d,e={},f=0,g=a.length;f<g;f+=1)if(b=a[f],c=b._aspect._changeType,3!==c&&(c=this.getChildFKey(b)))d=this._childMap[c],d||(d=[],this._childMap[c]=d),0>d.indexOf(b)&&
(d.push(b),e[c]||(e[c]=null));return Object.keys(e)};c.prototype._unbindParentDS=function(){var a=this.parentDS;a&&a.removeNSHandlers(this._objId)};c.prototype._unbindChildDS=function(){var a=this.childDS;a&&a.removeNSHandlers(this._objId)};c.prototype.getParentFKey=function(a){return a&&a._aspect._isNew?a._aspect._key:this._getItemKey(this._parentFldInfos,this._parentDS,a)};c.prototype.getChildFKey=function(a){if(a&&this._childToParentName){var b=a._aspect._getFieldVal(this._childToParentName);if(b)return b}return this._getItemKey(this._childFldInfos,
this._childDS,a)};c.prototype.getChildItems=function(a){if(!a)return[];a=this.getParentFKey(a);return(a=this._childMap[a])?a:[]};c.prototype.getParentItem=function(a){if(!a)return null;a=this.getChildFKey(a);return(a=this._parentMap[a])?a:null};c.prototype.refreshParentMap=function(){this._resetParentMap();return this._mapParentItems(this._parentDS.items)};c.prototype.refreshChildMap=function(){this._resetChildMap();return this._mapChildren(this._childDS.items)};c.prototype.destroy=function(){this._isDestroyed||
(this._isDestroyCalled=!0,clearTimeout(this._changedTimeout),this._changedTimeout=null,this._changed={},this._unbindParentDS(),this._unbindChildDS(),this._childFldInfos=this._parentFldInfos=this._childMap=this._parentMap=null,b.prototype.destroy.call(this))};c.prototype.toString=function(){return this._name};Object.defineProperty(c.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"parentToChildrenName",{get:function(){return this._parentToChildrenName},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"childToParentName",{get:function(){return this._childToParentName},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"parentDS",{get:function(){return this._parentDS},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"childDS",{get:function(){return this._childDS},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"parentFldInfos",{get:function(){return this._parentFldInfos},enumerable:!0,
configurable:!0});Object.defineProperty(c.prototype,"childFldInfos",{get:function(){return this._childFldInfos},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"onDeleteAction",{get:function(){return this._onDeleteAction},enumerable:!0,configurable:!0});return c}(a.BaseObject);m.Association=y;w=function(b){function c(d){b.call(this);d=l.extend(!1,{dataSource:null,fn_filter:null,fn_sort:null,fn_itemsProvider:null},d);if(!(d.dataSource&&d.dataSource instanceof h.BaseCollection))throw Error(a.ERRS.ERR_DATAVIEW_DATASRC_INVALID);
if(!d.fn_filter||!l.check.isFunction(d.fn_filter))throw Error(a.ERRS.ERR_DATAVIEW_FILTER_INVALID);this._objId="dvw"+l.getNewID();this._dataSource=d.dataSource;this._fn_filter=d.fn_filter;this._fn_sort=d.fn_sort;this._fn_itemsProvider=d.fn_itemsProvider;this._isAddingNew=this._isDSFilling=!1;var e=this,f=this._dataSource;f.getFieldNames().forEach(function(a){e._fieldMap[a]=l.extend(!1,{},f.getFieldInfo(a))});this._bindDS()}__extends(c,b);c.prototype._getEventNames=function(){var a=b.prototype._getEventNames.call(this);
return["view_refreshed"].concat(a)};c.prototype.addOnViewRefreshed=function(a,b){this.addHandler("view_refreshed",a,b)};c.prototype.removeOnViewRefreshed=function(a){this.removeHandler("view_refreshed",a)};c.prototype._filterForPaging=function(a){var b=0,c=0,d=-1,e=-1,f=[],b=this.pageSize*this.pageIndex,c=this.pageSize;a.forEach(function(a){e+=1;e<b||(d+=1,d<c&&f.push(a))});return f};c.prototype._onViewRefreshed=function(a){this.raiseEvent("view_refreshed",a)};c.prototype._clear=function(a){this.cancelEdit();
this._EditingItem=null;this._newKey=0;this.currentItem=null;this._items=[];this._itemsByKey={};this._errors={};this._onItemsChanged({change_type:2,items:[]});a||(this.pageIndex=0);this.raisePropertyChanged("count")};c.prototype._refresh=function(a){var b;if(b=this._dataSource)b=this._fn_itemsProvider?this._fn_itemsProvider(b):b.items,this._fn_filter&&(b=b.filter(this._fn_filter)),this._fn_sort&&(b=b.sort(this._fn_sort)),this._fillItems({items:b,isPageChanged:!!a,clear:!0,isAppend:!1}),this._onViewRefreshed({})};
c.prototype._fillItems=function(a){a=l.extend(!1,{items:[],isPageChanged:!1,clear:!0,isAppend:!1},a);var b=this,c,d=[],e=[],f=[];this._onFillStart({isBegin:!0,rowCount:a.items.length,time:new Date,isPageChanged:a.isPageChanged});try{a.clear&&this._clear(a.isPageChanged),c=this.isPagingEnabled&&!a.isAppend?this._filterForPaging(a.items):a.items,c.forEach(function(a){var c=b._itemsByKey[a._aspect._key];c?f.push(c):(b._itemsByKey[a._aspect._key]=a,d.push(a),e.push(b._items.length-1),b._items.push(a),
f.push(a))}),0<d.length&&(this._onItemsChanged({change_type:1,items:d,pos:e}),this.raisePropertyChanged("count"))}finally{this._onFillEnd({isBegin:!1,rowCount:f.length,time:new Date,resetUI:!!a.clear,fetchedItems:f,newItems:d,isPageChanged:a.isPageChanged})}this.totalCount=a.clear?a.items.length:this.totalCount+d.length;this.moveFirst();return d};c.prototype._onDSCollectionChanged=function(b){var c=this,d;d=b.items;switch(b.change_type){case 2:this._isDSFilling||this._refresh(!1);break;case 1:this._isAddingNew||
this._isDSFilling||(c._fn_filter&&(d=d.filter(c._fn_filter)),c.appendItems(d));break;case 0:d.forEach(function(a){(a=c._itemsByKey[a._aspect._key])&&c.removeItem(a)});break;case 3:if(d=c._itemsByKey[b.old_key])delete c._itemsByKey[b.old_key],c._itemsByKey[b.new_key]=d,this._onItemsChanged(b);break;default:throw Error(e.format(a.ERRS.ERR_COLLECTION_CHANGETYPE_INVALID,b.change_type));}};c.prototype._onDSFill=function(a){var b=a.fetchedItems;a.isBegin?this._isDSFilling=!0:(this._isDSFilling=!1,a.resetUI?
this._refresh(!1):(this._fn_filter&&(b=b.filter(this._fn_filter)),this.appendItems(b)))};c.prototype._onDSStatusChanged=function(a){var b=a.item,c=a.oldChangeType,d=!!this._fn_filter;this._itemsByKey[a.key]?(this._onItemStatusChanged(b,c),d&&((a=this._fn_filter(b))||this.removeItem(b))):d&&(a=this._fn_filter(b))&&this.appendItems([b])};c.prototype._bindDS=function(){var a=this,b=this._dataSource;b&&(b.addHandler("coll_changed",function(c,d){b===c&&a._onDSCollectionChanged(d)},a._objId),b.addHandler("fill",
function(c,d){b===c&&a._onDSFill(d)},a._objId),b.addHandler("begin_edit",function(c,d){b===c&&a._itemsByKey[d.item._key]&&a._onEditing(d.item,!0,!1)},a._objId),b.addHandler("end_edit",function(c,d){if(b===c){var e,f=d.item;e=!!a._fn_filter;a._itemsByKey[f._key]?(a._onEditing(f,!1,d.isCanceled),!d.isCanceled&&e&&((e=a._fn_filter(f))||a.removeItem(f))):!d.isCanceled&&e&&(e=a._fn_filter(f))&&a.appendItems([f])}},a._objId),b.addHandler("errors_changed",function(c,d){b===c&&a._itemsByKey[d.item._key]&&
a._onErrorsChanged(d.item)},a._objId),b.addHandler("status_changed",function(c,d){b===c&&a._onDSStatusChanged(d)},a._objId),b.addHandler("item_deleting",function(c,d){b===c&&a._itemsByKey[d.item._key]&&a._onItemDeleting(d)},a._objId),b.addHandler("item_added",function(c,d){b===c&&a._isAddingNew&&(a._itemsByKey[d.item._key]||a._attach(d.item),a.currentItem=d.item,a._onEditing(d.item,!0,!1),a._onItemAdded(d.item))},a._objId),b.addHandler("item_adding",function(c,d){b===c&&a._isAddingNew&&a._onItemAdding(d.item)},
a._objId))};c.prototype._unbindDS=function(){var a=this._dataSource;a&&a.removeNSHandlers(this._objId)};c.prototype._onCurrentChanging=function(b){var c=this._dataSource;try{c._getEditingItem()&&b!==c._getEditingItem()&&c.endEdit()}catch(d){c.cancelEdit(),a.global.reThrow(d,this.handleError(d,this))}};c.prototype._onPageChanged=function(){this._refresh(!0)};c.prototype._getStrValue=function(a,b){return this._dataSource._getStrValue(a,b)};c.prototype._getErrors=function(a){return this._dataSource._getErrors(a)};
c.prototype.getItemsWithErrors=function(){return this._dataSource.getItemsWithErrors()};c.prototype.appendItems=function(a){return this._isDestroyCalled?[]:this._fillItems({items:a,isPageChanged:!1,clear:!1,isAppend:!0})};c.prototype.addNew=function(){var a;this._isAddingNew=!0;try{a=this._dataSource.addNew()}finally{this._isAddingNew=!1}return a};c.prototype.removeItem=function(b){if(null===b._aspect._key)throw Error(a.ERRS.ERR_ITEM_IS_DETACHED);if(this._itemsByKey[b._aspect._key]){var c=l.removeFromArray(this._items,
b);if(0>c)throw Error(a.ERRS.ERR_ITEM_IS_NOTFOUND);delete this._itemsByKey[b._aspect._key];delete this._errors[b._aspect._key];--this.totalCount;this._onRemoved(b,c);b=this.getItemByPos(c);var d=this._currentPos;d===c&&(b||(this._currentPos=d-1),this._onCurrentChanged());d>c&&(this._currentPos=d-1,this._onCurrentChanged())}};c.prototype.sortLocal=function(b,c){var d=1,e=a.global.parser,f=l.createDeferred();1===c&&(d=-1);var g=function(a,c){var f=0,g,h,l;g=0;for(h=b.length;g<h&&(l=b[g],f=e.resolvePath(a,
l),l=e.resolvePath(c,l),f=f<l?-1*d:f>l?d:0,0===f);g+=1);return f};try{this.fn_sort=g,f.resolve()}catch(h){f.reject(h),this.handleError(h,this),a.global._throwDummy(h)}return f.promise()};c.prototype.getIsHasErrors=function(){return this._dataSource.getIsHasErrors()};c.prototype.clear=function(){this._clear(!1)};c.prototype.refresh=function(){this._refresh(!1)};c.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,this._unbindDS(),this._fn_sort=this._fn_filter=this._dataSource=
null,b.prototype.destroy.call(this))};Object.defineProperty(c.prototype,"dataSource",{get:function(){return this._dataSource},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isPagingEnabled",{get:function(){return this._options.enablePaging},set:function(a){this._options.enablePaging!==a&&(this._options.enablePaging=a,this.raisePropertyChanged("isPagingEnabled"),this._refresh(!1))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"permissions",{get:function(){return this._dataSource.permissions},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"fn_filter",{get:function(){return this._fn_filter},set:function(a){this._fn_filter!==a&&(this._fn_filter=a,this._refresh(!1))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"fn_sort",{get:function(){return this._fn_sort},set:function(a){this._fn_sort!==a&&(this._fn_sort=a,this._refresh(!1))},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"fn_itemsProvider",{get:function(){return this._fn_itemsProvider},
set:function(a){this._fn_itemsProvider!==a&&(this._fn_itemsProvider=a,this._refresh(!1))},enumerable:!0,configurable:!0});return c}(h.BaseCollection);m.DataView=w;w=function(a){function b(c){this._refreshTimeout=this._parentItem=null;this._association=c.association;var d=l.extend(!1,{dataSource:this._association.childDS,fn_filter:null,fn_sort:null,fn_itemsProvider:null},c),e=this,f=this._association,g=c.fn_filter;d.fn_filter=function(a){if(!e._parentItem)return!1;var b=f.getParentFKey(e._parentItem);
if(!b)return!1;var c=f.getChildFKey(a);return c&&b===c?g?g(a):!0:!1};a.call(this,d)}__extends(b,a);b.prototype._refresh=function(a){if(this.dataSource){var b=this._association.getChildItems(this._parentItem);this.fn_filter&&(b=b.filter(this.fn_filter));this.fn_sort&&(b=b.sort(this.fn_sort));this._fillItems({items:b,isPageChanged:!!a,clear:!0,isAppend:!1});this._onViewRefreshed({})}};b.prototype.destroy=function(){this._isDestroyed||(this._isDestroyCalled=!0,clearTimeout(this._refreshTimeout),this._association=
null,a.prototype.destroy.call(this))};b.prototype.toString=function(){return this._association?"ChildDataView for "+this._association.toString():"ChildDataView"};Object.defineProperty(b.prototype,"parentItem",{get:function(){return this._parentItem},set:function(a){if(this._parentItem!==a){this._parentItem=a;this.raisePropertyChanged("parentItem");var b=this;0<this.items.length&&(this.clear(),this._onViewRefreshed({}));clearTimeout(b._refreshTimeout);b._refreshTimeout=setTimeout(function(){b._isDestroyCalled||
b._refresh(!1)},250)}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"association",{get:function(){return this._association},enumerable:!0,configurable:!0});return b}(w);m.ChildDataView=w;w=function(b){function c(a){b.call(this);this._name=a}__extends(c,b);c.prototype._getFullPath=function(a){throw Error("Not Implemented");};c.prototype.getName=function(){return this._name};c.prototype.setValue=function(a,b){throw Error("Not Implemented");};c.prototype.getValue=function(a){throw Error("Not Implemented");
};c.prototype.getFieldInfo=function(){throw Error("Not Implemented");};c.prototype.getProperties=function(){throw Error("Not Implemented");};c.prototype.getFullPath=function(a){throw Error("Not Implemented");};c.prototype.getEntity=function(){throw Error("Not Implemented");};c.prototype.getPropertyByName=function(b){var c=this.getProperties().filter(function(a){return a.fieldName==b});if(!c||1!=c.length)throw Error(l.format(a.ERRS.ERR_ASSERTION_FAILED,"arrProps.length == 1"));return c[0]};c.prototype.getIsHasErrors=
function(){return this.getEntity().getIsHasErrors()};c.prototype.addOnErrorsChanged=function(a,b){this.getEntity().addOnErrorsChanged(a,b)};c.prototype.removeOnErrorsChanged=function(a){this.getEntity().removeOnErrorsChanged(a)};c.prototype.getFieldErrors=function(a){a=this.getFullPath(a);return this.getEntity().getFieldErrors(a)};c.prototype.getAllErrors=function(){return this.getEntity().getAllErrors()};c.prototype.getIErrorNotification=function(){return this};return c}(a.BaseObject);m.BaseComplexProperty=
w;var D=function(a){function b(c,d){a.call(this,c);this._entity=d}__extends(b,a);b.prototype._getFullPath=function(a){return this.getName()+"."+a};b.prototype.setValue=function(a,b){this._entity._setFieldVal(a,b)};b.prototype.getValue=function(a){return this._entity._getFieldVal(a)};b.prototype.getFieldInfo=function(){return this._entity.getFieldInfo(this.getName())};b.prototype.getProperties=function(){return this.getFieldInfo().nested};b.prototype.getEntity=function(){return this._entity};b.prototype.getFullPath=
function(a){return this.getName()+"."+a};return b}(w);m.RootComplexProperty=D;w=function(b){function c(a,d){b.call(this,a);this._parent=d}__extends(c,b);c.prototype._getFullPath=function(a){return this._parent._getFullPath(this.getName()+"."+a)};c.prototype.setValue=function(a,b){this.getEntity()._setFieldVal(a,b)};c.prototype.getValue=function(a){return this.getEntity()._getFieldVal(a)};c.prototype.getFieldInfo=function(){var a=this.getName();return this._parent.getPropertyByName(a)};c.prototype.getProperties=
function(){return this.getFieldInfo().nested};c.prototype.getParent=function(){return this._parent};c.prototype.getRootProperty=function(){for(var b=this._parent;b&&b instanceof c;)b=b.getParent();if(!(b&&b instanceof D))throw Error(l.format(a.ERRS.ERR_ASSERTION_FAILED,"parent instanceof RootComplexProperty"));return b};c.prototype.getFullPath=function(a){return this._parent._getFullPath(this.getName()+"."+a)};c.prototype.getEntity=function(){return this.getRootProperty().getEntity()};return c}(w);
m.ChildComplexProperty=w;a.global.onModuleLoaded("db",d)})(d=r.db||(r.db={}))})(a.MOD||(a.MOD={}))})(RIAPP||(RIAPP={}));
(function(a){var r=a.MOD.consts,d=a.MOD.utils,m=a.MOD.binding,n=a.MOD.baseContent,k=a.MOD.dataform;a.global._initialize();var g=a.global.utils,h=a.global.parser,p=function(p){function f(d){p.call(this);var h="default",b=[];this._options=null;d&&(this._options=d,d.application_name&&(h=d.application_name),d.user_modules&&(b=d.user_modules));if(a.global.findApp(h))throw Error(g.format(a.ERRS.ERR_APP_NAME_NOT_UNIQUE,h));this._app_name=h;this._objId="app:"+g.getNewID();this._objLifeTime=null;this._ELV_STORE_KEY=
r.DATA_ATTR.EL_VIEW_KEY+f._newInstanceNum;f._newInstanceNum+=1;this._contentFactory=null;this._contentFactories=[];this._objMaps=[];this._exports={};this._modules={};this._elViewStore={};this._nextElViewStoreKey=0;this._userCode={};this._viewModels={};this._initModules();this._initUserModules(b);var c=null;this._contentFactories.forEach(function(a){c=a(c)});this._contentFactory=c;a.global._registerApp(this)}__extends(f,p);Object.defineProperty(f.prototype,"_DATA_BIND_SELECTOR",{get:function(){return["*[",
r.DATA_ATTR.DATA_BIND,"]"].join("")},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"_DATA_VIEW_SELECTOR",{get:function(){return["*[",r.DATA_ATTR.DATA_VIEW,"]"].join("")},enumerable:!0,configurable:!0});f.prototype._getEventNames=function(){var a=p.prototype._getEventNames.call(this);return["startup"].concat(a)};f.prototype._cleanUpObjMaps=function(){var d=this;this._objMaps.forEach(function(f){g.forEachProp(f,function(b){b=f[b];b instanceof a.BaseObject&&(b.getIsDestroyed()||b.removeNSHandlers(d.uniqueID))})});
this._objMaps=[]};f.prototype._initModules=function(){var d=this,f=a.MOD;d.global.moduleNames.forEach(function(a){f[a]&&f[a].initModule&&f[a].initModule(d)})};f.prototype._initUserModules=function(a){var d=this;a.forEach(function(a){d._modules[a.name]=a.initFn(d)})};f.prototype._destroyBindings=function(){this._objLifeTime&&(this._objLifeTime.destroy(),this._objLifeTime=null)};f.prototype._setUpBindings=function(){var a=this.appRoot;this._destroyBindings();this._objLifeTime=this._bindElements(a,this,
!1,!1)};f.prototype._getElementViewInfo=function(a){var d=null,b=null;a.hasAttribute(r.DATA_ATTR.DATA_VIEW)&&(a=a.getAttribute(r.DATA_ATTR.DATA_VIEW),(a=h.parseOptions(a))&&0<a.length&&(b=a[0],b.name&&"default"!=b.name&&(d=b.name),b=b.options));return{name:d,options:b}};f.prototype.handleError=function(d,f){if(a.global._checkIsDummy(d))return!0;var b=p.prototype.handleError.call(this,d,f);return b?b:a.global.handleError(d,f)};f.prototype._getElViewType=function(a){a="elvws."+a;var d=this.global,b=
d._getObject(this,a);b||(b=d._getObject(d,a));return b};f.prototype._checkBindableElement=function(d){for(var f=d.attributes,b,c={el:d,dataView:null,dataForm:null,expressions:[]},h=0,k=f.length;h<k;h++){b=f[h];if(g.str.startsWith(b.name,r.DATA_ATTR.DATA_BIND)){d=b.value.trim();if(!d)throw Error(g.format(a.ERRS.ERR_PARAM_INVALID,b.name,"empty"));"{"!=d[0]&&"}"!=d[d.length-1]&&(d="{"+d+"}");c.expressions.push(d)}g.str.startsWith(b.name,r.DATA_ATTR.DATA_FORM)&&(c.dataForm=b.value.trim());g.str.startsWith(b.name,
r.DATA_ATTR.DATA_VIEW)&&(c.dataView=b.value.trim())}return c.dataView||0<c.expressions.length?c:null};f.prototype._getAllBindableHtmlElements=function(d){var f=this,b=[];a.ArrayHelper.fromList(d.querySelectorAll("*")).forEach(function(a){(a=f._checkBindableElement(a))&&b.push(a)});return b};f.prototype._getElView=function(a){return(a=a.getAttribute(this._ELV_STORE_KEY))?this._elViewStore[a]:null};f.prototype._createElementView=function(d,f){var b;if(f.name&&(b=this._getElViewType(f.name),!b))throw Error(g.format(a.ERRS.ERR_ELVIEW_NOT_REGISTERED,
f.name));if(!b){var c=d.nodeName.toLowerCase();switch(c){case "input":b=d.getAttribute("type");c=c+":"+b;b=this._getElViewType(c);break;default:b=this._getElViewType(c)}if(!b)throw Error(g.format(a.ERRS.ERR_ELVIEW_NOT_CREATED,c));}return new b(this,d,f.options||{})};f.prototype._setElView=function(a,d){var b=a.getAttribute(this._ELV_STORE_KEY);b?d?this._elViewStore[b]=d:(a.removeAttribute(this._ELV_STORE_KEY),delete this._elViewStore[b]):d&&(b="s_"+this._nextElViewStoreKey,this._nextElViewStoreKey+=
1,a.setAttribute(this._ELV_STORE_KEY,b),this._elViewStore[b]=d)};f.prototype._bindTemplateElements=function(a){var f=this,b=f.global,c=this._getAllBindableHtmlElements(a),m=new d.LifeTimeScope,p=g.check,q=r.DATA_ATTR.DATA_FORM,z=f._checkBindableElement(a);z&&c.push(z);c.forEach(function(a){!a.dataForm&&p.isDataForm(a.el)&&(a.el.setAttribute(q,"yes"),a.dataForm="yes")});var C=c.filter(function(a,b,c){return!!a.dataForm}).map(function(a,b,c){return a.el});z&&z.dataForm&&(c=[z]);c.forEach(function(c){var d,
g,q,r,s;if(!p.isInNestedForm(a,C,c.el)){try{q=f.getElementView(c.el)}catch(x){b.reThrow(x,f.handleError(x,f))}m.addObj(q);q instanceof k.DataFormElView&&(q.form.isInsideTemplate=!0);if(c=c.expressions.join(""))for(g=h.parseOptions(c),r=0,s=g.length;r<s;r+=1)c=n.getBindingOptions(f,g[r],q,null),d=f.bind(c),c.target=null,m.addObj(d)}});return m};f.prototype._bindElements=function(a,f,b,c){var m=this,p=m.global,q=g.check,z=r.DATA_ATTR.DATA_FORM;a=a||p.document;var C=this._getAllBindableHtmlElements(a),
w=new d.LifeTimeScope;b||C.forEach(function(a){!a.dataForm&&q.isDataForm(a.el)&&(a.el.setAttribute(z,"yes"),a.dataForm="yes")});var y=C.filter(function(a,b,c){return!!a.dataForm}).map(function(a,b,c){return a.el});C.forEach(function(b){var d="",g,r,x;if(!q.isInNestedForm(a,y,b.el)){try{g=m.getElementView(b.el)}catch(z){p.reThrow(z,m.handleError(z,m))}w.addObj(g);g instanceof k.DataFormElView&&(g.form.isInsideTemplate=c);if(d=b.expressions.join(""))for(b=h.parseOptions(d),r=0,x=b.length;r<x;r+=1)d=
n.getBindingOptions(m,b[r],g,f),w.addObj(m.bind(d))}});return w};f.prototype._getContentType=function(a){return this.contentFactory.getContentType(a)};f.prototype.addOnStartUp=function(a,d){this.addHandler("startup",a,d)};f.prototype.removeOnStartUp=function(a){this.removeHandler("startup",a)};f.prototype.getExports=function(){return this._exports};f.prototype.registerElView=function(d,f){var b="elvws."+d,c=this.global;if(c._getObject(this,b))throw Error(g.format(a.ERRS.ERR_OBJ_ALREADY_REGISTERED,
d));c._registerObject(this,b,f)};f.prototype.getElementView=function(a){var d=this._getElView(a);if(d)return d;d=this._getElementViewInfo(a);return this._createElementView(a,d)};f.prototype.bind=function(a){return new m.Binding(a,this.appName)};f.prototype.registerContentFactory=function(a){this._contentFactories.push(a)};f.prototype.registerConverter=function(d,f){var b="converters."+d;if(a.global._getObject(this,b))throw Error(g.format(a.ERRS.ERR_OBJ_ALREADY_REGISTERED,d));a.global._registerObject(this,
b,f)};f.prototype.getConverter=function(d){var f="converters."+d,b=a.global._getObject(this,f);b||(b=a.global._getObject(a.global,f));if(!b)throw Error(g.format(a.ERRS.ERR_CONVERTER_NOTREGISTERED,d));return b};f.prototype.registerType=function(d,f){return a.global._registerObject(this,"types."+d,f)};f.prototype.getType=function(d){d="types."+d;var f=a.global._getObject(this,d);f||(f=a.global._getObject(a.global,d));return f};f.prototype.registerObject=function(d,f){var b=this,c="objects."+d;f instanceof
a.BaseObject&&f.addOnDestroyed(function(d,e){a.global._removeObject(b,c)},b.uniqueID);var g=a.global._registerObject(this,c,f);0>this._objMaps.indexOf(g)&&this._objMaps.push(g)};f.prototype.getObject=function(d){return a.global._getObject(this,"objects."+d)};f.prototype.onStartUp=function(){};f.prototype.startUp=function(d){var f=this,b=function(){try{f.onStartUp(),f.raiseEvent("startup",{}),d&&d.apply(f,[f]),f._setUpBindings()}catch(b){a.global.reThrow(b,this.handleError(b,this))}};try{if(d&&!g.check.isFunction(d))throw Error(a.ERRS.ERR_APP_SETUP_INVALID);
a.global._waitForNotLoading(b,null)}catch(c){a.global.reThrow(c,f.handleError(c,f))}};f.prototype.loadTemplates=function(a){this.loadTemplatesAsync(function(){return g.performAjaxGet(a)})};f.prototype.loadTemplatesAsync=function(d){a.global._loadTemplatesAsync(d,this)};f.prototype.registerTemplateLoader=function(d,f){a.global._registerTemplateLoader(this.appName+"."+d,{fn_loader:f})};f.prototype.getTemplateLoader=function(d){var f=a.global._getTemplateLoader(this.appName+"."+d);f||(f=a.global._getTemplateLoader(d));
return f};f.prototype.registerTemplateGroup=function(d,f){var b=g.extend(!1,{fn_loader:null,url:null,names:null,app:this},f);a.global._registerTemplateGroup(this.appName+"."+d,b)};f.prototype.destroy=function(){if(!this._isDestroyed){this._isDestroyCalled=!0;try{this._contentFactories=[],a.global._unregisterApp(this),this._destroyBindings(),this._cleanUpObjMaps(),this._exports={},this._modules={},this._elViewStore={},this._userCode={},this._viewModels={},this._options=this._contentFactory=null}finally{p.prototype.destroy.call(this)}}};
f.prototype.toString=function(){return"Application: "+this.appName};Object.defineProperty(f.prototype,"uniqueID",{get:function(){return this._objId},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"contentFactory",{get:function(){return this._contentFactory},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"appName",{get:function(){return this._app_name},
enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"appRoot",{get:function(){return this._options&&this._options.application_root?this._options.application_root:this.global.document},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"modules",{get:function(){return this._modules},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"global",{get:function(){return a.global},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"UC",{get:function(){return this._userCode},
enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"VM",{get:function(){return this._viewModels},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"app",{get:function(){return this},enumerable:!0,configurable:!0});f._newInstanceNum=1;return f}(a.BaseObject);a.Application=p})(RIAPP||(RIAPP={}));
